"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[7771],{8521:(e,t,r)=>{r.d(t,{Gv:()=>i,H1:()=>d,Pe:()=>h,Sv:()=>u,Td:()=>c,aC:()=>o,qf:()=>l,xZ:()=>a});const n=e=>"boolean"==typeof e,s=e=>"function"==typeof e,i=e=>null!==e&&"object"==typeof e,o=e=>i(e)&&e.constructor==={}.constructor,a=e=>Boolean(e)&&"function"==typeof e[Symbol.iterator],c=e=>e&&"function"==typeof e[Symbol.asyncIterator],u=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,l=e=>"undefined"!=typeof Blob&&e instanceof Blob,h=e=>e&&"object"==typeof e&&e.isBuffer,d=e=>(e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||i(e)&&s(e.tee)&&s(e.cancel)&&s(e.getReader))(e)||(e=>i(e)&&s(e.read)&&s(e.pipe)&&n(e.readable))(e)},327:(e,t,r)=>{r.d(t,{H:()=>a});var n=r(8521),s=r(90405),i=r(73968),o=r(3361);async function a(e,t,r,a){let c,u;Array.isArray(t)||(0,s.l)(t)?(c=t,u=r):(c=[],u=t);const l=(0,i.z)(u);let h=e;return"string"==typeof e&&(h=await l(e)),(0,n.qf)(e)&&(h=await l(e)),Array.isArray(c),await(0,o.q)(h,c,u)}},3361:(e,t,r)=>{r.d(t,{q:()=>Q});var n=r(38503);class s{terminate(){}}var i=r(5993);const o=new Map;function a(e){(0,i.v)(e.source&&!e.url||!e.source&&e.url);let t=o.get(e.source||e.url);return t||(e.url&&(t=function(e){if(!e.startsWith("http"))return e;return c((t=e,`try {\n  importScripts('${t}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`));var t}(e.url),o.set(e.url,t)),e.source&&(t=c(e.source),o.set(e.source,t))),(0,i.v)(t),t}function c(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function u(e,t=!0,r){const n=r||new Set;if(e){if(l(e))n.add(e);else if(l(e.buffer))n.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"==typeof e)for(const s in e)u(e[s],t,n)}else;return void 0===r?Array.from(n):[]}function l(e){return!!e&&(e instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&e instanceof MessagePort||("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)))}const h=()=>{};class d{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return"undefined"!=typeof Worker&&n.Bd||void 0!==s&&!n.Bd}constructor(e){const{name:t,source:r,url:s}=e;(0,i.v)(r||s),this.name=t,this.source=r,this.url=s,this.onMessage=h,this.onError=e=>console.log(e),this.worker=n.Bd?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=h,this.onError=h,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||u(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=a({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new s(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new s(this.source,{eval:!0})}return e.on("message",(e=>{this.onMessage(e)})),e.on("error",(e=>{this.onError(e)})),e.on("exit",(e=>{})),e}}class f{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,t){this.name=e,this.workerThread=t,this.result=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){(0,i.v)(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){(0,i.v)(this.isRunning),this.isRunning=!1,this._reject(e)}}class _{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return d.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach((e=>e.destroy())),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e,t=(e,t,r)=>e.done(r),r=(e,t)=>e.error(t)){const n=new Promise((n=>(this.jobQueue.push({name:e,onMessage:t,onError:r,onStart:n}),this)));return this._startQueuedJob(),await n}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const n=new f(t.name,e);e.onMessage=e=>t.onMessage(n,e.type,e.payload),e.onError=e=>t.onError(n,e),t.onStart(n);try{await n.result}catch(r){console.error(`Worker exception: ${r}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!n.Bd||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new d({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return n.Fr?this.maxMobileConcurrency:this.maxConcurrency}}const p={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class g{props;workerPools=new Map;static _workerFarm;static isSupported(){return d.isSupported()}static getWorkerFarm(e={}){return g._workerFarm=g._workerFarm||new g({}),g._workerFarm.setProps(e),g._workerFarm}constructor(e){this.props={...p},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:r,url:n}=e;let s=this.workerPools.get(t);return s||(s=new _({name:t,source:r,url:n}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}var m=r(55607);async function E(e,t,r,s,o){const a=e.id,c=function(e,t={}){const r=t[e.id]||{},s=n.Bd?`${e.id}-worker.js`:`${e.id}-worker-node.js`;let o=r.workerUrl;if(o||"compression"!==e.id||(o=t.workerUrl),"test"===t._workerType&&(o=n.Bd?`modules/${e.module}/dist/${s}`:`modules/${e.module}/src/workers/${e.id}-worker-node.ts`),!o){let t=e.version;"latest"===t&&(t=m.x);const r=t?`@${t}`:"";o=`https://unpkg.com/@loaders.gl/${e.module}${r}/dist/${s}`}return(0,i.v)(o),o}(e,r),u=g.getWorkerFarm(r).getWorkerPool({name:a,url:c});r=JSON.parse(JSON.stringify(r)),s=JSON.parse(JSON.stringify(s||{}));const l=await u.startJob("process-on-worker",b.bind(null,o));l.postMessage("process",{input:t,options:r,context:s});const h=await l.result;return await h.result}async function b(e,t,r,n){switch(r){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":const{id:i,input:o,options:a}=n;try{const r=await e(o,a);t.postMessage("done",{id:i,result:r})}catch(s){const e=s instanceof Error?s.message:"unknown error";t.postMessage("error",{id:i,error:e})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}var T=r(90405),y=r(8521),A=r(99027),R=r(94133),S=r(92214);const w=262144;const v=262144;const x=1048576;var C=r(47612),N=r(47069);function I(e,t){return C.Bd?async function*(e,t){const r=e.getReader();let n;try{for(;;){const e=n||r.read();t?._streamReadAhead&&(n=r.read());const{done:s,value:i}=await e;if(s)return;yield(0,N.XA)(i)}}catch(s){r.releaseLock()}}(e,t):async function*(e){for await(const t of e)yield(0,N.XA)(t)}(e)}function L(e,t){if("string"==typeof e)return function*(e,t){const r=t?.chunkSize||w;let n=0;const s=new TextEncoder;for(;n<e.length;){const t=Math.min(e.length-n,r),i=e.slice(n,n+t);n+=t,yield s.encode(i)}}(e,t);if(e instanceof ArrayBuffer)return function*(e,t={}){const{chunkSize:r=v}=t;let n=0;for(;n<e.byteLength;){const t=Math.min(e.byteLength-n,r),s=new ArrayBuffer(t),i=new Uint8Array(e,n,t);new Uint8Array(s).set(i),n+=t,yield s}}(e,t);if((0,y.qf)(e))return async function*(e,t){const r=t?.chunkSize||x;let n=0;for(;n<e.size;){const t=n+r,s=await e.slice(n,t).arrayBuffer();n=t,yield s}}(e,t);if((0,y.H1)(e))return I(e,t);if((0,y.Sv)(e)){return I(e.body,t)}throw new Error("makeIterator")}var O=r(80815);const M="Cannot convert supplied data type";async function P(e,t,r){const n=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"==typeof e||n)return function(e,t){if(t.text&&"string"==typeof e)return e;if((0,y.Pe)(e)&&(e=e.buffer),e instanceof ArrayBuffer){const r=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let r=e.buffer;const n=e.byteLength||e.length;return 0===e.byteOffset&&n===r.byteLength||(r=r.slice(e.byteOffset,e.byteOffset+n)),r}throw new Error(M)}(e,t);if((0,y.qf)(e)&&(e=await(0,O.wv)(e)),(0,y.Sv)(e)){const r=e;return await(0,O.Mz)(r),t.binary?await r.arrayBuffer():await r.text()}if((0,y.H1)(e)&&(e=L(e,r)),(0,y.xZ)(e)||(0,y.Td)(e))return(0,S.cy)(e);throw new Error(M)}var F=r(73968),B=r(28071),k=r(86428);var D=r(72548),U=r(10048);const G=new(r(85335).t)({id:"loaders.gl"});var W=r(42221),H=r(5223);const X=/\.([^.]+)$/;function V(e,t=[],r,n){if(!$(e))return null;if(t&&!Array.isArray(t))return(0,T.D)(t);let s=[];t&&(s=s.concat(t)),r?.ignoreRegisteredLoaders||s.push(...(0,H.Ph)()),function(e){for(const t of e)(0,T.D)(t)}(s);const i=function(e,t,r,n){const s=(0,D.Al)(e),i=(0,D.z4)(e),o=(0,B.S3)(s)||n?.url;let a=null,c="";r?.mimeType&&(a=K(t,r?.mimeType),c=`match forced by supplied MIME type ${r?.mimeType}`);a=a||function(e,t){const r=t&&X.exec(t),n=r&&r[1];return n?function(e,t){t=t.toLowerCase();for(const r of e)for(const e of r.extensions)if(e.toLowerCase()===t)return r;return null}(e,n):null}(t,o),c=c||(a?`matched url ${o}`:""),a=a||K(t,i),c=c||(a?`matched MIME type ${i}`:""),a=a||function(e,t){if(!t)return null;for(const r of e)if("string"==typeof t){if(Y(t,r))return r}else if(ArrayBuffer.isView(t)){if(j(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer){if(j(t,0,r))return r}return null}(t,e),c=c||(a?`matched initial data ${q(e)}`:""),r?.fallbackMimeType&&(a=a||K(t,r?.fallbackMimeType),c=c||(a?`matched fallback MIME type ${i}`:""));c&&G.log(1,`selectLoader selected ${a?.name}: ${c}.`);return a}(e,s,r,n);if(!i&&!r?.nothrow)throw new Error(z(e));return i}function $(e){return!(e instanceof Response&&204===e.status)}function z(e){const t=(0,D.Al)(e),r=(0,D.z4)(e);let n="No valid loader found (";n+=t?`${k.iW(t)}, `:"no url provided, ",n+=`MIME type: ${r?`"${r}"`:"not provided"}, `;const s=e?q(e):"";return n+=s?` first bytes: "${s}"`:"first bytes: not available",n+=")",n}function K(e,t){for(const r of e){if(r.mimeTypes?.some((e=>(0,W.JQ)(t,e))))return r;if((0,W.JQ)(t,`application/x.${r.id}`))return r}return null}function Y(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function j(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some((r=>function(e,t,r,n){if(n instanceof ArrayBuffer)return(0,U.YV)(n,e,n.byteLength);switch(typeof n){case"function":return n(e);case"string":return n===Z(e,t,n.length);default:return!1}}(e,t,0,r)))}function q(e,t=5){if("string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return Z(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return Z(e,0,t)}return""}function Z(e,t,r){if(e.byteLength<t+r)return"";const n=new DataView(e);let s="";for(let i=0;i<r;i++)s+=String.fromCharCode(n.getUint8(t+i));return s}async function Q(e,t,r,s){!t||Array.isArray(t)||(0,T.l)(t)||(s=void 0,r=t,t=void 0),e=await e,r=r||{};const o=(0,D.Al)(e),a=function(e,t){if(e&&!Array.isArray(e))return e;let r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[...r,...e]:e}return r&&r.length?r:void 0}(t,s),c=await async function(e,t=[],r,n){if(!$(e))return null;let s=V(e,t,{...r,nothrow:!0},n);if(s)return s;if((0,y.qf)(e)&&(s=V(e=await e.slice(0,10).arrayBuffer(),t,r,n)),!s&&!r?.nothrow)throw new Error(z(e));return s}(e,a,r);return c?(s=function(e,t,r){if(r)return r;const n={fetch:(0,F.z)(t,e),...e};if(n.url){const e=(0,B.S3)(n.url);n.baseUrl=e,n.queryString=(0,B.by)(n.url),n.filename=k.iW(e),n.baseUrl=k.pD(e)}return Array.isArray(n.loaders)||(n.loaders=null),n}({url:o,_parse:Q,loaders:a},r=(0,A.a5)(r,c,a,o),s||null),await async function(e,t,r,s){if(function(e){(0,i.v)(e,"no worker provided");const t=e.version}(e),r=(0,R.y)(e.options,r),(0,y.Sv)(t)){const e=t,{ok:r,redirected:n,status:i,statusText:o,type:a,url:c}=e,u=Object.fromEntries(e.headers.entries());s.response={headers:u,ok:r,redirected:n,status:i,statusText:o,type:a,url:c}}t=await P(t,e,r);const o=e;if(o.parseTextSync&&"string"==typeof t)return o.parseTextSync(t,r,s);if(function(e,t){return!!g.isSupported()&&!(!n.Bd&&!t?._nodeWorkers)&&e.worker&&t?.worker}(e,r))return await E(e,t,r,s,Q);if(o.parseText&&"string"==typeof t)return await o.parseText(t,r,s);if(o.parse)return await o.parse(t,r,s);throw(0,i.v)(!o.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}(c,e,r,s)):null}},5223:(e,t,r)=>{r.d(t,{Ph:()=>a,mk:()=>o});var n=r(90405),s=r(99027);const i=()=>{const e=(0,s.K2)();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function o(e){const t=i();e=Array.isArray(e)?e:[e];for(const r of e){const e=(0,n.D)(r);t.find((t=>e===t))||t.unshift(e)}}function a(){return i()}},38658:(e,t,r)=>{r.d(t,{t2:()=>o});let n="";const s={};var i=r(80815);async function o(e,t){if("string"==typeof e){const r=function(e){for(const t in s)if(e.startsWith(t)){const r=s[t];e=e.replace(t,r)}return e.startsWith("http://")||e.startsWith("https://")||(e=`${n}${e}`),e}(e);return function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,t):await fetch(r,t)}return await(0,i.wv)(e)}},73968:(e,t,r)=>{r.d(t,{z:()=>o});var n=r(8521),s=r(38658),i=r(99027);function o(e,t){const r=(0,i.pp)(),o=e||r;return"function"==typeof o.fetch?o.fetch:(0,n.Gv)(o.fetch)?e=>(0,s.t2)(e,o.fetch):t?.fetch?t?.fetch:s.t2}},90405:(e,t,r)=>{r.d(t,{D:()=>i,l:()=>s});var n=r(94976);function s(e){if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(e?.extensions)}function i(e){let t;return(0,n.v)(e,"null loader"),(0,n.v)(s(e),"invalid loader"),Array.isArray(e)&&(t=e[1],e=e[0],e={...e,options:{...e.options,...t}}),(e?.parseTextSync||e?.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}},99027:(e,t,r)=>{r.d(t,{pp:()=>l,K2:()=>u,a5:()=>h});var n=r(8521);const s=new(r(85335).t)({id:"loaders.gl"});class i{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}var o=r(47612);const a={fetch:null,mimeType:void 0,nothrow:!1,log:new class{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:o.Bd,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},c={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function u(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function l(){const e=u();return e.globalOptions=e.globalOptions||{...a},e.globalOptions}function h(e,t,r,n){return r=r||[],function(e,t){d(e,null,a,c,t);for(const r of t){const n=e&&e[r.id]||{},s=r.options&&r.options[r.id]||{},i=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};d(n,r.id,s,i,t)}}(e,r=Array.isArray(r)?r:[r]),_(t,e,n)}function d(e,t,r,i,o){const a=t||"Top level",c=t?`${t}.`:"";for(const u in e){const l=!t&&(0,n.Gv)(e[u]);if(!(u in r)&&!("baseUri"===u&&!t)&&!("workerUrl"===u&&t))if(u in i)s.warn(`${a} loader option '${c}${u}' no longer supported, use '${i[u]}'`)();else if(!l){const e=f(u,o);s.warn(`${a} loader option '${c}${u}' not recognized. ${e}`)()}}}function f(e,t){const r=e.toLowerCase();let n="";for(const s of t)for(const t in s.options){if(e===t)return`Did you mean '${s.id}.${t}'?`;const i=t.toLowerCase();(r.startsWith(i)||i.startsWith(r))&&(n=n||`Did you mean '${s.id}.${t}'?`)}return n}function _(e,t,r){const n={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(n,r),null===n.log&&(n.log=new i),p(n,l()),p(n,t),n}function p(e,t){for(const r in t)if(r in t){const s=t[r];(0,n.aC)(s)&&(0,n.aC)(e[r])?e[r]={...e[r],...t[r]}:e[r]=t[r]}}},42221:(e,t,r)=>{r.d(t,{JQ:()=>i,OA:()=>o,d_:()=>a});const n=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,s=/^([-\w.]+\/[-\w.+]+)/;function i(e,t){return e.toLowerCase()===t.toLowerCase()}function o(e){const t=s.exec(e);return t?t[1]:e}function a(e){const t=n.exec(e);return t?t[1]:""}},72548:(e,t,r)=>{r.d(t,{Al:()=>o,_E:()=>c,z4:()=>a});var n=r(8521),s=r(42221),i=r(28071);function o(e){if((0,n.Sv)(e)){return e.url}if((0,n.qf)(e)){return e.name||""}return"string"==typeof e?e:""}function a(e){if((0,n.Sv)(e)){const t=e,r=t.headers.get("content-type")||"",n=(0,i.S3)(t.url);return(0,s.OA)(r)||(0,s.d_)(n)}if((0,n.qf)(e)){return e.type||""}return"string"==typeof e?(0,s.d_)(e):""}function c(e){if((0,n.Sv)(e)){return e.headers["content-length"]||-1}if((0,n.qf)(e)){return e.size}return"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}},80815:(e,t,r)=>{r.d(t,{Mz:()=>c,wv:()=>a});var n=r(8521);class s extends Error{constructor(e,t){super(e),this.reason=t.reason,this.url=t.url,this.response=t.response}reason;url;response}var i=r(72548),o=r(28071);async function a(e){if((0,n.Sv)(e))return e;const t={},r=(0,i._E)(e);r>=0&&(t["content-length"]=String(r));const s=(0,i.Al)(e),o=(0,i.z4)(e);o&&(t["content-type"]=o);const a=await async function(e){const t=5;if("string"==typeof e)return`data:,${e.slice(0,t)}`;if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const r=new FileReader;r.onload=t=>e(t?.target?.result),r.readAsDataURL(t)}))}if(e instanceof ArrayBuffer){return`data:base64,${function(e){let t="";const r=new Uint8Array(e);for(let n=0;n<r.byteLength;n++)t+=String.fromCharCode(r[n]);return btoa(t)}(e.slice(0,t))}`}return null}(e);a&&(t["x-first-bytes"]=a),"string"==typeof e&&(e=(new TextEncoder).encode(e));const c=new Response(e,{headers:t});return Object.defineProperty(c,"url",{value:s}),c}async function c(e){if(!e.ok){const t=await async function(e){const r=(0,o.E1)(e.url);let n=`Failed to fetch resource (${e.status}) ${e.statusText}: ${r}`;n=n.length>100?`${n.slice(0,100)}...`:n;const i={reason:e.statusText,url:e.url,response:e};try{const t=e.headers.get("Content-Type");i.reason=t?.includes("application/json")?await e.json():e.text()}catch(t){}return new s(n,i)}(e);throw t}}},28071:(e,t,r)=>{r.d(t,{E1:()=>o,S3:()=>i,by:()=>s});const n=/\?.*/;function s(e){const t=e.match(n);return t&&t[0]}function i(e){return e.replace(n,"")}function o(e){if(e.length<50)return e;const t=e.slice(e.length-15);return`${e.substr(0,32)}...${t}`}},8045:(e,t,r)=>{r.d(t,{$:()=>T});var n=r(94976),s=r(47612);const i=globalThis.loaders?.parseImageNode,o="undefined"!=typeof Image,a="undefined"!=typeof ImageBitmap,c=Boolean(i),u=!!s.Bd||c;var l=r(53905);const h=/^data:image\/svg\+xml/,d=/\.svg((\?|#).*)?$/;function f(e){return e&&(h.test(e)||d.test(e))}function _(e,t){if(f(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function p(e,t,r){const n=function(e,t){if(f(t)){let t=(new TextDecoder).decode(e);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(r){throw new Error(r.message)}return`data:image/svg+xml;base64,${btoa(t)}`}return _(e,t)}(e,r),s=self.URL||self.webkitURL,i="string"!=typeof n&&s.createObjectURL(n);try{return await async function(e,t){const r=new Image;if(r.src=e,t.image&&t.image.decode&&r.decode)return await r.decode(),r;return await new Promise(((e,t)=>{try{r.onload=()=>e(r),r.onerror=e=>{const r=e instanceof Error?e.message:"error";t(new Error(r))}}catch(n){t(n)}}))}(i||n,t)}finally{i&&s.revokeObjectURL(i)}}const g={};let m=!0;async function E(e,t,r){let n;if(f(r)){n=await p(e,t,r)}else n=_(e,r);const s=t&&t.imagebitmap;return await async function(e,t=null){!function(e){for(const t in e||g)return!1;return!0}(t)&&m||(t=null);if(t)try{return await createImageBitmap(e,t)}catch(r){console.warn(r),m=!1}return await createImageBitmap(e)}(n,s)}var b=r(72501);const T={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:"4.2.1",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(e,t,r){const s=((t=t||{}).image||{}).type||"auto",{url:i}=r||{};let c;switch(function(e){switch(e){case"auto":case"data":return function(){if(a)return"imagebitmap";if(o)return"image";if(u)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return a||o||u;case"imagebitmap":return a;case"image":return o;case"data":return u;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}(e),e}}(s)){case"imagebitmap":c=await E(e,t,i);break;case"image":c=await p(e,t,i);break;case"data":c=await async function(e){const{mimeType:t}=(0,b.m)(e)||{},r=globalThis.loaders?.parseImageNode;return(0,n.v)(r),await r(e,t)}(e);break;default:(0,n.v)(!1)}return"data"===s&&(c=(0,l.M5)(c)),c},tests:[e=>Boolean((0,b.m)(new DataView(e)))],options:{image:{type:"auto",decode:!0}}}},72501:(e,t,r)=>{function n(e){return function(e,t,r=0){const n=(s=t,[...s].map((e=>e.charCodeAt(0))));var s;for(let i=0;i<n.length;++i)if(n[i]!==e[i+r])return!1;return!0}(e,"ftyp",4)&&96&e[8]?function(e){switch((t=e,r=8,n=12,String.fromCharCode(...t.slice(r,n))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var t,r,n}(e):null}r.d(t,{m:()=>o});const s=!1,i=!0;function o(e){const t=a(e);return function(e){const t=a(e),r=t.byteLength>=24&&2303741511===t.getUint32(0,s);if(!r)return null;return{mimeType:"image/png",width:t.getUint32(16,s),height:t.getUint32(20,s)}}(t)||function(e){const t=a(e),r=t.byteLength>=3&&65496===t.getUint16(0,s)&&255===t.getUint8(2);if(!r)return null;const{tableMarkers:n,sofMarkers:i}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)e.add(r);const t=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:e,sofMarkers:t}}();let o=2;for(;o+9<t.byteLength;){const e=t.getUint16(o,s);if(i.has(e))return{mimeType:"image/jpeg",height:t.getUint16(o+5,s),width:t.getUint16(o+7,s)};if(!n.has(e))return null;o+=2,o+=t.getUint16(o,s)}return null}(t)||function(e){const t=a(e),r=t.byteLength>=10&&1195984440===t.getUint32(0,s);if(!r)return null;return{mimeType:"image/gif",width:t.getUint16(6,i),height:t.getUint16(8,i)}}(t)||function(e){const t=a(e),r=t.byteLength>=14&&16973===t.getUint16(0,s)&&t.getUint32(2,i)===t.byteLength;if(!r)return null;return{mimeType:"image/bmp",width:t.getUint32(18,i),height:t.getUint32(22,i)}}(t)||function(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),r=n(t);if(!r)return null;return{mimeType:r.mimeType,width:0,height:0}}(t)}function a(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}},53905:(e,t,r)=>{function n(e){const t=i(e);if(!t)throw new Error("Not an image");return t}function s(e){switch(n(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("getImageData");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function i(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&e instanceof Image?"image":e&&"object"==typeof e&&e.data&&e.width&&e.height?"data":null}r.d(t,{M5:()=>s})},10048:(e,t,r)=>{function n(e,t,r){if(r=r||e.byteLength,e.byteLength<r||t.byteLength<r)return!1;const n=new Uint8Array(e),s=new Uint8Array(t);for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}function s(...e){return function(e){const t=e.map((e=>e instanceof ArrayBuffer?new Uint8Array(e):e)),r=t.reduce(((e,t)=>e+t.byteLength),0),n=new Uint8Array(r);let s=0;for(const i of t)n.set(i,s),s+=i.byteLength;return n.buffer}(e)}function i(e,t,r){const n=void 0!==r?new Uint8Array(e).subarray(t,t+r):new Uint8Array(e).subarray(t);return new Uint8Array(n).buffer}r.d(t,{AQ:()=>s,YV:()=>n,_m:()=>i})},47069:(e,t,r)=>{function n(e){if((t=e)&&"object"==typeof t&&t.isBuffer)return e;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"==typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"==typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}r.d(t,{XA:()=>n})},94976:(e,t,r)=>{function n(e,t){if(!e)throw new Error(t||"loader assertion failed.")}r.d(t,{v:()=>n})},47612:(e,t,r)=>{r.d(t,{Bd:()=>n});"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const n=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),s="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);s&&parseFloat(s[1])},92214:(e,t,r)=>{r.d(t,{cy:()=>s});var n=r(10048);async function s(e){const t=[];for await(const r of e)t.push(r);return(0,n.AQ)(...t)}},94133:(e,t,r)=>{function n(e,t){return s(e||{},t)}function s(e,t,r=0){if(r>3)return t;const n={...e};for(const[i,o]of Object.entries(t))o&&"object"==typeof o&&!Array.isArray(o)?n[i]=s(n[i]||{},t[i],r+1):n[i]=t[i];return n}r.d(t,{y:()=>n})},86428:(e,t,r)=>{function n(){if("undefined"!=typeof process&&void 0!==process.cwd)return process.cwd();const e=window.location?.pathname;return e?.slice(0,e.lastIndexOf("/")+1)||""}function s(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function i(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}function o(...e){const t=[];for(let n=0;n<e.length;n++)t[n]=e[n];let r,s="",i=!1;for(let o=t.length-1;o>=-1&&!i;o--){let e;o>=0?e=t[o]:(void 0===r&&(r=n()),e=r),0!==e.length&&(s=`${e}/${s}`,i=e.charCodeAt(0)===a)}return s=function(e,t){let r,n="",s=-1,i=0,o=!1;for(let u=0;u<=e.length;++u){if(u<e.length)r=e.charCodeAt(u);else{if(r===a)break;r=a}if(r===a){if(s===u-1||1===i);else if(s!==u-1&&2===i){if(n.length<2||!o||n.charCodeAt(n.length-1)!==c||n.charCodeAt(n.length-2)!==c)if(n.length>2){const e=n.length-1;let t=e;for(;t>=0&&n.charCodeAt(t)!==a;--t);if(t!==e){n=-1===t?"":n.slice(0,t),s=u,i=0,o=!1;continue}}else if(2===n.length||1===n.length){n="",s=u,i=0,o=!1;continue}t&&(n.length>0?n+="/..":n="..",o=!0)}else{const t=e.slice(s+1,u);n.length>0?n+=`/${t}`:n=t,o=!1}s=u,i=0}else r===c&&-1!==i?++i:i=-1}return n}(s,!i),i?`/${s}`:s.length>0?s:"."}r.d(t,{pD:()=>i,iW:()=>s,hd:()=>o});const a=47,c=46},5993:(e,t,r)=>{function n(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}r.d(t,{v:()=>n})},38503:(e,t,r)=>{r.d(t,{Bd:()=>n,Fr:()=>i,xD:()=>s});"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const n="object"!=typeof process||"[object process]"!==String(process)||process.browser,s="function"==typeof importScripts,i="undefined"!=typeof window&&void 0!==window.orientation,o="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);o&&parseFloat(o[1])},55607:(e,t,r)=>{r.d(t,{Q:()=>s,x:()=>n});const n="latest";const s=(globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.2.1"),globalThis._loadersgl_.version)},91858:(e,t,r)=>{var n;r.d(t,{GL:()=>n}),function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"}(n||(n={}))},40428:(e,t,r)=>{r.d(t,{M:()=>u,P:()=>c});var n=r(29651);const s={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},i={f32:4,f16:2,i32:4,u32:4};var o=r(56821);function a(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);const[r,n]=e.split("x"),s=r,i=n?parseInt(n):1,a=(0,o.l)(s),c={type:s,components:i,byteLength:a.byteLength*i,integer:a.integer,signed:a.signed,normalized:a.normalized};return t&&(c.webglOnly=!0),c}function c(e,t){const r={};for(const n of e.attributes){const s=l(e,t,n.name);s&&(r[n.name]=s)}return r}function u(e,t,r=16){const n=c(e,t),s=new Array(r).fill(null);for(const i of Object.values(n))s[i.location]=i;return s}function l(e,t,r){const o=function(e,t){const r=e.attributes.find((e=>e.name===t));r||n.R.warn(`shader layout attribute "${t}" not present in shader`);return r||null}(e,r),c=function(e,t){h(e);let r=function(e,t){for(const r of e)if(r.format&&r.name===t)return{attributeName:r.name,bufferName:t,stepMode:r.stepMode,vertexFormat:r.format,byteOffset:0,byteStride:r.byteStride||0};return null}(e,t);if(r)return r;if(r=function(e,t){for(const r of e){let e=r.byteStride;if("number"!=typeof r.byteStride)for(const t of r.attributes||[]){e+=a(t.format).byteLength}const n=r.attributes?.find((e=>e.attribute===t));if(n)return{attributeName:n.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:n.format,byteOffset:n.byteOffset,byteStride:e}}return null}(e,t),r)return r;return n.R.warn(`layout for attribute "${t}" not present in buffer layout`),null}(t,r);if(!o)return null;const u=function(e){const[t,r]=s[e],n="i32"===t||"u32"===t,o="u32"!==t,a=i[t]*r,c=function(e,t){let r;switch(e){case"f32":r="float32";break;case"i32":r="sint32";break;case"u32":r="uint32";break;case"f16":return t<=2?"float16x2":"float16x4"}return 1===t?r:`${r}x${t}`}(t,r);return{dataType:t,components:r,defaultVertexFormat:c,byteLength:a,integer:n,signed:o}}(o.type),l=c?.vertexFormat||u.defaultVertexFormat,d=a(l);return{attributeName:c?.attributeName||o.name,bufferName:c?.bufferName||o.name,location:o.location,shaderType:o.type,shaderDataType:u.dataType,shaderComponents:u.components,vertexFormat:l,bufferDataType:d.type,bufferComponents:d.components,normalized:d.normalized,integer:u.integer,stepMode:c?.stepMode||o.stepMode||"vertex",byteOffset:c?.byteOffset||0,byteStride:c?.byteStride||0}}function h(e){for(const t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&n.R.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}},88014:(e,t,r)=>{r.d(t,{pF:()=>h,I7:()=>l,PI:()=>u});var n=r(76028),s=r(29651),i=r(74683),o=r(26839),a=r(34045),c=r(23265);class u{}class l{features;disabledFeatures;constructor(e=[],t){this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class h{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:e=>s.R.error(e.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:s.R.get("debug")||void 0,debugShaders:s.R.get("debug-shaders")||void 0,debugFramebuffers:Boolean(s.R.get("debug-framebuffers")),debugWebGL:Boolean(s.R.get("debug-webgl")),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0};get[Symbol.toStringTag](){return"Device"}constructor(e){this.props={...h.defaultProps,...e},this.id=this.props.id||(0,i.L)(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=n.d;timestamp=0;_reused=!1;_lumaData={};getTextureFormatCapabilities(e){const t=function(e){const t=(0,c.q)(e),r={format:e,create:t.f??!0,render:t.render??!0,filter:t.filter??!0,blend:t.blend??!0,store:t.store??!0},n=(0,a.z)(e),s=e.startsWith("depth")||e.startsWith("stencil"),i=n?.signed,o=n?.integer,u=n?.webgl;return r.render&&=!i,r.filter&&=!(s||i||o||u),r}(e),r=e=>("string"==typeof e?this.features.has(e):e)??!0,n=r(t.create),s={format:e,create:n,render:n&&r(t.render),filter:n&&r(t.filter),blend:n&&r(t.blend),store:n&&r(t.store)};return this._getDeviceSpecificTextureFormatCapabilities(s)}isTextureFormatSupported(e,t){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return(0,a.Y)(e)}loseDevice(){return!1}reportError(e){this.props.onError(e)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(e={}){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return!0===e.createCanvasContext?{}:e.createCanvasContext}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t={...e};return(e.usage||0)&o.h.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array?t.indexType="uint16":s.R.warn("indices buffer content must be of integer type")()),t}}},95850:(e,t,r)=>{r.d(t,{a:()=>l});var n=r(74003),s=r(88014),i=r(76028),o=r(29651);const a=(0,n.B)()&&"undefined"!=typeof document,c="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class u{static defaultProps={...s.pF.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};static pageLoaded=function(){if(a&&"complete"===document.readyState||"undefined"==typeof window)return Promise.resolve();return new Promise((e=>{window.addEventListener("load",(()=>e()))}))}().then((()=>{o.R.probe(2,"DOM is loaded")()}));stats=i.d;log=o.R;VERSION="9.1.5";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw o.R.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),o.R.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");o.R.error("This version of luma.gl has already been initialized")()}o.R.log(1,`${this.VERSION} - set luma.log.level=1 (or higher) to trace rendering`)(),globalThis.luma=this}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(e=[]){const t=this.getAdapterMap(e);return Array.from(t).map((([,e])=>e)).filter((e=>e.isSupported?.())).map((e=>e.type))}getBestAvailableAdapter(e=[]){const t=this.getAdapterMap(e);return t.get("webgpu")?.isSupported?.()?"webgpu":t.get("webgl")?.isSupported?.()?"webgl":null}setDefaultDeviceProps(e){Object.assign(u.defaultProps,e)}async createDevice(e={}){(e={...u.defaultProps,...e}).waitForPageLoad&&await u.pageLoaded;const t=this.getAdapterMap(e.adapters);let r=e.type||"";"best-available"===r&&(r=this.getBestAvailableAdapter(e.adapters)||r);const n=(this.getAdapterMap(e.adapters)||t).get(r),s=await(n?.create?.(e));if(s)return s;throw new Error(c)}async attachDevice(e){const t=this.getAdapterMap(e.adapters);let r="";e.handle instanceof WebGL2RenderingContext&&(r="webgl"),e.createCanvasContext&&await u.pageLoaded,null===e.handle&&(r="unknown");const n=t.get(r),s=await(n?.attach?.(null));if(s)return s;throw new Error(c)}enforceWebGL2(e=!0,t=[]){const r=this.getAdapterMap(t).get("webgl");r||o.R.warn("enforceWebGL2: webgl adapter not found")(),r?.enforceWebGL2?.(e)}getAdapterMap(e=[]){const t=new Map(this.preregisteredAdapters);for(const r of e)t.set(r.type,r);return t}registerDevices(e){o.R.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(const t of e){const e=t.adapter;e&&this.preregisteredAdapters.set(e.type,e)}}}const l=new u},26839:(e,t,r)=>{r.d(t,{h:()=>s});var n=r(5153);class s extends n.F{static defaultProps={...n.F.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,t){const r={...t};(t.usage||0)&s.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?r.indexType="uint32":t.data instanceof Uint16Array&&(r.indexType="uint16")),delete r.data,super(e,r,s.defaultProps),this.usage=r.usage||0,this.indexType=r.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}readSyncWebGL(e,t){throw new Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,t,r){const n=ArrayBuffer.isView(e)?e.buffer:e,i=Math.min(e?e.byteLength:r,s.DEBUG_DATA_MAX_LENGTH);null===n?this.debugData=new ArrayBuffer(i):0===t&&r===n.byteLength?this.debugData=n.slice(0,i):this.debugData=n.slice(t,t+i)}}},22512:(e,t,r)=>{r.d(t,{r:()=>s});var n=r(5153);class s extends n.F{static defaultProps={...n.F.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,t){super(e,t,s.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(e){throw new Error("Use uniform blocks")}}},5153:(e,t,r)=>{r.d(t,{F:()=>s});var n=r(74683);class s{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,t,r){if(!e)throw new Error("no device");this._device=e,this.props=function(e,t){const r={...t};for(const n in e)void 0!==e[n]&&(r[n]=e[n]);return r}(t,r);const s="undefined"!==this.props.id?this.props.id:(0,n.L)(this[Symbol.toStringTag]);this.props.id=s,this.id=s,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get(`${t}s Active`).decrementCount()}trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").addCount(e),r.get(`${t} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}}},89277:(e,t,r)=>{r.d(t,{L:()=>s});var n=r(5153);class s extends n.F{static defaultProps={...n.F.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){super(e,t=s.normalizeProps(e,t),s.defaultProps)}static normalizeProps(e,t){return{...t,...e?.props?._resourceDefaults?.sampler||{}}}}},11669:(e,t,r)=>{r.d(t,{M:()=>a});var n=r(5153),s=r(74683);function i(e,t,r,n){if(n?.inlineSource){const n=function(e,t,r){let n="";for(let s=t-2;s<=t;s++){const i=e[s-1];void 0!==i&&(n+=o(i,t,r))}return n}(t,r);return`\n${n}${e.linePos>0?`${" ".repeat(e.linePos+5)}^^^\n`:""}${e.type.toUpperCase()}: ${e.message}\n\n`}const s="error"===e.type?"red":"#8B4000";return n?.html?`<div class='luma-compiler-log-error' style="color:${s};"><b> ${e.type.toUpperCase()}: ${e.message}</b></div>`:`${e.type.toUpperCase()}: ${e.message}`}function o(e,t,r){const n=r?.html?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"):e;return`${function(e,t){let r="";for(let n=e.length;n<t;++n)r+=" ";return r+e}(String(t),4)}: ${n}${r?.html?"<br/>":"\n"}`}class a extends n.F{static defaultProps={...n.F.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0};get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,t){super(e,{id:c(t={...t,debugShaders:t.debugShaders||e.props.debugShaders||"errors"}),...t},a.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if("success"===this.compilationStatus)return}const t=await this.getCompilationInfo();"warnings"===e&&0===t?.length||this._displayShaderLog(t)}_displayShaderLog(e){if("undefined"==typeof document||!document?.createElement)return;const t=u(this.source),r=`${this.stage} ${t}`;let n=function(e,t,r){let n="";const s=t.split(/\r?\n/),a=e.slice().sort(((e,t)=>e.lineNum-t.lineNum));switch(r?.showSourceCode||"no"){case"all":let t=0;for(let e=1;e<=s.length;e++)for(n+=o(s[e-1],e,r);a.length>t&&a[t].lineNum===e;){const e=a[t++];n+=i(e,s,e.lineNum,{...r,inlineSource:!1})}return n;case"issues":case"no":for(const o of e)n+=i(o,s,o.lineNum,{inlineSource:"no"!==r?.showSourceCode});return n}}(e,this.source,{showSourceCode:"all",html:!0});const s=this.getTranslatedSource();s&&(n+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${s}</pre></code>`);const a=document.createElement("Button");a.innerHTML=`\n<h1>Shader Compilation Error in ${r}</h1><br /><br />\n<code style="user-select:text;"><pre>\n${n}\n</pre></code>`,a.style.top="10px",a.style.left="10px",a.style.position="absolute",a.style.zIndex="9999",a.style.width="100%",a.style.textAlign="left",document.body.appendChild(a);const c=document.getElementsByClassName("luma-compiler-log-error");c[0]?.scrollIntoView(),a.onclick=()=>{const e=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(e)}}}function c(e){return u(e.source)||e.id||(0,s.L)(`unnamed ${e.stage}-shader`)}function u(e,t="unnamed"){const r=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return r?r[1]:t}},75638:(e,t,r)=>{r.d(t,{X:()=>s});var n=r(5153);class s extends n.F{static defaultProps={...n.F.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0};get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,s.defaultProps)}}},80698:(e,t,r)=>{r.d(t,{g:()=>s});var n=r(5153);class s extends n.F{static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static STORAGE=8;static RENDER_ATTACHMENT=16;static CubeFaces=["+X","-X","+Y","-Y","+Z","-Z"];static defaultProps={...n.F.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0};get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}dimension;format;width;height;depth;mipLevels;updateTimestamp;constructor(e,t){if(super(e,t=s.normalizeProps(e,t),s.defaultProps),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,void 0===this.props.width||void 0===this.props.height){const e=s.getTextureDataSize(this.props.data);this.width=e?.width||1,this.height=e?.height||1}this.props.mipmaps&&void 0===this.props.mipLevels&&(this.props.mipLevels="pyramid"),this.mipLevels="pyramid"===this.props.mipLevels?s.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createTexture({...this.props,...e})}static isExternalImage(e){return"undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas}static getExternalImageSize(e){if("undefined"!=typeof ImageData&&e instanceof ImageData||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if("undefined"!=typeof VideoFrame&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(e){const t=e?.data;return ArrayBuffer.isView(t)}static getTextureDataSize(e){if(!e)return null;if(ArrayBuffer.isView(e))return null;if(Array.isArray(e))return s.getTextureDataSize(e[0]);if(s.isExternalImage(e))return s.getExternalImageSize(e);if(e&&"object"==typeof e&&e.constructor===Object){const t=Object.values(e)[0];return{width:t.width,height:t.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(e,t){let r;return r=ArrayBuffer.isView(e)?[{data:e,width:t.width,height:t.height}]:Array.isArray(e)?e:[e],r}static getMipLevelCount(e,t){return Math.floor(Math.log2(Math.max(e,t)))+1}static getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1};static normalizeProps(e,t){const r={...t},n=e?.props?._resourceDefaults?.texture||{};Object.assign(r,n);const{width:s,height:i}=r;return"number"==typeof s&&(r.width=Math.max(1,Math.ceil(s))),"number"==typeof i&&(r.height=Math.max(1,Math.ceil(i))),r}}},56821:(e,t,r)=>{function n(e){const t=function(e){const t=i[e];return t}(s[e]),r=e.includes("norm"),n=!r&&!e.startsWith("float"),o=e.startsWith("s");return{dataType:s[e],byteLength:t,integer:n,signed:o,normalized:r}}r.d(t,{l:()=>n});const s={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},i={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4}},34045:(e,t,r)=>{r.d(t,{Y:()=>a,z:()=>c});var n=r(56821),s=r(23265);const i=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],o=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function a(e){return i.some((t=>e.startsWith(t)))}function c(e){let t=function(e){const t=(0,s.q)(e),r=t.bytesPerPixel||1,n=t.bitsPerChannel||[8,8,8,8];delete t.bitsPerChannel,delete t.bytesPerPixel,delete t.f,delete t.render,delete t.filter,delete t.blend,delete t.store;const i={...t,format:e,attachment:t.attachment||"color",channels:t.channels||"r",components:t.components||t.channels?.length||1,bytesPerPixel:r,bitsPerChannel:n,dataType:t.dataType||"uint8",srgb:t.srgb??!1,packed:t.packed??!1,webgl:t.webgl??!1,integer:t.integer??!1,signed:t.signed??!1,normalized:t.normalized??!1,compressed:t.compressed??!1};return i}(e);if(a(e)){t.channels="rgb",t.components=3,t.bytesPerPixel=1,t.srgb=!1,t.compressed=!0;const r=function(e){const t=/.*-(\d+)x(\d+)-.*/.exec(e);if(t){const[,e,r]=t;return{blockWidth:Number(e),blockHeight:Number(r)}}return null}(e);r&&(t.blockWidth=r.blockWidth,t.blockHeight=r.blockHeight)}const r=o.exec(e);if(r){const[,s,i,o,a,c]=r,u=`${o}${i}`,l=(0,n.l)(u),h=8*l.byteLength,d=s.length,f=[h,d>=2?h:0,d>=3?h:0,d>=4?h:0];t={format:e,attachment:t.attachment,dataType:l.dataType,components:d,channels:s,integer:l.integer,signed:l.signed,normalized:l.normalized,bitsPerChannel:f,bytesPerPixel:l.byteLength*s.length,packed:t.packed,srgb:t.srgb},"-webgl"===c&&(t.webgl=!0),"-srgb"===a&&(t.srgb=!0)}return e.endsWith("-webgl")&&(t.webgl=!0),e.endsWith("-srgb")&&(t.srgb=!0),t}},23265:(e,t,r)=>{r.d(t,{q:()=>p});const n="texture-compression-bc",s="texture-compression-astc",i="texture-compression-etc2",o="texture-compression-pvrtc-webgl",a="texture-compression-atc-webgl",c="float32-renderable-webgl",u="float16-renderable-webgl",l="snorm8-renderable-webgl",h="norm16-renderable-webgl",d="snorm16-renderable-webgl",f="float32-filterable",_="float16-filterable-webgl";function p(e){const t=g[e];if(!t)throw new Error(`Unsupported texture format ${e}`);return t}const g={r8unorm:{},r8snorm:{render:l},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:l},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:u,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:h},"r16snorm-webgl":{f:d},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:l},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:u,filter:_},"rg16unorm-webgl":{render:h},"rg16snorm-webgl":{render:d},r32uint:{},r32sint:{},r32float:{render:c,filter:f},rgb9e5ufloat:{channels:"rgb",packed:!0,render:"rgb9e5ufloat-renderable-webgl"},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:c},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:h},"rgb16snorm-webgl":{f:h},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:f},rgba16uint:{},rgba16sint:{},rgba16float:{render:u,filter:_},"rgba16unorm-webgl":{render:h},"rgba16snorm-webgl":{render:d},"rgb32float-webgl":{render:c,filter:f},rgba32uint:{},rgba32sint:{},rgba32float:{render:c,filter:f},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:n},"bc1-rgb-unorm-srgb-webgl":{f:n},"bc1-rgba-unorm":{f:n},"bc1-rgba-unorm-srgb":{f:n},"bc2-rgba-unorm":{f:n},"bc2-rgba-unorm-srgb":{f:n},"bc3-rgba-unorm":{f:n},"bc3-rgba-unorm-srgb":{f:n},"bc4-r-unorm":{f:n},"bc4-r-snorm":{f:n},"bc5-rg-unorm":{f:n},"bc5-rg-snorm":{f:n},"bc6h-rgb-ufloat":{f:n},"bc6h-rgb-float":{f:n},"bc7-rgba-unorm":{f:n},"bc7-rgba-unorm-srgb":{f:n},"etc2-rgb8unorm":{f:i},"etc2-rgb8unorm-srgb":{f:i},"etc2-rgb8a1unorm":{f:i},"etc2-rgb8a1unorm-srgb":{f:i},"etc2-rgba8unorm":{f:i},"etc2-rgba8unorm-srgb":{f:i},"eac-r11unorm":{f:i},"eac-r11snorm":{f:i},"eac-rg11unorm":{f:i},"eac-rg11snorm":{f:i},"astc-4x4-unorm":{f:s},"astc-4x4-unorm-srgb":{f:s},"astc-5x4-unorm":{f:s},"astc-5x4-unorm-srgb":{f:s},"astc-5x5-unorm":{f:s},"astc-5x5-unorm-srgb":{f:s},"astc-6x5-unorm":{f:s},"astc-6x5-unorm-srgb":{f:s},"astc-6x6-unorm":{f:s},"astc-6x6-unorm-srgb":{f:s},"astc-8x5-unorm":{f:s},"astc-8x5-unorm-srgb":{f:s},"astc-8x6-unorm":{f:s},"astc-8x6-unorm-srgb":{f:s},"astc-8x8-unorm":{f:s},"astc-8x8-unorm-srgb":{f:s},"astc-10x5-unorm":{f:s},"astc-10x5-unorm-srgb":{f:s},"astc-10x6-unorm":{f:s},"astc-10x6-unorm-srgb":{f:s},"astc-10x8-unorm":{f:s},"astc-10x8-unorm-srgb":{f:s},"astc-10x10-unorm":{f:s},"astc-10x10-unorm-srgb":{f:s},"astc-12x10-unorm":{f:s},"astc-12x10-unorm-srgb":{f:s},"astc-12x12-unorm":{f:s},"astc-12x12-unorm-srgb":{f:s},"pvrtc-rgb4unorm-webgl":{f:o},"pvrtc-rgba4unorm-webgl":{f:o},"pvrtc-rbg2unorm-webgl":{f:o},"pvrtc-rgba2unorm-webgl":{f:o},"etc1-rbg-unorm-webgl":{f:"texture-compression-etc1-webgl"},"atc-rgb-unorm-webgl":{f:a},"atc-rgba-unorm-webgl":{f:a},"atc-rgbai-unorm-webgl":{f:a}}},84529:(e,t,r)=>{function n(e){const t=ArrayBuffer.isView(e)?e.constructor:e;switch(t){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(t.constructor.name)}}function s(e){switch(e){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(e)}}function i(e,t,r){if(!t||t>4)throw new Error(`size ${t}`);const s=t;let i=n(e);if("uint8"===i&&r&&1===s)return"unorm8-webgl";if("uint8"===i&&r&&3===s)return"unorm8x3-webgl";if("uint8"===i||"sint8"===i){if(1===s||3===s)throw new Error(`size: ${t}`);return r&&(i=i.replace("int","norm")),`${i}x${s}`}if("uint16"===i||"sint16"===i){if(1===s||3===s)throw new Error(`size: ${t}`);return r&&(i=i.replace("int","norm")),`${i}x${s}`}return 1===s?i:`${i}x${s}`}r.d(t,{OB:()=>i,UE:()=>n,Y0:()=>s})},73390:(e,t,r)=>{let n;function s(e){return(!n||n.byteLength<e)&&(n=new ArrayBuffer(e)),n}function i(e,t){return new e(s(e.BYTES_PER_ELEMENT*t),0,t)}r.d(t,{X:()=>i,o:()=>s})},29651:(e,t,r)=>{r.d(t,{R:()=>n});const n=new(r(85335).t)({id:"luma.gl"})},76028:(e,t,r)=>{r.d(t,{d:()=>s});var n=r(97983);const s=new class{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new n.A({id:e})),this.stats.get(e)}}},74683:(e,t,r)=>{r.d(t,{L:()=>s});const n={};function s(e="id"){n[e]=n[e]||1;return`${e}-${n[e]++}`}},59658:(e,t,r)=>{r.d(t,{F:()=>a});var n=r(95850);var s=r(97983);let i=0;const o={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:n.a.stats.get("animation-loop-"+i++),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class a{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...o,...e},!(e=this.props).device)throw new Error("No device provided");const{useDevicePixels:t=!0}=this.props;this.stats=e.stats||new s.A({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:t}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(e){this.props.onError(e),this._error=Error();const t=this.device?.canvasContext?.canvas;if(t instanceof HTMLCanvasElement){const t=document.createElement("h1");t.innerHTML=e.message,t.style.position="absolute",t.style.top="20%",t.style.left="10px",t.style.color="black",t.style.backgroundColor="red",document.body.appendChild(t)}}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(!1!==e&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error||(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers()),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((e=>{this._resolveNextFrame=e}))),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){var e;this._running&&(this._animationFrameId=(e=this._animationFrame.bind(this),"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)))}_cancelAnimationFrame(){var e;null!==this._animationFrameId&&(e=this._animationFrameId,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){this.display?this.display._renderFrame(e):(this.props.onRender(this._getAnimationProps()),this.device?.submit())}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.canvasContext?.canvas;if(!this.device||!e)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:e,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:r}=this._getSizeAndAspect();e===this.animationProps.width&&t===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const r=this.props.onAddHTML(t);r&&(t.innerHTML=r)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,t]=this.device?.canvasContext?.getPixelSize()||[1,1];let r=1;const n=this.device?.canvasContext?.canvas;return n&&n.clientHeight?r=n.clientWidth/n.clientHeight:e>0&&t>0&&(r=e/t),{width:e,height:t,aspect:r}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}},3726:(e,t,r)=>{r.d(t,{K:()=>i});let n=1,s=1;class i{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:t=0,duration:r=Number.POSITIVE_INFINITY,rate:s=1,repeat:i=1}=e,o=n++,a={time:0,delay:t,duration:r,rate:s,repeat:i};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,r]of this.animations)r.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const n of t)this._setChannelTime(n,this.time);const r=this.animations.values();for(const n of r){const{animation:e,channel:t}=n;e.setTime(this.getTime(t))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const r=s++;return this.animations.set(r,{animation:e,channel:t}),e.setTime(this.getTime(t)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const r=t-e.delay;r>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}},68475:(e,t,r)=>{r.d(t,{p:()=>o});var n=r(26839),s=r(73288),i=r(51771);class o{device;model;transformFeedback;static defaultProps={...i.K.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return"webgl"===e?.info?.type}constructor(e,t=o.defaultProps){if(!o.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new i.K(this.device,{id:t.id||"buffer-transform-model",fs:t.fs||(0,s.Wk)(),topology:t.topology||"point-list",varyings:t.outputs||t.varyings,...t}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(!t)throw new Error("BufferTransform#getBuffer");if(t instanceof n.h)return t.readAsync();const{buffer:r,byteOffset:s=0,byteLength:i=r.byteLength}=t;return r.readAsync(s,i)}}},51771:(e,t,r)=>{r.d(t,{K:()=>ft});var n=r(22512),s=r(29651);class i{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find((t=>t.name===e))||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map((e=>e.attribute)):[e.name]}mergeBufferLayouts(e,t){const r=[...e];for(const n of t){const e=r.findIndex((e=>e.name===n.name));e<0?r.push(n):r[e]=n}return r}}var o=r(26839);function a(e){return Array.isArray(e)?0===e.length||"number"==typeof e[0]:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)}class c{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const t=e?.shaderLayout.bindings?.find((t=>"uniform"===t.type&&t.name===e?.name));if(!t)throw new Error(e?.name);const r=t;for(const e of r.uniforms||[])this.bindingLayout[e.name]=e}}setUniforms(e){for(const[t,r]of Object.entries(e))this._setUniform(t,r),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${t}=${r}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){var r;(function(e,t){if(e!==t)return!1;const r=e,n=t;if(!a(r))return!1;if(a(n)&&r.length===n.length)for(let s=0;s<r.length;++s)if(n[s]!==r[s])return!1;return!0})(this.uniforms[e],t)||(this.uniforms[e]=a(r=t)?r.slice():r,this.modifiedUniforms[e]=!0,this.modified=!0)}}const u={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function l(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}var h=r(73390);class d{layout={};byteLength;constructor(e){let t=0;for(const[n,s]of Object.entries(e)){const e=u[s],{type:r,components:i}=e;t=l(t,i);const o=t;t+=i,this.layout[n]={type:r,size:i,offset:o}}t+=(4-t%4)%4;const r=4*t;this.byteLength=Math.max(r,1024)}getData(e){const t=Math.max(this.byteLength,1024),r=(0,h.o)(t),n={i32:new Int32Array(r),u32:new Uint32Array(r),f32:new Float32Array(r),f16:new Uint16Array(r)};for(const[i,o]of Object.entries(e)){const e=this.layout[i];if(!e){s.R.warn(`Supplied uniform value ${i} not present in uniform block layout`)();continue}const{type:t,size:r,offset:c}=e,u=n[t];if(1===r){if("number"!=typeof o&&"boolean"!=typeof o){s.R.warn(`Supplied value for single component uniform ${i} is not a number: ${o}`)();continue}u[c]=Number(o)}else{if(!a(o)){s.R.warn(`Supplied value for multi component / array uniform ${i} is not a numeric array: ${o}`)();continue}u.set(o,c)}}return new Uint8Array(r)}has(e){return Boolean(this.layout[e])}get(e){return this.layout[e]}}class f{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(const[t,r]of Object.entries(e)){const e=t,n=new d(r.uniformTypes||{});this.uniformBufferLayouts.set(e,n);const s=new c({name:t});s.setUniforms(r.defaultUniforms||{}),this.uniformBlocks.set(e,s)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[t,r]of Object.entries(e))this.uniformBlocks.get(t)?.setUniforms(r);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const t=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(t)}createUniformBuffer(e,t,r){r&&this.setUniforms(r);const n=this.getUniformBufferByteLength(t),s=e.createBuffer({usage:o.h.UNIFORM|o.h.COPY_DST,byteLength:n}),i=this.getUniformBufferData(t);return s.write(i),s}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const r=this.getUniformBufferByteLength(t),n=e.createBuffer({usage:o.h.UNIFORM|o.h.COPY_DST,byteLength:r});this.uniformBuffers.set(t,n)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const r=this.updateUniformBuffer(t);e||=r}return e&&s.R.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const t=this.uniformBlocks.get(e);let r=this.uniformBuffers.get(e),n=!1;if(r&&t?.needsRedraw){n||=t.needsRedraw;const i=this.getUniformBufferData(e);r=this.uniformBuffers.get(e),r?.write(i);const o=this.uniformBlocks.get(e)?.getAllUniforms();s.R.log(4,`Writing to uniform buffer ${String(e)}`,i,o)()}return n}}var _,p,g,m,E,b=r(75638),T=r(80698),y=r(89277),A=r(40428),R=r(84529),S=r(3189);class w{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class v{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(e){throw new Error("Cannot evaluate node")}evaluateString(e){return this.evaluate(e).toString()}search(e){}searchBlock(e,t){if(e){t(x.instance);for(const r of e)r instanceof Array?this.searchBlock(r,t):r.search(t);t(C.instance)}}}class x extends v{}x.instance=new x;class C extends v{}C.instance=new C;class N extends v{constructor(){super()}}class I extends N{constructor(e,t,r,n,s,i){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=r,this.body=n,this.startLine=s,this.endLine=i}get astNodeType(){return"function"}search(e){this.searchBlock(this.body,e)}}class L extends N{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class O extends N{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class M extends N{constructor(e){super(),this.body=e}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class P extends N{constructor(e,t,r,n){super(),this.init=e,this.condition=t,this.increment=r,this.body=n}get astNodeType(){return"for"}search(e){var t,r,n;null===(t=this.init)||void 0===t||t.search(e),null===(r=this.condition)||void 0===r||r.search(e),null===(n=this.increment)||void 0===n||n.search(e),this.searchBlock(this.body,e)}}class F extends N{constructor(e,t,r,n,s){super(),this.name=e,this.type=t,this.storage=r,this.access=n,this.value=s}get astNodeType(){return"var"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class B extends N{constructor(e,t,r){super(),this.name=e,this.type=t,this.value=r}get astNodeType(){return"override"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class k extends N{constructor(e,t,r,n,s){super(),this.name=e,this.type=t,this.storage=r,this.access=n,this.value=s}get astNodeType(){return"let"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class D extends N{constructor(e,t,r,n,s){super(),this.name=e,this.type=t,this.storage=r,this.access=n,this.value=s}get astNodeType(){return"const"}evaluate(e){return this.value.evaluate(e)}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}!function(e){e.increment="++",e.decrement="--"}(_||(_={})),function(e){e.parse=function(t){const r=t;if("parse"==r)throw new Error("Invalid value for IncrementOperator");return e[r]}}(_||(_={}));class U extends N{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}!function(e){e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="}(p||(p={})),function(e){e.parse=function(e){const t=e;if("parse"==t)throw new Error("Invalid value for AssignOperator");return t}}(p||(p={}));class G extends N{constructor(e,t,r){super(),this.operator=e,this.variable=t,this.value=r}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class W extends N{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}search(e){for(const t of this.args)t.search(e);e(this)}}class H extends N{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}}class X extends N{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"body"}}class V extends N{constructor(e,t,r,n){super(),this.condition=e,this.body=t,this.elseif=r,this.else=n}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class $ extends N{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class z extends N{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class K extends N{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class Y extends N{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class j extends N{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}class q extends N{constructor(){super()}get astNodeType(){return"discard"}}class Z extends N{constructor(){super()}get astNodeType(){return"break"}}class Q extends N{constructor(){super()}get astNodeType(){return"continue"}}class J extends N{constructor(e){super(),this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}}class ee extends J{constructor(e,t,r,n){super(e),this.members=t,this.startLine=r,this.endLine=n}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}}class te extends J{constructor(e,t,r){super(e),this.format=t,this.access=r}get astNodeType(){return"template"}}class re extends J{constructor(e,t,r,n){super(e),this.storage=t,this.type=r,this.access=n}get astNodeType(){return"pointer"}}class ne extends J{constructor(e,t,r,n){super(e),this.attributes=t,this.format=r,this.count=n}get astNodeType(){return"array"}get isArray(){return!0}}class se extends J{constructor(e,t,r){super(e),this.format=t,this.access=r}get astNodeType(){return"sampler"}}class ie extends v{constructor(){super()}}class oe extends ie{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}}class ae extends ie{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){e(this);for(const t of this.args)t.search(e)}}class ce extends ie{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"callExpr"}evaluate(e){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(e));case"acos":return Math.acos(this.args[0].evaluate(e));case"acosh":return Math.acosh(this.args[0].evaluate(e));case"asin":return Math.asin(this.args[0].evaluate(e));case"asinh":return Math.asinh(this.args[0].evaluate(e));case"atan":return Math.atan(this.args[0].evaluate(e));case"atan2":return Math.atan2(this.args[0].evaluate(e),this.args[1].evaluate(e));case"atanh":return Math.atanh(this.args[0].evaluate(e));case"ceil":return Math.ceil(this.args[0].evaluate(e));case"clamp":return Math.min(Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e)),this.args[2].evaluate(e));case"cos":return Math.cos(this.args[0].evaluate(e));case"degrees":return 180*this.args[0].evaluate(e)/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(e)-this.args[1].evaluate(e),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(e));case"exp2":return Math.pow(2,this.args[0].evaluate(e));case"floor":return Math.floor(this.args[0].evaluate(e));case"fma":return this.args[0].evaluate(e)*this.args[1].evaluate(e)+this.args[2].evaluate(e);case"fract":case"modf":return this.args[0].evaluate(e)-Math.floor(this.args[0].evaluate(e));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(e));case"log":return Math.log(this.args[0].evaluate(e));case"log2":return Math.log2(this.args[0].evaluate(e));case"max":return Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e));case"min":return Math.min(this.args[0].evaluate(e),this.args[1].evaluate(e));case"mix":return this.args[0].evaluate(e)*(1-this.args[2].evaluate(e))+this.args[1].evaluate(e)*this.args[2].evaluate(e);case"pow":return Math.pow(this.args[0].evaluate(e),this.args[1].evaluate(e));case"radians":return this.args[0].evaluate(e)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(e));case"sign":return Math.sign(this.args[0].evaluate(e));case"sin":return Math.sin(this.args[0].evaluate(e));case"sinh":return Math.sinh(this.args[0].evaluate(e));case"saturate":return Math.min(Math.max(this.args[0].evaluate(e),0),1);case"smoothstep":return this.args[0].evaluate(e)*this.args[0].evaluate(e)*(3-2*this.args[0].evaluate(e));case"sqrt":return Math.sqrt(this.args[0].evaluate(e));case"step":return this.args[0].evaluate(e)<this.args[1].evaluate(e)?0:1;case"tan":return Math.tan(this.args[0].evaluate(e));case"tanh":return Math.tanh(this.args[0].evaluate(e));case"trunc":return Math.trunc(this.args[0].evaluate(e));default:throw new Error("Non const function: "+this.name)}}search(e){for(const t of this.args)t.search(e);e(this)}}class ue extends ie{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}evaluate(e){const t=e.constants.get(this.name);if(!t)throw new Error("Cannot evaluate node");return t.evaluate(e)}}class le extends ie{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}evaluate(e){var t,r;if(this.initializer instanceof ae){const n=null===(t=this.postfix)||void 0===t?void 0:t.evaluateString(e),s=null===(r=this.initializer.type)||void 0===r?void 0:r.name,i=e.structs.get(s),o=null==i?void 0:i.getMemberIndex(n);if(-1!=o){return this.initializer.args[o].evaluate(e)}console.log(o)}return this.initializer.evaluate(e)}search(e){this.initializer.search(e)}}class he extends ie{constructor(e){super(),this.value=e}get astNodeType(){return"literalExpr"}evaluate(){return this.value}}class de extends ie{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class fe extends ie{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"typecastExpr"}evaluate(e){return this.args[0].evaluate(e)}search(e){this.searchBlock(this.args,e)}}class _e extends ie{constructor(e){super(),this.contents=e}get astNodeType(){return"groupExpr"}evaluate(e){return this.contents[0].evaluate(e)}search(e){this.searchBlock(this.contents,e)}}class pe extends ie{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class ge extends ie{constructor(){super()}}class me extends ge{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}evaluate(e){switch(this.operator){case"+":return this.right.evaluate(e);case"-":return-this.right.evaluate(e);case"!":return this.right.evaluate(e)?0:1;case"~":return~this.right.evaluate(e);default:throw new Error("Unknown unary operator: "+this.operator)}}search(e){this.right.search(e)}}class Ee extends ge{constructor(e,t,r){super(),this.operator=e,this.left=t,this.right=r}get astNodeType(){return"binaryOp"}evaluate(e){switch(this.operator){case"+":return this.left.evaluate(e)+this.right.evaluate(e);case"-":return this.left.evaluate(e)-this.right.evaluate(e);case"*":return this.left.evaluate(e)*this.right.evaluate(e);case"/":return this.left.evaluate(e)/this.right.evaluate(e);case"%":return this.left.evaluate(e)%this.right.evaluate(e);case"==":return this.left.evaluate(e)==this.right.evaluate(e)?1:0;case"!=":return this.left.evaluate(e)!=this.right.evaluate(e)?1:0;case"<":return this.left.evaluate(e)<this.right.evaluate(e)?1:0;case">":return this.left.evaluate(e)>this.right.evaluate(e)?1:0;case"<=":return this.left.evaluate(e)<=this.right.evaluate(e)?1:0;case">=":return this.left.evaluate(e)>=this.right.evaluate(e)?1:0;case"&&":return this.left.evaluate(e)&&this.right.evaluate(e)?1:0;case"||":return this.left.evaluate(e)||this.right.evaluate(e)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}search(e){this.left.search(e),this.right.search(e)}}class be extends v{constructor(){super()}}class Te extends be{constructor(e,t){super(),this.selector=e,this.body=t}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class ye extends be{constructor(e){super(),this.body=e}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class Ae extends v{constructor(e,t,r){super(),this.name=e,this.type=t,this.attributes=r}get astNodeType(){return"argument"}}class Re extends v{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class Se extends v{constructor(e,t,r){super(),this.name=e,this.type=t,this.attributes=r}get astNodeType(){return"member"}}class we extends v{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}!function(e){e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"}(m||(m={}));class ve{constructor(e,t,r){this.name=e,this.type=t,this.rule=r}toString(){return this.name}}class xe{}g=xe,xe.none=new ve("",m.reserved,""),xe.eof=new ve("EOF",m.token,""),xe.reserved={asm:new ve("asm",m.reserved,"asm"),bf16:new ve("bf16",m.reserved,"bf16"),do:new ve("do",m.reserved,"do"),enum:new ve("enum",m.reserved,"enum"),f16:new ve("f16",m.reserved,"f16"),f64:new ve("f64",m.reserved,"f64"),handle:new ve("handle",m.reserved,"handle"),i8:new ve("i8",m.reserved,"i8"),i16:new ve("i16",m.reserved,"i16"),i64:new ve("i64",m.reserved,"i64"),mat:new ve("mat",m.reserved,"mat"),premerge:new ve("premerge",m.reserved,"premerge"),regardless:new ve("regardless",m.reserved,"regardless"),typedef:new ve("typedef",m.reserved,"typedef"),u8:new ve("u8",m.reserved,"u8"),u16:new ve("u16",m.reserved,"u16"),u64:new ve("u64",m.reserved,"u64"),unless:new ve("unless",m.reserved,"unless"),using:new ve("using",m.reserved,"using"),vec:new ve("vec",m.reserved,"vec"),void:new ve("void",m.reserved,"void")},xe.keywords={array:new ve("array",m.keyword,"array"),atomic:new ve("atomic",m.keyword,"atomic"),bool:new ve("bool",m.keyword,"bool"),f32:new ve("f32",m.keyword,"f32"),i32:new ve("i32",m.keyword,"i32"),mat2x2:new ve("mat2x2",m.keyword,"mat2x2"),mat2x3:new ve("mat2x3",m.keyword,"mat2x3"),mat2x4:new ve("mat2x4",m.keyword,"mat2x4"),mat3x2:new ve("mat3x2",m.keyword,"mat3x2"),mat3x3:new ve("mat3x3",m.keyword,"mat3x3"),mat3x4:new ve("mat3x4",m.keyword,"mat3x4"),mat4x2:new ve("mat4x2",m.keyword,"mat4x2"),mat4x3:new ve("mat4x3",m.keyword,"mat4x3"),mat4x4:new ve("mat4x4",m.keyword,"mat4x4"),ptr:new ve("ptr",m.keyword,"ptr"),sampler:new ve("sampler",m.keyword,"sampler"),sampler_comparison:new ve("sampler_comparison",m.keyword,"sampler_comparison"),struct:new ve("struct",m.keyword,"struct"),texture_1d:new ve("texture_1d",m.keyword,"texture_1d"),texture_2d:new ve("texture_2d",m.keyword,"texture_2d"),texture_2d_array:new ve("texture_2d_array",m.keyword,"texture_2d_array"),texture_3d:new ve("texture_3d",m.keyword,"texture_3d"),texture_cube:new ve("texture_cube",m.keyword,"texture_cube"),texture_cube_array:new ve("texture_cube_array",m.keyword,"texture_cube_array"),texture_multisampled_2d:new ve("texture_multisampled_2d",m.keyword,"texture_multisampled_2d"),texture_storage_1d:new ve("texture_storage_1d",m.keyword,"texture_storage_1d"),texture_storage_2d:new ve("texture_storage_2d",m.keyword,"texture_storage_2d"),texture_storage_2d_array:new ve("texture_storage_2d_array",m.keyword,"texture_storage_2d_array"),texture_storage_3d:new ve("texture_storage_3d",m.keyword,"texture_storage_3d"),texture_depth_2d:new ve("texture_depth_2d",m.keyword,"texture_depth_2d"),texture_depth_2d_array:new ve("texture_depth_2d_array",m.keyword,"texture_depth_2d_array"),texture_depth_cube:new ve("texture_depth_cube",m.keyword,"texture_depth_cube"),texture_depth_cube_array:new ve("texture_depth_cube_array",m.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new ve("texture_depth_multisampled_2d",m.keyword,"texture_depth_multisampled_2d"),texture_external:new ve("texture_external",m.keyword,"texture_external"),u32:new ve("u32",m.keyword,"u32"),vec2:new ve("vec2",m.keyword,"vec2"),vec3:new ve("vec3",m.keyword,"vec3"),vec4:new ve("vec4",m.keyword,"vec4"),bitcast:new ve("bitcast",m.keyword,"bitcast"),block:new ve("block",m.keyword,"block"),break:new ve("break",m.keyword,"break"),case:new ve("case",m.keyword,"case"),continue:new ve("continue",m.keyword,"continue"),continuing:new ve("continuing",m.keyword,"continuing"),default:new ve("default",m.keyword,"default"),diagnostic:new ve("diagnostic",m.keyword,"diagnostic"),discard:new ve("discard",m.keyword,"discard"),else:new ve("else",m.keyword,"else"),enable:new ve("enable",m.keyword,"enable"),fallthrough:new ve("fallthrough",m.keyword,"fallthrough"),false:new ve("false",m.keyword,"false"),fn:new ve("fn",m.keyword,"fn"),for:new ve("for",m.keyword,"for"),function:new ve("function",m.keyword,"function"),if:new ve("if",m.keyword,"if"),let:new ve("let",m.keyword,"let"),const:new ve("const",m.keyword,"const"),loop:new ve("loop",m.keyword,"loop"),while:new ve("while",m.keyword,"while"),private:new ve("private",m.keyword,"private"),read:new ve("read",m.keyword,"read"),read_write:new ve("read_write",m.keyword,"read_write"),return:new ve("return",m.keyword,"return"),requires:new ve("requires",m.keyword,"requires"),storage:new ve("storage",m.keyword,"storage"),switch:new ve("switch",m.keyword,"switch"),true:new ve("true",m.keyword,"true"),alias:new ve("alias",m.keyword,"alias"),type:new ve("type",m.keyword,"type"),uniform:new ve("uniform",m.keyword,"uniform"),var:new ve("var",m.keyword,"var"),override:new ve("override",m.keyword,"override"),workgroup:new ve("workgroup",m.keyword,"workgroup"),write:new ve("write",m.keyword,"write"),r8unorm:new ve("r8unorm",m.keyword,"r8unorm"),r8snorm:new ve("r8snorm",m.keyword,"r8snorm"),r8uint:new ve("r8uint",m.keyword,"r8uint"),r8sint:new ve("r8sint",m.keyword,"r8sint"),r16uint:new ve("r16uint",m.keyword,"r16uint"),r16sint:new ve("r16sint",m.keyword,"r16sint"),r16float:new ve("r16float",m.keyword,"r16float"),rg8unorm:new ve("rg8unorm",m.keyword,"rg8unorm"),rg8snorm:new ve("rg8snorm",m.keyword,"rg8snorm"),rg8uint:new ve("rg8uint",m.keyword,"rg8uint"),rg8sint:new ve("rg8sint",m.keyword,"rg8sint"),r32uint:new ve("r32uint",m.keyword,"r32uint"),r32sint:new ve("r32sint",m.keyword,"r32sint"),r32float:new ve("r32float",m.keyword,"r32float"),rg16uint:new ve("rg16uint",m.keyword,"rg16uint"),rg16sint:new ve("rg16sint",m.keyword,"rg16sint"),rg16float:new ve("rg16float",m.keyword,"rg16float"),rgba8unorm:new ve("rgba8unorm",m.keyword,"rgba8unorm"),rgba8unorm_srgb:new ve("rgba8unorm_srgb",m.keyword,"rgba8unorm_srgb"),rgba8snorm:new ve("rgba8snorm",m.keyword,"rgba8snorm"),rgba8uint:new ve("rgba8uint",m.keyword,"rgba8uint"),rgba8sint:new ve("rgba8sint",m.keyword,"rgba8sint"),bgra8unorm:new ve("bgra8unorm",m.keyword,"bgra8unorm"),bgra8unorm_srgb:new ve("bgra8unorm_srgb",m.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new ve("rgb10a2unorm",m.keyword,"rgb10a2unorm"),rg11b10float:new ve("rg11b10float",m.keyword,"rg11b10float"),rg32uint:new ve("rg32uint",m.keyword,"rg32uint"),rg32sint:new ve("rg32sint",m.keyword,"rg32sint"),rg32float:new ve("rg32float",m.keyword,"rg32float"),rgba16uint:new ve("rgba16uint",m.keyword,"rgba16uint"),rgba16sint:new ve("rgba16sint",m.keyword,"rgba16sint"),rgba16float:new ve("rgba16float",m.keyword,"rgba16float"),rgba32uint:new ve("rgba32uint",m.keyword,"rgba32uint"),rgba32sint:new ve("rgba32sint",m.keyword,"rgba32sint"),rgba32float:new ve("rgba32float",m.keyword,"rgba32float"),static_assert:new ve("static_assert",m.keyword,"static_assert")},xe.tokens={decimal_float_literal:new ve("decimal_float_literal",m.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new ve("hex_float_literal",m.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new ve("int_literal",m.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new ve("uint_literal",m.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new ve("ident",m.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new ve("and",m.token,"&"),and_and:new ve("and_and",m.token,"&&"),arrow:new ve("arrow ",m.token,"->"),attr:new ve("attr",m.token,"@"),forward_slash:new ve("forward_slash",m.token,"/"),bang:new ve("bang",m.token,"!"),bracket_left:new ve("bracket_left",m.token,"["),bracket_right:new ve("bracket_right",m.token,"]"),brace_left:new ve("brace_left",m.token,"{"),brace_right:new ve("brace_right",m.token,"}"),colon:new ve("colon",m.token,":"),comma:new ve("comma",m.token,","),equal:new ve("equal",m.token,"="),equal_equal:new ve("equal_equal",m.token,"=="),not_equal:new ve("not_equal",m.token,"!="),greater_than:new ve("greater_than",m.token,">"),greater_than_equal:new ve("greater_than_equal",m.token,">="),shift_right:new ve("shift_right",m.token,">>"),less_than:new ve("less_than",m.token,"<"),less_than_equal:new ve("less_than_equal",m.token,"<="),shift_left:new ve("shift_left",m.token,"<<"),modulo:new ve("modulo",m.token,"%"),minus:new ve("minus",m.token,"-"),minus_minus:new ve("minus_minus",m.token,"--"),period:new ve("period",m.token,"."),plus:new ve("plus",m.token,"+"),plus_plus:new ve("plus_plus",m.token,"++"),or:new ve("or",m.token,"|"),or_or:new ve("or_or",m.token,"||"),paren_left:new ve("paren_left",m.token,"("),paren_right:new ve("paren_right",m.token,")"),semicolon:new ve("semicolon",m.token,";"),star:new ve("star",m.token,"*"),tilde:new ve("tilde",m.token,"~"),underscore:new ve("underscore",m.token,"_"),xor:new ve("xor",m.token,"^"),plus_equal:new ve("plus_equal",m.token,"+="),minus_equal:new ve("minus_equal",m.token,"-="),times_equal:new ve("times_equal",m.token,"*="),division_equal:new ve("division_equal",m.token,"/="),modulo_equal:new ve("modulo_equal",m.token,"%="),and_equal:new ve("and_equal",m.token,"&="),or_equal:new ve("or_equal",m.token,"|="),xor_equal:new ve("xor_equal",m.token,"^="),shift_right_equal:new ve("shift_right_equal",m.token,">>="),shift_left_equal:new ve("shift_left_equal",m.token,"<<=")},xe.simpleTokens={"@":g.tokens.attr,"{":g.tokens.brace_left,"}":g.tokens.brace_right,":":g.tokens.colon,",":g.tokens.comma,"(":g.tokens.paren_left,")":g.tokens.paren_right,";":g.tokens.semicolon},xe.literalTokens={"&":g.tokens.and,"&&":g.tokens.and_and,"->":g.tokens.arrow,"/":g.tokens.forward_slash,"!":g.tokens.bang,"[":g.tokens.bracket_left,"]":g.tokens.bracket_right,"=":g.tokens.equal,"==":g.tokens.equal_equal,"!=":g.tokens.not_equal,">":g.tokens.greater_than,">=":g.tokens.greater_than_equal,">>":g.tokens.shift_right,"<":g.tokens.less_than,"<=":g.tokens.less_than_equal,"<<":g.tokens.shift_left,"%":g.tokens.modulo,"-":g.tokens.minus,"--":g.tokens.minus_minus,".":g.tokens.period,"+":g.tokens.plus,"++":g.tokens.plus_plus,"|":g.tokens.or,"||":g.tokens.or_or,"*":g.tokens.star,"~":g.tokens.tilde,_:g.tokens.underscore,"^":g.tokens.xor,"+=":g.tokens.plus_equal,"-=":g.tokens.minus_equal,"*=":g.tokens.times_equal,"/=":g.tokens.division_equal,"%=":g.tokens.modulo_equal,"&=":g.tokens.and_equal,"|=":g.tokens.or_equal,"^=":g.tokens.xor_equal,">>=":g.tokens.shift_right_equal,"<<=":g.tokens.shift_left_equal},xe.regexTokens={decimal_float_literal:g.tokens.decimal_float_literal,hex_float_literal:g.tokens.hex_float_literal,int_literal:g.tokens.int_literal,uint_literal:g.tokens.uint_literal,ident:g.tokens.ident},xe.storage_class=[g.keywords.function,g.keywords.private,g.keywords.workgroup,g.keywords.uniform,g.keywords.storage],xe.access_mode=[g.keywords.read,g.keywords.write,g.keywords.read_write],xe.sampler_type=[g.keywords.sampler,g.keywords.sampler_comparison],xe.sampled_texture_type=[g.keywords.texture_1d,g.keywords.texture_2d,g.keywords.texture_2d_array,g.keywords.texture_3d,g.keywords.texture_cube,g.keywords.texture_cube_array],xe.multisampled_texture_type=[g.keywords.texture_multisampled_2d],xe.storage_texture_type=[g.keywords.texture_storage_1d,g.keywords.texture_storage_2d,g.keywords.texture_storage_2d_array,g.keywords.texture_storage_3d],xe.depth_texture_type=[g.keywords.texture_depth_2d,g.keywords.texture_depth_2d_array,g.keywords.texture_depth_cube,g.keywords.texture_depth_cube_array,g.keywords.texture_depth_multisampled_2d],xe.texture_external_type=[g.keywords.texture_external],xe.any_texture_type=[...g.sampled_texture_type,...g.multisampled_texture_type,...g.storage_texture_type,...g.depth_texture_type,...g.texture_external_type],xe.texel_format=[g.keywords.r8unorm,g.keywords.r8snorm,g.keywords.r8uint,g.keywords.r8sint,g.keywords.r16uint,g.keywords.r16sint,g.keywords.r16float,g.keywords.rg8unorm,g.keywords.rg8snorm,g.keywords.rg8uint,g.keywords.rg8sint,g.keywords.r32uint,g.keywords.r32sint,g.keywords.r32float,g.keywords.rg16uint,g.keywords.rg16sint,g.keywords.rg16float,g.keywords.rgba8unorm,g.keywords.rgba8unorm_srgb,g.keywords.rgba8snorm,g.keywords.rgba8uint,g.keywords.rgba8sint,g.keywords.bgra8unorm,g.keywords.bgra8unorm_srgb,g.keywords.rgb10a2unorm,g.keywords.rg11b10float,g.keywords.rg32uint,g.keywords.rg32sint,g.keywords.rg32float,g.keywords.rgba16uint,g.keywords.rgba16sint,g.keywords.rgba16float,g.keywords.rgba32uint,g.keywords.rgba32sint,g.keywords.rgba32float],xe.const_literal=[g.tokens.int_literal,g.tokens.uint_literal,g.tokens.decimal_float_literal,g.tokens.hex_float_literal,g.keywords.true,g.keywords.false],xe.literal_or_ident=[g.tokens.ident,g.tokens.int_literal,g.tokens.uint_literal,g.tokens.decimal_float_literal,g.tokens.hex_float_literal],xe.element_count_expression=[g.tokens.int_literal,g.tokens.uint_literal,g.tokens.ident],xe.template_types=[g.keywords.vec2,g.keywords.vec3,g.keywords.vec4,g.keywords.mat2x2,g.keywords.mat2x3,g.keywords.mat2x4,g.keywords.mat3x2,g.keywords.mat3x3,g.keywords.mat3x4,g.keywords.mat4x2,g.keywords.mat4x3,g.keywords.mat4x4,g.keywords.atomic,g.keywords.bitcast,...g.any_texture_type],xe.attribute_name=[g.tokens.ident,g.keywords.block,g.keywords.diagnostic],xe.assignment_operators=[g.tokens.equal,g.tokens.plus_equal,g.tokens.minus_equal,g.tokens.times_equal,g.tokens.division_equal,g.tokens.modulo_equal,g.tokens.and_equal,g.tokens.or_equal,g.tokens.xor_equal,g.tokens.shift_right_equal,g.tokens.shift_left_equal],xe.increment_operators=[g.tokens.plus_plus,g.tokens.minus_minus];class Ce{constructor(e,t,r){this.type=e,this.lexeme=t,this.line=r}toString(){return this.lexeme}isTemplateType(){return-1!=xe.template_types.indexOf(this.type)}isArrayType(){return this.type==xe.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class Ne{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=null!=e?e:""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new Ce(xe.eof,"",this._line)),this._tokens}scanToken(){let e=this._advance();if("\n"==e)return this._line++,!0;if(this._isWhitespace(e))return!0;if("/"==e){if("/"==this._peekAhead()){for(;"\n"!=e;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if("*"==this._peekAhead()){this._advance();let t=1;for(;t>0;){if(this._isAtEnd())return!0;if(e=this._advance(),"\n"==e)this._line++;else if("*"==e){if("/"==this._peekAhead()&&(this._advance(),t--,0==t))return!0}else"/"==e&&"*"==this._peekAhead()&&(this._advance(),t++)}return!0}}const t=xe.simpleTokens[e];if(t)return this._addToken(t),!0;let r=xe.none;const n=this._isAlpha(e),s="_"===e;if(this._isAlphaNumeric(e)){let t=this._peekAhead();for(;this._isAlphaNumeric(t);)e+=this._advance(),t=this._peekAhead()}if(n){const t=xe.keywords[e];if(t)return this._addToken(t),!0}if(n||s)return this._addToken(xe.tokens.ident),!0;for(;;){let t=this._findType(e);const n=this._peekAhead();if(">"==e&&(">"==n||"="==n)){let e=!1,r=this._tokens.length-1;for(let t=0;t<5&&r>=0&&-1===xe.assignment_operators.indexOf(this._tokens[r].type);++t,--r)if(this._tokens[r].type===xe.tokens.less_than){r>0&&this._tokens[r-1].isArrayOrTemplateType()&&(e=!0);break}if(e)return this._addToken(t),!0}if(t===xe.none){let n=e,s=0;const i=2;for(let e=0;e<i;++e)if(n+=this._peekAhead(e),t=this._findType(n),t!==xe.none){s=e;break}if(t===xe.none)return r!==xe.none&&(this._current--,this._addToken(r),!0);e=n,this._current+=s+1}if(r=t,this._isAtEnd())break;e+=this._advance()}return r!==xe.none&&(this._addToken(r),!0)}_findType(e){for(const r in xe.regexTokens){const t=xe.regexTokens[r];if(this._match(e,t.rule))return t}const t=xe.literalTokens[e];return t||xe.none}_match(e,t){const r=t.exec(e);return r&&0==r.index&&r[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}_isAlphaNumeric(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||"_"==e||e>="0"&&e<="9"}_isWhitespace(e){return" "==e||"\t"==e||"\r"==e}_advance(e=0){let t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new Ce(e,t,this._line))}}class Ie{constructor(){this._tokens=[],this._current=0,this._currentLine=0,this._context=new w,this._deferArrayCountEval=[]}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const e=this._global_decl_or_directive();if(!e)break;t.push(e)}if(this._deferArrayCountEval.length>0){for(const e of this._deferArrayCountEval){const t=e.arrayType,n=e.countNode;if(n instanceof ue){const e=n.name,s=this._context.constants.get(e);if(s)try{const e=s.evaluate(this._context);t.count=e}catch(r){}}}this._deferArrayCountEval.length=0}return t}_initialize(e){if(e)if("string"==typeof e){const t=new Ne(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_error(e,t){return{token:e,message:t,toString:function(){return`${t}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==xe.eof}_match(e){if(e instanceof ve)return!!this._check(e)&&(this._advance(),!0);for(let t=0,r=e.length;t<r;++t){const r=e[t];if(this._check(r))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),t)}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const r=t.type;return-1!=e.indexOf(r)}return t.type==e}_advance(){var e,t;return this._currentLine=null!==(t=null===(e=this._peek())||void 0===e?void 0:e.line)&&void 0!==t?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(xe.tokens.semicolon)&&!this._isAtEnd(););if(this._match(xe.keywords.alias)){const e=this._type_alias();return this._consume(xe.tokens.semicolon,"Expected ';'"),e}if(this._match(xe.keywords.diagnostic)){const e=this._diagnostic();return this._consume(xe.tokens.semicolon,"Expected ';'"),e}if(this._match(xe.keywords.requires)){const e=this._requires_directive();return this._consume(xe.tokens.semicolon,"Expected ';'"),e}if(this._match(xe.keywords.enable)){const e=this._enable_directive();return this._consume(xe.tokens.semicolon,"Expected ';'"),e}const e=this._attribute();if(this._check(xe.keywords.var)){const t=this._global_variable_decl();return null!=t&&(t.attributes=e),this._consume(xe.tokens.semicolon,"Expected ';'."),t}if(this._check(xe.keywords.override)){const t=this._override_variable_decl();return null!=t&&(t.attributes=e),this._consume(xe.tokens.semicolon,"Expected ';'."),t}if(this._check(xe.keywords.let)){const t=this._global_let_decl();return null!=t&&(t.attributes=e),this._consume(xe.tokens.semicolon,"Expected ';'."),t}if(this._check(xe.keywords.const)){const t=this._global_const_decl();return null!=t&&(t.attributes=e),this._consume(xe.tokens.semicolon,"Expected ';'."),t}if(this._check(xe.keywords.struct)){const t=this._struct_decl();return null!=t&&(t.attributes=e),t}if(this._check(xe.keywords.fn)){const t=this._function_decl();return null!=t&&(t.attributes=e),t}return null}_function_decl(){if(!this._match(xe.keywords.fn))return null;const e=this._currentLine,t=this._consume(xe.tokens.ident,"Expected function name.").toString();this._consume(xe.tokens.paren_left,"Expected '(' for function arguments.");const r=[];if(!this._check(xe.tokens.paren_right))do{if(this._check(xe.tokens.paren_right))break;const e=this._attribute(),t=this._consume(xe.tokens.ident,"Expected argument name.").toString();this._consume(xe.tokens.colon,"Expected ':' for argument type.");const n=this._attribute(),s=this._type_decl();null!=s&&(s.attributes=n,r.push(new Ae(t,s,e)))}while(this._match(xe.tokens.comma));this._consume(xe.tokens.paren_right,"Expected ')' after function arguments.");let n=null;if(this._match(xe.tokens.arrow)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}const s=this._compound_statement(),i=this._currentLine;return new I(t,r,n,s,e,i)}_compound_statement(){const e=[];for(this._consume(xe.tokens.brace_left,"Expected '{' for block.");!this._check(xe.tokens.brace_right);){const t=this._statement();null!==t&&e.push(t)}return this._consume(xe.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(xe.tokens.semicolon)&&!this._isAtEnd(););if(this._check(xe.tokens.attr)&&this._attribute(),this._check(xe.keywords.if))return this._if_statement();if(this._check(xe.keywords.switch))return this._switch_statement();if(this._check(xe.keywords.loop))return this._loop_statement();if(this._check(xe.keywords.for))return this._for_statement();if(this._check(xe.keywords.while))return this._while_statement();if(this._check(xe.keywords.continuing))return this._continuing_statement();if(this._check(xe.keywords.static_assert))return this._static_assert_statement();if(this._check(xe.tokens.brace_left))return this._compound_statement();let e=null;return e=this._check(xe.keywords.return)?this._return_statement():this._check([xe.keywords.var,xe.keywords.let,xe.keywords.const])?this._variable_statement():this._match(xe.keywords.discard)?new q:this._match(xe.keywords.break)?new Z:this._match(xe.keywords.continue)?new Q:this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),null!=e&&this._consume(xe.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(xe.keywords.static_assert))return null;const e=this._optional_paren_expression();return new L(e)}_while_statement(){if(!this._match(xe.keywords.while))return null;const e=this._optional_paren_expression();this._check(xe.tokens.attr)&&this._attribute();const t=this._compound_statement();return new O(e,t)}_continuing_statement(){if(!this._match(xe.keywords.continuing))return null;const e=this._compound_statement();return new M(e)}_for_statement(){if(!this._match(xe.keywords.for))return null;this._consume(xe.tokens.paren_left,"Expected '('.");const e=this._check(xe.tokens.semicolon)?null:this._for_init();this._consume(xe.tokens.semicolon,"Expected ';'.");const t=this._check(xe.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(xe.tokens.semicolon,"Expected ';'.");const r=this._check(xe.tokens.paren_right)?null:this._for_increment();this._consume(xe.tokens.paren_right,"Expected ')'."),this._check(xe.tokens.attr)&&this._attribute();const n=this._compound_statement();return new P(e,t,r,n)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(xe.keywords.var)){const e=this._variable_decl();if(null===e)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(xe.tokens.equal)&&(t=this._short_circuit_or_expression()),new F(e.name,e.type,e.storage,e.access,t)}if(this._match(xe.keywords.let)){const e=this._consume(xe.tokens.ident,"Expected name for let.").toString();let t=null;if(this._match(xe.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}this._consume(xe.tokens.equal,"Expected '=' for let.");const r=this._short_circuit_or_expression();return new k(e,t,null,null,r)}if(this._match(xe.keywords.const)){const e=this._consume(xe.tokens.ident,"Expected name for const.").toString();let t=null;if(this._match(xe.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}this._consume(xe.tokens.equal,"Expected '=' for const.");const r=this._short_circuit_or_expression();return new D(e,t,null,null,r)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(null==t)return null;if(!this._check(xe.increment_operators))return this._current=e,null;const r=this._consume(xe.increment_operators,"Expected increment operator");return new U(r.type===xe.tokens.plus_plus?_.increment:_.decrement,t)}_assignment_statement(){let e=null;if(this._check(xe.tokens.brace_right))return null;let t=this._match(xe.tokens.underscore);if(t||(e=this._unary_expression()),!t&&null==e)return null;const r=this._consume(xe.assignment_operators,"Expected assignment operator."),n=this._short_circuit_or_expression();return new G(p.parse(r.lexeme),e,n)}_func_call_statement(){if(!this._check(xe.tokens.ident))return null;const e=this._current,t=this._consume(xe.tokens.ident,"Expected function name."),r=this._argument_expression_list();return null===r?(this._current=e,null):new W(t.lexeme,r)}_loop_statement(){if(!this._match(xe.keywords.loop))return null;this._check(xe.tokens.attr)&&this._attribute(),this._consume(xe.tokens.brace_left,"Expected '{' for loop.");const e=[];let t=this._statement();for(;null!==t;){if(Array.isArray(t))for(let r of t)e.push(r);else e.push(t);t=this._statement()}let r=null;return this._match(xe.keywords.continuing)&&(r=this._compound_statement()),this._consume(xe.tokens.brace_right,"Expected '}' for loop."),new H(e,r)}_switch_statement(){if(!this._match(xe.keywords.switch))return null;const e=this._optional_paren_expression();this._check(xe.tokens.attr)&&this._attribute(),this._consume(xe.tokens.brace_left,"Expected '{' for switch.");const t=this._switch_body();if(null==t||0==t.length)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(xe.tokens.brace_right,"Expected '}' for switch."),new X(e,t)}_switch_body(){const e=[];if(this._match(xe.keywords.case)){const t=this._case_selectors();this._match(xe.tokens.colon),this._check(xe.tokens.attr)&&this._attribute(),this._consume(xe.tokens.brace_left,"Exected '{' for switch case.");const r=this._case_body();this._consume(xe.tokens.brace_right,"Exected '}' for switch case."),e.push(new Te(t,r))}if(this._match(xe.keywords.default)){this._match(xe.tokens.colon),this._check(xe.tokens.attr)&&this._attribute(),this._consume(xe.tokens.brace_left,"Exected '{' for switch default.");const t=this._case_body();this._consume(xe.tokens.brace_right,"Exected '}' for switch default."),e.push(new ye(t))}if(this._check([xe.keywords.default,xe.keywords.case])){const t=this._switch_body();e.push(t[0])}return e}_case_selectors(){const e=[this._shift_expression()];for(;this._match(xe.tokens.comma);)e.push(this._shift_expression());return e}_case_body(){if(this._match(xe.keywords.fallthrough))return this._consume(xe.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(null==e)return[];e instanceof Array||(e=[e]);const t=this._case_body();return 0==t.length?e:[...e,t[0]]}_if_statement(){if(!this._match(xe.keywords.if))return null;const e=this._optional_paren_expression();this._check(xe.tokens.attr)&&this._attribute();const t=this._compound_statement();let r=[];this._match_elseif()&&(this._check(xe.tokens.attr)&&this._attribute(),r=this._elseif_statement(r));let n=null;return this._match(xe.keywords.else)&&(this._check(xe.tokens.attr)&&this._attribute(),n=this._compound_statement()),new V(e,t,r,n)}_match_elseif(){return this._tokens[this._current].type===xe.keywords.else&&this._tokens[this._current+1].type===xe.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const t=this._optional_paren_expression(),r=this._compound_statement();return e.push(new Re(t,r)),this._match_elseif()&&(this._check(xe.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(xe.keywords.return))return null;const e=this._short_circuit_or_expression();return new $(e)}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(xe.tokens.or_or);)e=new Ee(this._previous().toString(),e,this._short_circuit_and_expr());return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(xe.tokens.and_and);)e=new Ee(this._previous().toString(),e,this._inclusive_or_expression());return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(xe.tokens.or);)e=new Ee(this._previous().toString(),e,this._exclusive_or_expression());return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(xe.tokens.xor);)e=new Ee(this._previous().toString(),e,this._and_expression());return e}_and_expression(){let e=this._equality_expression();for(;this._match(xe.tokens.and);)e=new Ee(this._previous().toString(),e,this._equality_expression());return e}_equality_expression(){const e=this._relational_expression();return this._match([xe.tokens.equal_equal,xe.tokens.not_equal])?new Ee(this._previous().toString(),e,this._relational_expression()):e}_relational_expression(){let e=this._shift_expression();for(;this._match([xe.tokens.less_than,xe.tokens.greater_than,xe.tokens.less_than_equal,xe.tokens.greater_than_equal]);)e=new Ee(this._previous().toString(),e,this._shift_expression());return e}_shift_expression(){let e=this._additive_expression();for(;this._match([xe.tokens.shift_left,xe.tokens.shift_right]);)e=new Ee(this._previous().toString(),e,this._additive_expression());return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([xe.tokens.plus,xe.tokens.minus]);)e=new Ee(this._previous().toString(),e,this._multiplicative_expression());return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([xe.tokens.star,xe.tokens.forward_slash,xe.tokens.modulo]);)e=new Ee(this._previous().toString(),e,this._unary_expression());return e}_unary_expression(){return this._match([xe.tokens.minus,xe.tokens.bang,xe.tokens.tilde,xe.tokens.star,xe.tokens.and])?new me(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(xe.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(xe.tokens.bracket_right,"Expected ']'.");const t=new pe(e),r=this._postfix_expression();return r&&(t.postfix=r),t}if(this._match(xe.tokens.period)){const e=this._consume(xe.tokens.ident,"Expected member name."),t=this._postfix_expression(),r=new oe(e.lexeme);return t&&(r.postfix=t),r}return null}_getStruct(e){if(this._context.aliases.has(e)){return this._context.aliases.get(e).type}if(this._context.structs.has(e)){return this._context.structs.get(e)}return null}_primary_expression(){if(this._match(xe.tokens.ident)){const e=this._previous().toString();if(this._check(xe.tokens.paren_left)){const t=this._argument_expression_list(),r=this._getStruct(e);return null!=r?new ae(r,t):new ce(e,t)}if(this._context.constants.has(e)){const t=this._context.constants.get(e);return new le(e,t.value)}return new ue(e)}if(this._match(xe.const_literal))return new he(parseFloat(this._previous().toString()));if(this._check(xe.tokens.paren_left))return this._paren_expression();if(this._match(xe.keywords.bitcast)){this._consume(xe.tokens.less_than,"Expected '<'.");const e=this._type_decl();this._consume(xe.tokens.greater_than,"Expected '>'.");const t=this._paren_expression();return new de(e,t)}const e=this._type_decl(),t=this._argument_expression_list();return new fe(e,t)}_argument_expression_list(){if(!this._match(xe.tokens.paren_left))return null;const e=[];do{if(this._check(xe.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(xe.tokens.comma));return this._consume(xe.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(xe.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(xe.tokens.paren_right),new _e([e])}_paren_expression(){this._consume(xe.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(xe.tokens.paren_right,"Expected ')'."),new _e([e])}_struct_decl(){if(!this._match(xe.keywords.struct))return null;const e=this._currentLine,t=this._consume(xe.tokens.ident,"Expected name for struct.").toString();this._consume(xe.tokens.brace_left,"Expected '{' for struct body.");const r=[];for(;!this._check(xe.tokens.brace_right);){const e=this._attribute(),t=this._consume(xe.tokens.ident,"Expected variable name.").toString();this._consume(xe.tokens.colon,"Expected ':' for struct member type.");const n=this._attribute(),s=this._type_decl();null!=s&&(s.attributes=n),this._check(xe.tokens.brace_right)?this._match(xe.tokens.comma):this._consume(xe.tokens.comma,"Expected ',' for struct member."),r.push(new Se(t,s,e))}this._consume(xe.tokens.brace_right,"Expected '}' after struct body.");const n=this._currentLine,s=new ee(t,r,e,n);return this._context.structs.set(t,s),s}_global_variable_decl(){const e=this._variable_decl();return e&&this._match(xe.tokens.equal)&&(e.value=this._const_expression()),e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(xe.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){if(!this._match(xe.keywords.const))return null;const e=this._consume(xe.tokens.ident,"Expected variable name");let t=null;if(this._match(xe.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}let r=null;if(this._match(xe.tokens.equal)){const e=this._short_circuit_or_expression();if(e instanceof ae)r=e;else if(e instanceof le&&e.initializer instanceof ae)r=e.initializer;else try{const t=e.evaluate(this._context);r=new he(t)}catch(g){r=e}}const n=new D(e.toString(),t,"","",r);return this._context.constants.set(n.name,n),n}_global_let_decl(){if(!this._match(xe.keywords.let))return null;const e=this._consume(xe.tokens.ident,"Expected variable name");let t=null;if(this._match(xe.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}let r=null;return this._match(xe.tokens.equal)&&(r=this._const_expression()),new k(e.toString(),t,"","",r)}_const_expression(){if(this._match(xe.const_literal))return new oe(this._previous().toString());const e=this._type_decl();this._consume(xe.tokens.paren_left,"Expected '('.");let t=[];for(;!this._check(xe.tokens.paren_right)&&(t.push(this._const_expression()),this._check(xe.tokens.comma));)this._advance();return this._consume(xe.tokens.paren_right,"Expected ')'."),new ae(e,t)}_variable_decl(){if(!this._match(xe.keywords.var))return null;let e="",t="";this._match(xe.tokens.less_than)&&(e=this._consume(xe.storage_class,"Expected storage_class.").toString(),this._match(xe.tokens.comma)&&(t=this._consume(xe.access_mode,"Expected access_mode.").toString()),this._consume(xe.tokens.greater_than,"Expected '>'."));const r=this._consume(xe.tokens.ident,"Expected variable name");let n=null;if(this._match(xe.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}return new F(r.toString(),n,e,t,null)}_override_decl(){if(!this._match(xe.keywords.override))return null;const e=this._consume(xe.tokens.ident,"Expected variable name");let t=null;if(this._match(xe.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}return new B(e.toString(),t,null)}_diagnostic(){this._consume(xe.tokens.paren_left,"Expected '('");const e=this._consume(xe.tokens.ident,"Expected severity control name.");this._consume(xe.tokens.comma,"Expected ','");const t=this._consume(xe.tokens.ident,"Expected diagnostic rule name.");return this._consume(xe.tokens.paren_right,"Expected ')'"),new Y(e.toString(),t.toString())}_enable_directive(){const e=this._consume(xe.tokens.ident,"identity expected.");return new z(e.toString())}_requires_directive(){const e=[this._consume(xe.tokens.ident,"identity expected.").toString()];for(;this._match(xe.tokens.comma);){const t=this._consume(xe.tokens.ident,"identity expected.");e.push(t.toString())}return new K(e)}_type_alias(){const e=this._consume(xe.tokens.ident,"identity expected.");this._consume(xe.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(null===t)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const r=new j(e.toString(),t);return this._context.aliases.set(r.name,r),r}_type_decl(){if(this._check([xe.tokens.ident,...xe.texel_format,xe.keywords.bool,xe.keywords.f32,xe.keywords.i32,xe.keywords.u32])){const e=this._advance(),t=e.toString();return this._context.structs.has(t)?this._context.structs.get(t):this._context.aliases.has(t)?this._context.aliases.get(t).type:new J(e.toString())}let e=this._texture_sampler_types();if(e)return e;if(this._check(xe.template_types)){let e=this._advance().toString(),t=null,r=null;return this._match(xe.tokens.less_than)&&(t=this._type_decl(),r=null,this._match(xe.tokens.comma)&&(r=this._consume(xe.access_mode,"Expected access_mode for pointer").toString()),this._consume(xe.tokens.greater_than,"Expected '>' for type.")),new te(e,t,r)}if(this._match(xe.keywords.ptr)){let e=this._previous().toString();this._consume(xe.tokens.less_than,"Expected '<' for pointer.");const t=this._consume(xe.storage_class,"Expected storage_class for pointer");this._consume(xe.tokens.comma,"Expected ',' for pointer.");const r=this._type_decl();let n=null;return this._match(xe.tokens.comma)&&(n=this._consume(xe.access_mode,"Expected access_mode for pointer").toString()),this._consume(xe.tokens.greater_than,"Expected '>' for pointer."),new re(e,t.toString(),r,n)}const t=this._attribute();if(this._match(xe.keywords.array)){let e=null,n=-1;const s=this._previous();let i=null;if(this._match(xe.tokens.less_than)){e=this._type_decl(),this._context.aliases.has(e.name)&&(e=this._context.aliases.get(e.name).type);let t="";if(this._match(xe.tokens.comma)){i=this._shift_expression();try{t=i.evaluate(this._context).toString(),i=null}catch(r){t="1"}}this._consume(xe.tokens.greater_than,"Expected '>' for array."),n=t?parseInt(t):0}const o=new ne(s.toString(),t,e,n);return i&&this._deferArrayCountEval.push({arrayType:o,countNode:i}),o}return null}_texture_sampler_types(){if(this._match(xe.sampler_type))return new se(this._previous().toString(),null,null);if(this._match(xe.depth_texture_type))return new se(this._previous().toString(),null,null);if(this._match(xe.sampled_texture_type)||this._match(xe.multisampled_texture_type)){const e=this._previous();this._consume(xe.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(xe.tokens.greater_than,"Expected '>' for sampler type."),new se(e.toString(),t,null)}if(this._match(xe.storage_texture_type)){const e=this._previous();this._consume(xe.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(xe.texel_format,"Invalid texel format.").toString();this._consume(xe.tokens.comma,"Expected ',' after texel format.");const r=this._consume(xe.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(xe.tokens.greater_than,"Expected '>' for sampler type."),new se(e.toString(),t,r)}return null}_attribute(){let e=[];for(;this._match(xe.tokens.attr);){const t=this._consume(xe.attribute_name,"Expected attribute name"),r=new we(t.toString(),null);if(this._match(xe.tokens.paren_left)){if(r.value=this._consume(xe.literal_or_ident,"Expected attribute value").toString(),this._check(xe.tokens.comma)){this._advance();do{const e=this._consume(xe.literal_or_ident,"Expected attribute value").toString();r.value instanceof Array||(r.value=[r.value]),r.value.push(e)}while(this._match(xe.tokens.comma))}this._consume(xe.tokens.paren_right,"Expected ')'")}e.push(r)}return 0==e.length?null:e}}class Le{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}}class Oe{constructor(e,t,r){this.name=e,this.type=t,this.attributes=r,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Me extends Le{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class Pe extends Le{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}}class Fe extends Le{constructor(e,t,r,n){super(e,r),this.format=t,this.access=n}get isTemplate(){return!0}}!function(e){e[e.Uniform=0]="Uniform",e[e.Storage=1]="Storage",e[e.Texture=2]="Texture",e[e.Sampler=3]="Sampler",e[e.StorageTexture=4]="StorageTexture"}(E||(E={}));class Be{constructor(e,t,r,n,s,i,o){this.name=e,this.type=t,this.group=r,this.binding=n,this.attributes=s,this.resourceType=i,this.access=o}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class ke{constructor(e,t){this.name=e,this.type=t}}class De{constructor(e,t){this.align=e,this.size=t}}class Ue{constructor(e,t,r,n){this.name=e,this.type=t,this.locationType=r,this.location=n,this.interpolation=null}}class Ge{constructor(e,t,r,n){this.name=e,this.type=t,this.locationType=r,this.location=n}}class We{constructor(e,t=null){this.stage=null,this.inputs=[],this.outputs=[],this.resources=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t}}class He{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}class Xe{constructor(e,t,r,n){this.name=e,this.type=t,this.attributes=r,this.id=n}}class Ve{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class $e{constructor(e){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new He,this.functions=[],this._types=new Map,this._functions=new Map,e&&this.update(e)}_isStorageTexture(e){return"texture_storage_1d"==e.name||"texture_storage_2d"==e.name||"texture_storage_2d_array"==e.name||"texture_storage_3d"==e.name}update(e){const t=(new Ie).parse(e);for(const r of t)r instanceof I&&this._functions.set(r.name,new Ve(r));for(const r of t)if(r instanceof ee){const e=this._getTypeInfo(r,null);e instanceof Me&&this.structs.push(e)}for(const r of t)if(r instanceof j)this.aliases.push(this._getAliasInfo(r));else if(r instanceof B){const e=r,t=this._getAttributeNum(e.attributes,"id",0),n=null!=e.type?this._getTypeInfo(e.type,e.attributes):null;this.overrides.push(new Xe(e.name,n,e.attributes,t))}else if(this._isUniformVar(r)){const e=r,t=this._getAttributeNum(e.attributes,"group",0),n=this._getAttributeNum(e.attributes,"binding",0),s=this._getTypeInfo(e.type,e.attributes),i=new Be(e.name,s,t,n,e.attributes,E.Uniform,e.access);this.uniforms.push(i)}else if(this._isStorageVar(r)){const e=r,t=this._getAttributeNum(e.attributes,"group",0),n=this._getAttributeNum(e.attributes,"binding",0),s=this._getTypeInfo(e.type,e.attributes),i=this._isStorageTexture(s),o=new Be(e.name,s,t,n,e.attributes,i?E.StorageTexture:E.Storage,e.access);this.storage.push(o)}else if(this._isTextureVar(r)){const e=r,t=this._getAttributeNum(e.attributes,"group",0),n=this._getAttributeNum(e.attributes,"binding",0),s=this._getTypeInfo(e.type,e.attributes),i=this._isStorageTexture(s),o=new Be(e.name,s,t,n,e.attributes,i?E.StorageTexture:E.Texture,e.access);i?this.storage.push(o):this.textures.push(o)}else if(this._isSamplerVar(r)){const e=r,t=this._getAttributeNum(e.attributes,"group",0),n=this._getAttributeNum(e.attributes,"binding",0),s=this._getTypeInfo(e.type,e.attributes),i=new Be(e.name,s,t,n,e.attributes,E.Sampler,e.access);this.samplers.push(i)}else if(r instanceof I){const e=this._getAttribute(r,"vertex"),t=this._getAttribute(r,"fragment"),n=this._getAttribute(r,"compute"),s=e||t||n,i=new We(r.name,null==s?void 0:s.name);i.startLine=r.startLine,i.endLine=r.endLine,this.functions.push(i),this._functions.get(r.name).info=i,s&&(this._functions.get(r.name).inUse=!0,i.inUse=!0,i.resources=this._findResources(r,!!s),i.inputs=this._getInputs(r.args),i.outputs=this._getOutputs(r.returnType),this.entry[s.name].push(i))}else;for(const r of this._functions.values())r.info&&(r.info.inUse=r.inUse,this._addCalls(r.node,r.info.calls));for(const r of this.uniforms)this._markStructsInUse(r.type);for(const r of this.storage)this._markStructsInUse(r.type)}_markStructsInUse(e){if(e.isStruct){e.inUse=!0;for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var r;for(const n of e.calls){const e=null===(r=this._functions.get(n.name))||void 0===r?void 0:r.info;e&&t.add(e)}}findResource(e,t){for(const r of this.uniforms)if(r.group==e&&r.binding==t)return r;for(const r of this.storage)if(r.group==e&&r.binding==t)return r;for(const r of this.textures)if(r.group==e&&r.binding==t)return r;for(const r of this.samplers)if(r.group==e&&r.binding==t)return r;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this._getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const r=[],n=this,s=[];return e.search((i=>{if(i instanceof x)s.push({});else if(i instanceof C)s.pop();else if(i instanceof F){const e=i;t&&null!==e.type&&this._markStructsFromAST(e.type),s.length>0&&(s[s.length-1][e.name]=e)}else if(i instanceof ae){const e=i;t&&null!==e.type&&this._markStructsFromAST(e.type)}else if(i instanceof k){const e=i;t&&null!==e.type&&this._markStructsFromAST(e.type),s.length>0&&(s[s.length-1][e.name]=e)}else if(i instanceof ue){const e=i;if(s.length>0){if(s[s.length-1][e.name])return}const t=n._findResource(e.name);t&&r.push(t)}else if(i instanceof ce){const s=i,o=n._functions.get(s.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=n._findResources(o.node,t)),r.push(...o.resources))}else if(i instanceof W){const s=i,o=n._functions.get(s.name);o&&(t&&(o.inUse=!0),e.calls.add(o.node),null===o.resources&&(o.resources=n._findResources(o.node,t)),r.push(...o.resources))}})),[...new Map(r.map((e=>[e.name,e]))).values()]}getBindGroups(){const e=[];function t(t,r){t>=e.length&&(e.length=t+1),void 0===e[t]&&(e[t]=[]),r>=e[t].length&&(e[t].length=r+1)}for(const r of this.uniforms){t(r.group,r.binding);e[r.group][r.binding]=r}for(const r of this.storage){t(r.group,r.binding);e[r.group][r.binding]=r}for(const r of this.textures){t(r.group,r.binding);e[r.group][r.binding]=r}for(const r of this.samplers){t(r.group,r.binding);e[r.group][r.binding]=r}return e}_getOutputs(e,t=void 0){if(void 0===t&&(t=[]),e instanceof ee)this._getStructOutputs(e,t);else{const r=this._getOutputInfo(e);null!==r&&t.push(r)}return t}_getStructOutputs(e,t){for(const r of e.members)if(r.type instanceof ee)this._getStructOutputs(r.type,t);else{const e=this._getAttribute(r,"location")||this._getAttribute(r,"builtin");if(null!==e){const n=this._getTypeInfo(r.type,r.type.attributes),s=this._parseInt(e.value),i=new Ge(r.name,n,e.name,s);t.push(i)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const r=this._getTypeInfo(e,e.attributes),n=this._parseInt(t.value);return new Ge("",r,t.name,n)}return null}_getInputs(e,t=void 0){void 0===t&&(t=[]);for(const r of e)if(r.type instanceof ee)this._getStructInputs(r.type,t);else{const e=this._getInputInfo(r);null!==e&&t.push(e)}return t}_getStructInputs(e,t){for(const r of e.members)if(r.type instanceof ee)this._getStructInputs(r.type,t);else{const e=this._getInputInfo(r);null!==e&&t.push(e)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const r=this._getAttribute(e,"interpolation"),n=this._getTypeInfo(e.type,e.attributes),s=this._parseInt(t.value),i=new Ue(e.name,n,t.name,s);return null!==r&&(i.interpolation=this._parseString(r.value)),i}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new ke(e.name,this._getTypeInfo(e.type,null))}_getTypeInfo(e,t){if(this._types.has(e))return this._types.get(e);if(e instanceof ne){const r=e,n=this._getTypeInfo(r.format,r.attributes),s=new Pe(r.name,t);return s.format=n,s.count=r.count,this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof ee){const r=e,n=new Me(r.name,t);n.startLine=r.startLine,n.endLine=r.endLine;for(const e of r.members){const t=this._getTypeInfo(e.type,e.attributes);n.members.push(new Oe(e.name,t,e.attributes))}return this._types.set(e,n),this._updateTypeInfo(n),n}if(e instanceof se){const r=e,n=r.format instanceof J,s=r.format?n?this._getTypeInfo(r.format,null):new Le(r.format,null):null,i=new Fe(r.name,s,t,r.access);return this._types.set(e,i),this._updateTypeInfo(i),i}if(e instanceof te){const r=e,n=r.format?this._getTypeInfo(r.format,null):null,s=new Fe(r.name,n,t,r.access);return this._types.set(e,s),this._updateTypeInfo(s),s}const r=new Le(e.name,t);return this._types.set(e,r),this._updateTypeInfo(r),r}_updateTypeInfo(e){var t,r;const n=this._getTypeSize(e);if(e.size=null!==(t=null==n?void 0:n.size)&&void 0!==t?t:0,e instanceof Pe){const t=this._getTypeSize(e.format);e.stride=null!==(r=null==t?void 0:t.size)&&void 0!==r?r:0,this._updateTypeInfo(e.format)}e instanceof Me&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let r=0,n=0,s=0,i=0;for(let o=0,a=e.members.length;o<a;++o){const a=e.members[o],c=this._getTypeSize(a);if(!c)continue;null!==(t=this._getAlias(a.type.name))&&void 0!==t||a.type;const u=c.align,l=c.size;r=this._roundUp(u,r+n),n=l,s=r,i=Math.max(i,u),a.offset=r,a.size=l,this._updateTypeInfo(a.type)}e.size=this._roundUp(i,s+n),e.align=i}_getTypeSize(e){var t;if(null==e)return null;const r=this._getAttributeNum(e.attributes,"size",0),n=this._getAttributeNum(e.attributes,"align",0);if(e instanceof Oe&&(e=e.type),e instanceof Le){const t=this._getAlias(e.name);null!==t&&(e=t)}{const t=$e._typeInfo[e.name];if(void 0!==t){const s="f16"===e.format?2:1;return new De(Math.max(n,t.align/s),Math.max(r,t.size/s))}}{const t=$e._typeInfo[e.name.substring(0,e.name.length-1)];if(t){const s="h"===e.name[e.name.length-1]?2:1;return new De(Math.max(n,t.align/s),Math.max(r,t.size/s))}}if(e instanceof Pe){let s=e,i=8,o=8;const a=this._getTypeSize(s.format);null!==a&&(o=a.size,i=a.align);return o=s.count*this._getAttributeNum(null!==(t=null==e?void 0:e.attributes)&&void 0!==t?t:null,"stride",this._roundUp(i,o)),r&&(o=r),new De(Math.max(n,i),Math.max(r,o))}if(e instanceof Me){let t=0,s=0,i=0,o=0,a=0;for(const r of e.members){const e=this._getTypeSize(r.type);null!==e&&(t=Math.max(e.align,t),i=this._roundUp(e.align,i+o),o=e.size,a=i)}return s=this._roundUp(t,a+o),new De(Math.max(n,t),Math.max(r,s))}return null}_isUniformVar(e){return e instanceof F&&"uniform"==e.storage}_isStorageVar(e){return e instanceof F&&"storage"==e.storage}_isTextureVar(e){return e instanceof F&&null!==e.type&&-1!=$e._textureTypes.indexOf(e.type.name)}_isSamplerVar(e){return e instanceof F&&null!==e.type&&-1!=$e._samplerTypes.indexOf(e.type.name)}_getAttribute(e,t){const r=e;if(!r||!r.attributes)return null;const n=r.attributes;for(let s of n)if(s.name==t)return s;return null}_getAttributeNum(e,t,r){if(null===e)return r;for(let n of e)if(n.name==t){let e=null!==n&&null!==n.value?n.value:r;return e instanceof Array&&(e=e[0]),"number"==typeof e?e:"string"==typeof e?parseInt(e):r}return r}_roundUp(e,t){return Math.ceil(t/e)*e}}function ze(e){const t={attributes:[],bindings:[]};let r;try{r=function(e){try{return new $e(e)}catch(t){if(t instanceof Error)throw t;let e="WGSL parse error";throw"object"==typeof t&&t?.message&&(e+=`: ${t.message} `),"object"==typeof t&&t?.token&&(e+=t.token.line||""),new Error(e,{cause:t})}}(e)}catch(o){return s.R.error(o.message)(),t}for(const s of r.uniforms){const e=[];for(const t of s.type?.members||[])e.push({name:t.name,type:Ke(t.type)});t.bindings.push({type:"uniform",name:s.name,group:s.group,location:s.binding,members:e})}for(const s of r.textures)t.bindings.push({type:"texture",name:s.name,group:s.group,location:s.binding});for(const s of r.samplers)t.bindings.push({type:"sampler",name:s.name,group:s.group,location:s.binding});const n=r.entry.vertex[0],i=n?.inputs.length||0;for(let s=0;s<i;s++){const e=n.inputs[s];if("location"===e.locationType){const r=Ke(e.type);t.attributes.push({name:e.name,location:Number(e.location),type:r})}}return t}function Ke(e){return e.format?`${e.name}<${e.format.name}>`:e.name}$e._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},$e._textureTypes=xe.any_texture_type.map((e=>e.name)),$e._samplerTypes=xe.sampler_type.map((e=>e.name));var Ye=r(4500);class je{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||(0,Ye.L)("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&o.h.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function qe(e,t){if(t instanceof je)return t;const r=function(e,t){if(!t.indices)return;const r=t.indices.value;return e.createBuffer({usage:o.h.INDEX,data:r})}(e,t),{attributes:n,bufferLayout:s}=function(e,t){const r=[],n={};for(const[i,o]of Object.entries(t.attributes)){let t=i;switch(i){case"POSITION":t="positions";break;case"NORMAL":t="normals";break;case"TEXCOORD_0":t="texCoords";break;case"COLOR_0":t="colors"}if(o){n[t]=e.createBuffer({data:o.value,id:`${i}-buffer`});const{value:s,size:a,normalized:c}=o;r.push({name:t,format:(0,R.OB)(s,a,c)})}}const s=t._calculateVertexCount(t.attributes,t.indices);return{attributes:n,bufferLayout:r,vertexCount:s}}(e,t);return new je({topology:t.topology||"triangle-list",bufferLayout:s,vertexCount:t.vertexCount,indices:r,attributes:n})}var Ze=r(5153);class Qe extends Ze.F{static defaultProps={...Ze.F.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0};get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,t){super(e,t,Qe.defaultProps),this.shaderLayout=t.shaderLayout}}class Je{static defaultProps={...n.r.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new Je(e),e._lumaData.defaultPipelineFactory}device;destroyPolicy;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createRenderPipeline(e){const t={...n.r.defaultProps,...e},r=this._hashRenderPipeline(t);if(!this._renderPipelineCache[r]){const e=this.device.createRenderPipeline({...t,id:t.id?`${t.id}-cached`:void 0});e.hash=r,this._renderPipelineCache[r]={pipeline:e,useCount:0}}return this._renderPipelineCache[r].useCount++,this._renderPipelineCache[r].pipeline}createComputePipeline(e){const t={...Qe.defaultProps,...e},r=this._hashComputePipeline(t);if(!this._computePipelineCache[r]){const e=this.device.createComputePipeline({...t,id:t.id?`${t.id}-cached`:void 0});e.hash=r,this._computePipelineCache[r]={pipeline:e,useCount:0}}return this._computePipelineCache[r].useCount++,this._computePipelineCache[r].pipeline}release(e){const t=e.hash,r=e instanceof Qe?this._computePipelineCache:this._renderPipelineCache;r[t].useCount--,0===r[t].useCount&&"unused"===this.destroyPolicy&&(r[t].pipeline.destroy(),delete r[t])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const t=e.vs?this._getHash(e.vs.source):0,r=e.fs?this._getHash(e.fs.source):0,n=this._getHash(JSON.stringify(e.bufferLayout));if("webgl"===this.device.type)return`${t}/${r}V-BL${n}`;{const s=this._getHash(JSON.stringify(e.parameters));return`${t}/${r}V-T${e.topology}P${s}BL${n}`}}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}var et=r(11669);class tt{static defaultProps={...et.M.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new tt(e),e._lumaData.defaultShaderFactory}device;destroyPolicy;_cache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createShader(e){const t=this._hashShader(e);let r=this._cache[t];if(!r){const n=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[t]=r={shader:n,useCount:0}}return r.useCount++,r.shader}release(e){const t=this._hashShader(e),r=this._cache[t];r&&(r.useCount--,0===r.useCount&&"unused"===this.destroyPolicy&&(delete this._cache[t],r.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}}let rt=null,nt=null;function st(e,t,r){if(e===t)return!0;if(!r||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!st(e[n],t[n],r-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"==typeof e&&"object"==typeof t){const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(const i of n){if(!t.hasOwnProperty(i))return!1;if(!st(e[i],t[i],r-1))return!1}return!0}return!1}var it=r(35185),ot=r(76282);function at(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach((r=>{const n=e[r];var s;s=n,(0,ot.H9)(s)||"number"==typeof s||"boolean"==typeof s?t.uniforms[r]=n:t.bindings[r]=n})),t}class ct{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,t){Object.assign(this.options,t);const r=(0,it.$Q)(Object.values(e).filter((e=>e.dependencies)));for(const n of r)e[n.name]=n;s.R.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[n,i]of Object.entries(e))this._addModule(i),i.name&&n!==i.name&&!this.options.disableWarnings&&s.R.warn(`Module name: ${n} vs ${i.name}`)()}destroy(){}setProps(e){for(const t of Object.keys(e)){const r=t,n=e[r]||{},i=this.modules[r];if(!i){this.options.disableWarnings||s.R.warn(`Module ${t} not found`)();continue}const o=this.moduleUniforms[r],a=this.moduleBindings[r],c=i.getUniforms?.(n,o)||n,{uniforms:u,bindings:l}=at(c);this.moduleUniforms[r]={...o,...u},this.moduleBindings[r]={...a,...l}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){const e={};for(const[t,r]of Object.entries(this.moduleUniforms))for(const[n,s]of Object.entries(r))e[`${t}.${n}`]={type:this.modules[t].uniformTypes?.[n],value:String(s)};return e}_addModule(e){const t=e.name;this.moduleUniforms[t]=e.defaultUniforms||{},this.moduleBindings[t]={}}}let ut="";async function lt(e,t){const r=new Image;return r.crossOrigin=t?.crossOrigin||"anonymous",r.src=e.startsWith("http")?e:ut+e,await r.decode(),t?await createImageBitmap(r,t):await createImageBitmap(r)}class ht{device;id;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,t){this.device=e,this.id=t.id||(0,Ye.L)("async-texture"),"string"==typeof t?.data&&"2d"===t.dimension&&(t={...t,data:lt(t.data)}),this.ready=new Promise(((e,t)=>{this.resolveReady=()=>{this.isReady=!0,e()},this.rejectReady=t})),this.initAsync(t)}async initAsync(e){const t=e.data,r=await dt(t).then(undefined,undefined);if(this.destroyed)return;const n={...e,data:r};this.texture=this.device.createTexture(n),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const t=this.texture;this.texture=t.clone(e),t.destroy()}return!0}}async function dt(e){if(e=await e,Array.isArray(e))return await Promise.all(e.map(dt));if(e&&"object"==typeof e&&e.constructor===Object){const t=e,r=await Promise.all(Object.values(t)),n=Object.keys(t),s={};for(let e=0;e<n.length;e++)s[n[e]]=r[e];return s}return e}class ft{static defaultProps={...n.r.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:S._.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,t){this.props={...ft.defaultProps,...t},t=this.props,this.id=t.id||(0,Ye.L)("model"),this.device=e,Object.assign(this.userData,t.userData);const r=Object.fromEntries(this.props.modules?.map((e=>[e.name,e]))||[]),n=t.shaderInputs||new ct(r,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(n);const s=function(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}(e),i=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if("webgpu"===this.device.type&&this.props.source){const{source:e,getUniforms:t}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:s,...this.props,modules:i});this.source=e,this._getModuleUniforms=t,this.props.shaderLayout||=ze(this.source)}else{const{vs:e,fs:t,getUniforms:r}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:s,...this.props,modules:i});this.vs=e,this.fs=t,this._getModuleUniforms=r}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||Je.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||tt.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.uniforms&&this.setUniformsWebGL(t.uniforms),t.moduleSettings&&this.updateModuleSettingsWebGL(t.moduleSettings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const t=this._areBindingsLoading();if(t)return s.R.info(2,`>>> DRAWING ABORTED ${this.id}: ${t} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let r;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const t=this._getBindings();this.pipeline.setBindings(t,{disableWarnings:this.props.disableWarnings}),pt(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:n}=this.vertexArray,s=n?n.byteLength/("uint32"===n.indexType?4:2):void 0;r=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),r?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",r}setGeometry(e){this._gpuGeometry?.destroy();const t=e&&qe(this.device,e);if(t){this.setTopology(t.topology||"triangle-list");const e=new i(this.bufferLayout);this.bufferLayout=e.mergeBufferLayouts(t.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(t)}this._gpuGeometry=t}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const t=new i(this.bufferLayout);this.bufferLayout=this._gpuGeometry?t.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){st(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,void 0===this.isInstanced&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new f(this.shaderInputs.modules);for(const[t,r]of Object.entries(this.shaderInputs.modules))if(_t(r)){const e=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings[`${t}Uniforms`]=e}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){const r=t?.disableWarnings??this.props.disableWarnings;e.indices&&s.R.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();const n=new i(this.bufferLayout);for(const[i,o]of Object.entries(e)){const e=n.getBufferLayout(i);if(!e){r||s.R.warn(`Model(${this.id}): Missing layout for buffer "${i}".`)();continue}const t=n.getAttributeNamesForBuffer(e);let a=!1;for(const r of t){const e=this._attributeInfos[r];e&&(this.vertexArray.setBuffer(e.location,o),a=!0)}a||r||s.R.warn(`Model(${this.id}): Ignoring buffer "${o.id}" for unknown attribute "${i}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[r,n]of Object.entries(e)){const e=this._attributeInfos[r];e?this.vertexArray.setConstantWebGL(e.location,n):(t?.disableWarnings??this.props.disableWarnings)||s.R.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${r}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){this.setUniformsWebGL(e)}setUniformsWebGL(e){pt(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL(e){const{bindings:t,uniforms:r}=at(this._getModuleUniforms(e));Object.assign(this.bindings,t),Object.assign(this.uniforms,r),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof ht&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[t,r]of Object.entries(this.bindings))r instanceof ht?r.isReady&&(e[t]=r.texture):e[t]=r;return e}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof b.X?e=Math.max(e,t.texture.updateTimestamp):t instanceof o.h||t instanceof T.g?e=Math.max(e,t.updateTimestamp):t instanceof ht?e=t.texture?Math.max(e,t.texture.updateTimestamp):1/0:t instanceof y.L||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t={...e.attributes};for(const[r]of Object.entries(t))this.pipeline.shaderLayout.attributes.find((e=>e.name===r))||"positions"===r||delete t[r];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(s.R.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const r=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let n=null;this.source?n=r:this.fs&&(n=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:r,fs:n}),this._attributeInfos=(0,A.P)(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=s.R.level>3?0:1e4;s.R.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,s.R.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:s.R.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=function(e){const t={},r="Values";if(0===e.attributes.length&&!e.varyings?.length)return{"No attributes or varyings":{[r]:"N/A"}};for(const n of e.attributes)n&&(t[`in ${n.location} ${n.name}: ${n.type}`]={[r]:n.stepMode||"vertex"});for(const n of e.varyings||[])t[`out ${n.location} ${n.name}`]={[r]:JSON.stringify(n)};return t}(this.pipeline.shaderLayout,this.id);s.R.table(2,e)();const t=this.shaderInputs.getDebugTable();for(const[n,s]of Object.entries(this.uniforms))t[n]={value:s};s.R.table(2,t)();const r=this._getAttributeDebugTable();s.R.table(2,this._attributeInfos)(),s.R.table(2,r)(),s.R.groupEnd(2)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const t=this.device.props.debugFramebuffers;if(this._drawCount++,!t)return;const r=e.props.framebuffer;r&&function(e,{id:t,minimap:r,opaque:n,top:s="0",left:i="0",rgbaScale:o=1}){rt||(rt=document.createElement("canvas"),rt.id=t,rt.title=t,rt.style.zIndex="100",rt.style.position="absolute",rt.style.top=s,rt.style.left=i,rt.style.border="blue 5px solid",rt.style.transform="scaleY(-1)",document.body.appendChild(rt),nt=rt.getContext("2d")),rt.width===e.width&&rt.height===e.height||(rt.width=e.width/2,rt.height=e.height/2,rt.style.width="400px",rt.style.height="400px");const a=e.device.readPixelsToArrayWebGL(e),c=nt?.createImageData(e.width,e.height);if(c){const e=0;for(let t=0;t<a.length;t+=4)c.data[e+t+0]=a[t+0]*o,c.data[e+t+1]=a[t+1]*o,c.data[e+t+2]=a[t+2]*o,c.data[e+t+3]=n?255:a[t+3]*o;nt?.putImageData(c,0,0)}}(r,{id:r.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,r]of Object.entries(this._attributeInfos)){const n=this.vertexArray.attributes[r.location];e[r.location]={name:t,type:r.shaderType,values:n?this._getBufferOrConstantValues(n,r.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,r="uint32"===t.indexType?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:r.toString()}}return e}_getBufferOrConstantValues(e,t){const r=(0,R.Y0)(t);return(e instanceof o.h?new r(e.debugData):e).toString()}}function _t(e){return Boolean(e.uniformTypes&&!pt(e.uniformTypes))}function pt(e){for(const t in e)return!1;return!0}},4500:(e,t,r)=>{r.d(t,{L:()=>s});const n={};function s(e="id"){n[e]=n[e]||1;return`${e}-${n[e]++}`}},73288:(e,t,r)=>{r.d(t,{Wk:()=>s});const n="#version 300 es\nout vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}";function s(e){const{input:t,inputChannels:r,output:s}=e||{};if(!t)return n;if(!r)throw new Error("inputChannels");return`#version 300 es\nin ${function(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${e}`)}}(r)} ${t};\nout vec4 ${s};\nvoid main() {\n  ${s} = ${function(e,t){switch(t){case 1:return`vec4(${e}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${e}, 0.0, 1.0)`;case 3:return`vec4(${e}, 1.0)`;case 4:return e;default:throw new Error(`invalid channels: ${t}`)}}(t,r)};\n}`}},3189:(e,t,r)=>{r.d(t,{_:()=>R});var n=r(70628),s=r(35185);var i=r(42984);const o=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],a=[...o,[l("attribute"),"in $1"],[l("varying"),"out $1"]],c=[...o,[l("varying"),"in $1"]];function u(e,t){for(const[r,n]of t)e=e.replace(r,n);return e}function l(e){return new RegExp(`\\b${e}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function h(e,t){let r="";for(const n in e){const s=e[n];if(r+=`void ${s.signature} {\n`,s.header&&(r+=`  ${s.header}`),t[n]){const e=t[n];e.sort(((e,t)=>e.order-t.order));for(const t of e)r+=`  ${t.injection}\n`}s.footer&&(r+=`  ${s.footer}`),r+="}\n"}return r}function d(e){const t={vertex:{},fragment:{}};for(const r of e){let e,n;"string"!=typeof r?(e=r,n=e.hook):(e={},n=r),n=n.trim();const[s,i]=n.split(":"),o=n.replace(/\(.+/,""),a=Object.assign(e,{signature:i});switch(s){case"vs":t.vertex[o]=a;break;case"fs":t.fragment[o]=a;break;default:throw new Error(s)}}return t}function f(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}function _(e,t="unnamed"){const r=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return r?r[1]:t}function p(e){let t=100;const r=e.match(/[^\s]+/g);if(r&&r.length>=2&&"#version"===r[0]){const e=parseInt(r[1],10);Number.isFinite(e)&&(t=e)}if(100!==t&&300!==t)throw new Error(`Invalid GLSL version ${t}`);return t}const g=`\n\n${i.O_}\n`;function m(e,t){const{source:r,stage:s,modules:o,hookFunctions:a=[],inject:c={},log:u}=t;f("string"==typeof r,"shader source must be a string");const l=r;let _="";const p=d(a),m={},E={},b={};for(const n in c){const e="string"==typeof c[n]?{injection:c[n],order:0}:c[n],t=/^(v|f)s:(#)?([\w-]+)$/.exec(n);if(t){const r=t[2],s=t[3];r?"decl"===s?E[n]=[e]:b[n]=[e]:m[n]=[e]}else b[n]=[e]}const y=o;for(const i of y){u&&(0,n.ZG)(i,l,u);_+=T(i,"wgsl");const e=i.injections?.[s]||{};for(const t in e){const r=/^(v|f)s:#([\w-]+)$/.exec(t);if(r){const n="decl"===r[2]?E:b;n[t]=n[t]||[],n[t].push(e[t])}else m[t]=m[t]||[],m[t].push(e[t])}}return _+=g,_=(0,i.bv)(_,s,E),_+=h(p[s],m),_+=l,_=(0,i.bv)(_,s,b),_}function E(e,t){const{id:r,source:s,stage:o,language:l="glsl",modules:m,defines:E={},hookFunctions:b=[],inject:y={},prologue:A=!0,log:R}=t;f("string"==typeof s,"shader source must be a string");const S="glsl"===l?function(e,t){return{name:_(e,t),language:"glsl",version:p(e)}}(s).version:-1,w=e.shaderLanguageVersion,v=100===S?"#version 100":"#version 300 es",x=s.split("\n").slice(1).join("\n"),C={};m.forEach((e=>{Object.assign(C,e.defines)})),Object.assign(C,E);let N="";switch(l){case"wgsl":break;case"glsl":N=A?`${v}\n\n// ----- PROLOGUE -------------------------\n${function(e){const{id:t,source:r,stage:n}=e,s=t&&-1===r.indexOf("SHADER_NAME");return s?`\n#define SHADER_NAME ${t}_${n}`:""}({id:r,source:s,stage:o})}\n#define SHADER_TYPE_${o.toUpperCase()}\n\n${function(e){switch(e?.gpu.toLowerCase()){case"apple":return"#define APPLE_GPU\n// Apple optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Headless Chrome's software shader 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// If the GPU doesn't have full 32 bits precision, will causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(e)}\n${"fragment"===o?"precision highp float;\n":""}\n\n// ----- APPLICATION DEFINES -------------------------\n\n${function(e={}){let t="";for(const r in e){const n=e[r];(n||Number.isFinite(n))&&(t+=`#define ${r.toUpperCase()} ${e[r]}\n`)}return t}(C)}\n\n`:`${v}\n`}const I=d(b),L={},O={},M={};for(const n in y){const e="string"==typeof y[n]?{injection:y[n],order:0}:y[n],t=/^(v|f)s:(#)?([\w-]+)$/.exec(n);if(t){const r=t[2],s=t[3];r?"decl"===s?O[n]=[e]:M[n]=[e]:L[n]=[e]}else M[n]=[e]}for(const i of m){R&&(0,n.ZG)(i,x,R);N+=T(i,o);const e=i.instance?.normalizedInjections[o]||{};for(const t in e){const r=/^(v|f)s:#([\w-]+)$/.exec(t);if(r){const n="decl"===r[2]?O:M;n[t]=n[t]||[],n[t].push(e[t])}else L[t]=L[t]||[],L[t].push(e[t])}}return N+="// ----- MAIN SHADER SOURCE -------------------------",N+=g,N=(0,i.bv)(N,o,O),N+=h(I[o],L),N+=x,N=(0,i.bv)(N,o,M),"glsl"===l&&S!==w&&(N=function(e,t){if(300!==Number(e.match(/^#version[ \t]+(\d+)/m)?.[1]||100))throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return u(e,a);case"fragment":return u(e,c);default:throw new Error(t)}}(N,o)),N.trim()}function b(e){return function(t){const r={};for(const n of e){const e=n.getUniforms?.(t,r);Object.assign(r,e)}return r}}function T(e,t){let r;switch(t){case"vertex":r=e.vs||"";break;case"fragment":r=e.fs||"";break;case"wgsl":r=e.source||"";break;default:f(!1)}if(!e.name)throw new Error("Shader module must have a name");const n=e.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let s=`// ----- MODULE ${e.name} ---------------\n\n`;return"wgsl"!==t&&(s+=`#define MODULE_${n}\n`),s+=`${r}\n`,s}const y=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,A=/^\s*\#\s*endif\s*$/;class R{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return R.defaultShaderAssembler=R.defaultShaderAssembler||new R,R.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find((t=>t.name===("string"==typeof e?e:e.name)))||this._defaultModules.push(e)}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter((e=>e.name!==t))}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const t=this._getModuleList(e.modules),r=this._hookFunctions,{source:n,getUniforms:i}=function(e){const t=(0,s.$Q)(e.modules||[]);return{source:m(e.platformInfo,{...e,source:e.source,stage:"vertex",modules:t}),getUniforms:b(t)}}({...e,source:e.source,modules:t,hookFunctions:r}),o="wgsl"===e.platformInfo.shaderLanguage?function(e,t){const r=e.split("\n"),n=[];let s=!0,i=null;for(const o of r){const e=o.match(y),r=o.match(A);e?(i=e[1],s=Boolean(t?.defines?.[i])):r?s=!0:s&&n.push(o)}return n.join("\n")}(n):n;return{source:o,getUniforms:i,modules:t}}assembleGLSLShaderPair(e){const t=this._getModuleList(e.modules),r=this._hookFunctions,n=function(e){const{vs:t,fs:r}=e,n=(0,s.$Q)(e.modules||[]);return{vs:E(e.platformInfo,{...e,source:t,stage:"vertex",modules:n}),fs:E(e.platformInfo,{...e,source:r,stage:"fragment",modules:n}),getUniforms:b(n)}}({...e,vs:e.vs,fs:e.fs,modules:t,hookFunctions:r});return{...n,modules:t}}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),r={};let s=0;for(let n=0,i=this._defaultModules.length;n<i;++n){const e=this._defaultModules[n],i=e.name;t[s++]=e,r[i]=!0}for(let n=0,i=e.length;n<i;++n){const i=e[n],o=i.name;r[o]||(t[s++]=i,r[o]=!0)}return t.length=s,(0,n.$g)(t),t}}},42984:(e,t,r)=>{r.d(t,{O_:()=>a,bv:()=>l,Uu:()=>c});const n={vertex:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fragment:"#ifdef MODULE_MATERIAL\n  fragColor = material_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  fragColor = lighting_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_FOG\n  fragColor = fog_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  fragColor = picking_filterHighlightColor(fragColor);\n  fragColor = picking_filterPickingColor(fragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},s=/void\s+main\s*\([^)]*\)\s*\{\n?/,i=/}\n?[^{}]*$/,o=[],a="__LUMA_INJECT_DECLARATIONS__";function c(e){const t={vertex:{},fragment:{}};for(const r in e){let n=e[r];"string"==typeof n&&(n={order:0,injection:n}),t[u(r)][r]=n}return t}function u(e){const t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function l(e,t,r,c=!1){const u="vertex"===t;for(const n in r){const t=r[n];t.sort(((e,t)=>e.order-t.order)),o.length=t.length;for(let e=0,r=t.length;e<r;++e)o[e]=t[e].injection;const c=`${o.join("\n")}\n`;switch(n){case"vs:#decl":u&&(e=e.replace(a,c));break;case"vs:#main-start":u&&(e=e.replace(s,(e=>e+c)));break;case"vs:#main-end":u&&(e=e.replace(i,(e=>c+e)));break;case"fs:#decl":u||(e=e.replace(a,c));break;case"fs:#main-start":u||(e=e.replace(s,(e=>e+c)));break;case"fs:#main-end":u||(e=e.replace(i,(e=>c+e)));break;default:e=e.replace(n,(e=>e+c))}}return e=e.replace(a,""),c&&(e=e.replace(/\}\s*$/,(e=>e+n[t]))),e}},35185:(e,t,r)=>{r.d(t,{$Q:()=>s});var n=r(70628);function s(e){(0,n.$g)(e);const t={},r={};i({modules:e,level:0,moduleMap:t,moduleDepth:r});const s=Object.keys(r).sort(((e,t)=>r[t]-r[e])).map((e=>t[e]));return(0,n.$g)(s),s}function i(e){const{modules:t,level:r,moduleMap:n,moduleDepth:s}=e;if(r>=5)throw new Error("Possible loop in shader dependency graph");for(const i of t)n[i.name]=i,(void 0===s[i.name]||s[i.name]<r)&&(s[i.name]=r);for(const o of t)o.dependencies&&i({modules:o.dependencies,level:r+1,moduleMap:n,moduleDepth:s})}},70628:(e,t,r)=>{r.d(t,{ZG:()=>u,UK:()=>c,$g:()=>a});const n={number:{type:"number",validate:(e,t)=>Number.isFinite(e)&&"object"==typeof t&&(void 0===t.max||e<=t.max)&&(void 0===t.min||e>=t.min)},array:{type:"array",validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function s(e){let t=i(e);if("object"!==t)return{value:e,...n[t],type:t};if("object"==typeof e)return e?void 0!==e.type?{...e,...n[e.type],type:e.type}:void 0===e.value?{type:"object",value:e}:(t=i(e.value),{...e,...n[t],type:t}):{type:"object",value:null};throw new Error("props")}function i(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}var o=r(42984);function a(e){e.map((e=>c(e)))}function c(e){if(e.instance)return;a(e.dependencies||[]);const{propTypes:t={},deprecations:r=[],inject:n={}}=e,i={normalizedInjections:(0,o.Uu)(n),parsedDeprecations:l(r)};t&&(i.propValidators=function(e){const t={};for(const[r,n]of Object.entries(e))t[r]=s(n);return t}(t)),e.instance=i;let c={};t&&(c=Object.entries(t).reduce(((e,[t,r])=>{const n=r?.value;return n&&(e[t]=n),e}),{})),e.defaultUniforms={...e.defaultUniforms,...c}}function u(e,t,r){e.deprecations?.forEach((e=>{e.regex?.test(t)&&(e.deprecated?r.deprecated(e.old,e.new)():r.removed(e.old,e.new)())}))}function l(e){return e.forEach((e=>{if("function"===e.type)e.regex=new RegExp(`\\b${e.old}\\(`);else e.regex=new RegExp(`${e.type} ${e.old};`)})),e}},34938:(e,t,r)=>{r.d(t,{i:()=>n});const n={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n\n// All these functions are for substituting tan() function from Intel GPU only\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n\n    // 2pi range reduction\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n"}},22454:(e,t,r)=>{function n(e,t=[],r=0){const n=Math.fround(e),s=e-n;return t[r]=n,t[r+1]=s,t}function s(e){return e-Math.fround(e)}function i(e){const t=new Float32Array(32);for(let r=0;r<4;++r)for(let s=0;s<4;++s){const i=4*r+s;n(e[4*s+r],t,2*i)}return t}r.d(t,{dI:()=>o});const o={name:"fp64arithmetic",vs:"\nuniform fp64arithmeticUniforms {\n  uniform float ONE;\n} fp64;\n\n/*\nAbout LUMA_FP64_CODE_ELIMINATION_WORKAROUND\n\nThe purpose of this workaround is to prevent shader compilers from\noptimizing away necessary arithmetic operations by swapping their sequences\nor transform the equation to some 'equivalent' form.\n\nThe method is to multiply an artifical variable, ONE, which will be known to\nthe compiler to be 1 only at runtime. The whole expression is then represented\nas a polynomial with respective to ONE. In the coefficients of all terms, only one a\nand one b should appear\n\nerr = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE\n*/\n\n// Divide float number to high and low floats to extend fraction bits\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * fp64.ONE - (t - a);\n  float a_lo = a * fp64.ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\n\n// Divide float number again when high float uses too many fraction bits\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\n\n// Special sum operation when a > b\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * fp64.ONE;\n  float err = b - (sum - a) * fp64.ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\n\n// General sum operation\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * fp64.ONE - a) * fp64.ONE;\n  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *\n    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  // y component is for the error\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",defaultUniforms:{ONE:1},uniformTypes:{ONE:"f32"},fp64ify:n,fp64LowPart:s,fp64ifyMatrix4:i}},40472:(e,t,r)=>{r.d(t,{l:()=>_});class n{}var s=r(88014),i=r(29651),o=r(20698);const a={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},c=e=>({drawBuffersWEBGL:t=>e.drawBuffers(t),COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),u=e=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES:()=>e.createVertexArray(),deleteVertexArrayOES:t=>e.deleteVertexArray(t),isVertexArrayOES:t=>e.isVertexArray(t),bindVertexArrayOES:t=>e.bindVertexArray(t)}),l=e=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE:(...t)=>e.drawArraysInstanced(...t),drawElementsInstancedANGLE:(...t)=>e.drawElementsInstanced(...t),vertexAttribDivisorANGLE:(...t)=>e.vertexAttribDivisor(...t)});function h(e=!0){const t=HTMLCanvasElement.prototype;if(!e&&t.originalGetContext)return t.getContext=t.originalGetContext,void(t.originalGetContext=void 0);t.originalGetContext=t.getContext,t.getContext=function(e,t){if("webgl"===e||"experimental-webgl"===e){const e=this.originalGetContext("webgl2",t);return e instanceof HTMLElement&&function(e){e.getExtension("EXT_color_buffer_float");const t={...a,WEBGL_disjoint_timer_query:e.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:c(e),OES_vertex_array_object:u(e),ANGLE_instanced_arrays:l(e)},r=e.getExtension;e.getExtension=function(n){const s=r.call(e,n);return s||(n in t?t[n]:null)};const n=e.getSupportedExtensions;e.getSupportedExtensions=function(){const r=n.apply(e)||[];return r?.concat(Object.keys(t))}}(e),e}return this.originalGetContext(e,t)}}var d=r(25299),f=r(67483);const _=new class extends n{type="webgl";constructor(){super(),s.pF.defaultProps={...s.pF.defaultProps,...d.ic},o.e.adapter=this}isSupported(){return"undefined"!=typeof WebGL2RenderingContext}enforceWebGL2(e){h(e)}async attach(e){if(e instanceof o.e)return e;if(e?.device instanceof s.pF)return e.device;if(!function(e){if("undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)return!0;return Boolean(e&&Number.isFinite(e._version))}(e))throw new Error("Invalid WebGL2RenderingContext");return new o.e({_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1}})}async create(e={}){i.R.groupCollapsed(1,"WebGLDevice created")();const t=[];(e.debugWebGL||e.debug)&&t.push((0,f.$)()),e.debugSpectorJS&&t.push((0,d._G)(e));const r=await Promise.allSettled(t);for(const o of r)"rejected"===o.status&&i.R.error(`Failed to initialize debug libraries ${o.reason}`)();const n=new o.e(e),s=`${n._reused?"Reusing":"Created"} device with WebGL2 ${n.debug?"debug ":""}context: ${n.info.vendor}, ${n.info.renderer} for canvas: ${n.canvasContext.id}`;return i.R.probe(1,s)(),i.R.table(1,n.info)(),i.R.groupEnd(1)(),n}}},20698:(e,t,r)=>{r.d(t,{e:()=>ft});var n=r(88014),s=r(29651);const i={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},o=(e,t,r)=>t?e.enable(r):e.disable(r),a=(e,t,r)=>e.hint(r,t),c=(e,t,r)=>e.pixelStorei(r,t),u=(e,t,r)=>{const n=36006===r?36009:36008;return e.bindFramebuffer(n,t)},l=(e,t,r)=>{const n={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[r];e.bindBuffer(n,t)};function h(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}const d={3042:o,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:o,2885:(e,t)=>e.cullFace(t),2929:o,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:o,35723:a,35725:(e,t)=>e.useProgram(t),36007:(e,t)=>e.bindRenderbuffer(36161,t),36389:(e,t)=>e.bindTransformFeedback?.(36386,t),34229:(e,t)=>e.bindVertexArray(t),36006:u,36010:u,34964:l,36662:l,36663:l,35053:l,35055:l,2886:(e,t)=>e.frontFace(t),33170:a,2849:(e,t)=>e.lineWidth(t),32823:o,32824:"polygonOffset",10752:"polygonOffset",35977:o,32926:o,32928:o,32938:"sampleCoverage",32939:"sampleCoverage",3089:o,3088:(e,t)=>e.scissor(...t),2960:o,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),34383:o,10754:o,12288:o,12289:o,12290:o,12291:o,12292:o,12293:o,12294:o,12295:o,3333:c,3317:c,37440:c,37441:c,37443:c,3330:c,3332:c,3331:c,3314:c,32878:c,3316:c,3315:c,32877:c,framebuffer:(e,t)=>{const r=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,r)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{const r="number"==typeof t?[t,t]:t;e.blendEquationSeparate(...r)},blendFunc:(e,t)=>{const r=2===t?.length?[...t,...t]:t;e.blendFuncSeparate(...r)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(t[0],t[1]||!1),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=h(t)?t:[t,t];const[r,n]=t;e.stencilMaskSeparate(1028,r),e.stencilMaskSeparate(1029,n)},stencilFunc:(e,t)=>{t=h(t)&&3===t.length?[...t,...t]:t;const[r,n,s,i,o,a]=t;e.stencilFuncSeparate(1028,r,n,s),e.stencilFuncSeparate(1029,i,o,a)},stencilOp:(e,t)=>{t=h(t)&&3===t.length?[...t,...t]:t;const[r,n,s,i,o,a]=t;e.stencilOpSeparate(1028,r,n,s),e.stencilOpSeparate(1029,i,o,a)},viewport:(e,t)=>e.viewport(...t)};function f(e,t,r){return void 0!==t[e]?t[e]:r[e]}const _={blendEquation:(e,t,r)=>e.blendEquationSeparate(f(32777,t,r),f(34877,t,r)),blendFunc:(e,t,r)=>e.blendFuncSeparate(f(32969,t,r),f(32968,t,r),f(32971,t,r),f(32970,t,r)),polygonOffset:(e,t,r)=>e.polygonOffset(f(32824,t,r),f(10752,t,r)),sampleCoverage:(e,t,r)=>e.sampleCoverage(f(32938,t,r),f(32939,t,r)),stencilFuncFront:(e,t,r)=>e.stencilFuncSeparate(1028,f(2962,t,r),f(2967,t,r),f(2963,t,r)),stencilFuncBack:(e,t,r)=>e.stencilFuncSeparate(1029,f(34816,t,r),f(36003,t,r),f(36004,t,r)),stencilOpFront:(e,t,r)=>e.stencilOpSeparate(1028,f(2964,t,r),f(2965,t,r),f(2966,t,r)),stencilOpBack:(e,t,r)=>e.stencilOpSeparate(1029,f(34817,t,r),f(34818,t,r),f(34819,t,r))},p={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,r)=>e({[t]:r}),hint:(e,t,r)=>e({[t]:r}),useProgram:(e,t)=>e({35725:t}),bindRenderbuffer:(e,t,r)=>e({36007:r}),bindTransformFeedback:(e,t,r)=>e({36389:r}),bindVertexArray:(e,t)=>e({34229:t}),bindFramebuffer:(e,t,r)=>{switch(t){case 36160:return e({36006:r,36010:r});case 36009:return e({36006:r});case 36008:return e({36010:r});default:return null}},bindBuffer:(e,t,r)=>{const n={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[t];return n?e({[n]:r}):{valueChanged:!0}},blendColor:(e,t,r,n,s)=>e({32773:new Float32Array([t,r,n,s])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,r)=>e({32777:t,34877:r}),blendFunc:(e,t,r)=>e({32969:t,32968:r,32971:t,32970:r}),blendFuncSeparate:(e,t,r,n,s)=>e({32969:t,32968:r,32971:n,32970:s}),clearColor:(e,t,r,n,s)=>e({3106:new Float32Array([t,r,n,s])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,r,n,s)=>e({3107:[t,r,n,s]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,r)=>e({2928:new Float32Array([t,r])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,r)=>e({32824:t,10752:r}),sampleCoverage:(e,t,r)=>e({32938:t,32939:r}),scissor:(e,t,r,n,s)=>e({3088:new Int32Array([t,r,n,s])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,r)=>e({[1028===t?2968:36005]:r}),stencilFunc:(e,t,r,n)=>e({2962:t,2967:r,2963:n,34816:t,36003:r,36004:n}),stencilFuncSeparate:(e,t,r,n,s)=>e({[1028===t?2962:34816]:r,[1028===t?2967:36003]:n,[1028===t?2963:36004]:s}),stencilOp:(e,t,r,n)=>e({2964:t,2965:r,2966:n,34817:t,34818:r,34819:n}),stencilOpSeparate:(e,t,r,n,s)=>e({[1028===t?2964:34817]:r,[1028===t?2965:34818]:n,[1028===t?2966:34819]:s}),viewport:(e,t,r,n,s)=>e({2978:[t,r,n,s]})},g=(e,t)=>e.isEnabled(t),m={3042:g,2884:g,2929:g,3024:g,32823:g,32926:g,32928:g,3089:g,2960:g,35977:g},E=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function b(e,t){if(function(e){for(const t in e)return!1;return!0}(t))return;const r={};for(const s in t){const n=Number(s),i=d[s];i&&("string"==typeof i?r[i]=!0:i(e,t[s],n))}const n=e.state&&e.state.cache;if(n)for(const s in r){(0,_[s])(e,t,n)}}function T(e,t=i){if("number"==typeof t){const r=t,n=m[r];return n?n(e,r):e.getParameter(r)}const r=Array.isArray(t)?t:Object.keys(t),n={};for(const s of r){const t=m[s];n[s]=t?t(e,Number(s)):e.getParameter(Number(s))}return n}function y(e,t){if(e===t)return!0;const r=Array.isArray(e)||ArrayBuffer.isView(e),n=Array.isArray(t)||ArrayBuffer.isView(t);if(r&&n&&e.length===t.length){for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}return!1}class A{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,t){this.gl=e,this.log=t?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];b(this.gl,e),this.stateStack.pop()}trackState(e,t){if(this.cache=t.copyState?T(e):Object.assign({},i),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,function(e){const t=e.useProgram.bind(e);e.useProgram=function(r){const n=A.get(e);n.program!==r&&(t(r),n.program=r)}}(e);for(const r in p){S(e,r,p[r])}R(e,"getParameter"),R(e,"isEnabled")}_updateCache(e){let t,r=!1;const n=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const s in e){const i=e[s],o=this.cache[s];y(i,o)||(r=!0,t=o,n&&!(s in n)&&(n[s]=o),this.cache[s]=i)}return{valueChanged:r,oldValue:t}}}function R(e,t){const r=e[t].bind(e);e[t]=function(t){if(void 0===t||E.has(t))return r(t);const n=A.get(e);return t in n.cache||(n.cache[t]=r(t)),n.enable?n.cache[t]:r(t)},Object.defineProperty(e[t],"name",{value:`${t}-from-cache`,configurable:!1})}function S(e,t,r){if(!e[t])return;const n=e[t].bind(e);e[t]=function(...t){const s=A.get(e),{valueChanged:i,oldValue:o}=r(s._updateCache,...t);return i&&n(...t),o},Object.defineProperty(e[t],"name",{value:`${t}-to-cache`,configurable:!1})}function w(e,t,r){return void 0===r[t]&&(r[t]=e.getExtension(t)||null),r[t]}function v(e,t){const r=e.getParameter(7936),n=e.getParameter(7937);w(e,"WEBGL_debug_renderer_info",t);const s=t.WEBGL_debug_renderer_info,i=e.getParameter(s?s.UNMASKED_VENDOR_WEBGL:7936)||r,o=e.getParameter(s?s.UNMASKED_RENDERER_WEBGL:7937)||n,a=e.getParameter(7938),c=x(i,o),u=function(e,t){if(/Metal/i.exec(e)||/Metal/i.exec(t))return"metal";if(/ANGLE/i.exec(e)||/ANGLE/i.exec(t))return"opengl";return"unknown"}(i,o),l=function(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(x(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}(i,o);return{type:"webgl",gpu:c,gpuType:l,gpuBackend:u,vendor:i,renderer:o,version:a,shadingLanguage:"glsl",shadingLanguageVersion:300}}function x(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}var C=r(34045);function N(e){switch(e){case"uint8":case"unorm8":return 5121;case"sint8":case"snorm8":return 5120;case"uint16":case"unorm16":return 5123;case"sint16":case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(e))}const I="WEBGL_compressed_texture_s3tc",L="WEBGL_compressed_texture_s3tc_srgb",O="EXT_texture_compression_rgtc",M="EXT_texture_compression_bptc",P="EXT_texture_norm16",F="EXT_render_snorm",B={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[F],"norm16-renderable-webgl":[P],"snorm16-renderable-webgl":[P,F],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[I,L,O,M],"texture-compression-bc5-webgl":[O],"texture-compression-bc7-webgl":[M],"texture-compression-etc2":["WEBGL_compressed_texture_etc"],"texture-compression-astc":["WEBGL_compressed_texture_astc"],"texture-compression-etc1-webgl":["WEBGL_compressed_texture_etc1"],"texture-compression-pvrtc-webgl":["WEBGL_compressed_texture_pvrtc"],"texture-compression-atc-webgl":["WEBGL_compressed_texture_atc"]};const k={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:"EXT_color_buffer_float",dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:I},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:L},"bc1-rgba-unorm":{gl:33777,x:I},"bc1-rgba-unorm-srgb":{gl:35916,x:L},"bc2-rgba-unorm":{gl:33778,x:I},"bc2-rgba-unorm-srgb":{gl:35918,x:L},"bc3-rgba-unorm":{gl:33779,x:I},"bc3-rgba-unorm-srgb":{gl:35919,x:L},"bc4-r-unorm":{gl:36283,x:O},"bc4-r-snorm":{gl:36284,x:O},"bc5-rg-unorm":{gl:36285,x:O},"bc5-rg-snorm":{gl:36286,x:O},"bc6h-rgb-ufloat":{gl:36495,x:M},"bc6h-rgb-float":{gl:36494,x:M},"bc7-rgba-unorm":{gl:36492,x:M},"bc7-rgba-unorm-srgb":{gl:36493,x:M},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function D(e){const t=k[e],r=function(e){const t=k[e],r=t?.gl;if(void 0===r)throw new Error(`Unsupported texture format ${e}`);return r}(e),n=(0,C.z)(e);return{internalFormat:r,format:t?.dataFormat||U(n.channels,n.integer,n.normalized,r),type:n.dataType?N(n.dataType):t?.types?.[0]||5121,compressed:n.compressed||!1}}function U(e,t,r,n){if(6408===n||6407===n)return n;switch(e){case"r":return t&&!r?36244:6403;case"rg":return t&&!r?33320:33319;case"rgb":return t&&!r?36248:6407;case"rgba":return t&&!r?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}const G={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class W extends n.I7{gl;extensions;testedFeatures=new Set;constructor(e,t,r){super([],r),this.gl=e,this.extensions=t,w(e,"EXT_color_buffer_float",t)}*[Symbol.iterator](){const e=this.getFeatures();for(const t of e)this.has(t)&&(yield t);return[]}has(e){return!this.disabledFeatures?.[e]&&(this.testedFeatures.has(e)||(this.testedFeatures.add(e),function(e){return e in B}(e)&&function(e,t,r){return(B[t]||[]).every((t=>w(e,t,r)))}(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter((e=>"polygon-mode-webgl"!==e));for(const t of e)this.has(t)}getFeatures(){return[...Object.keys(G),...Object.keys(B)]}getWebGLFeature(e){const t=G[e];return"string"==typeof t?Boolean(w(this.gl,t,this.extensions)):Boolean(t)}}class H extends n.PI{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return void 0===this.limits[e]&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}var X=r(74003),V=r(74683);class ${static defaultProps={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"};id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...$.defaultProps,...e},e=this.props,!(0,X.B)())return this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,void(this.canvas=null);if(e.canvas)"string"==typeof e.canvas?this.canvas=function(e){const t=document.getElementById(e);if(!(t instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return t}(e.canvas):this.canvas=e.canvas;else{const t=function(e){const{width:t,height:r}=e,n=document.createElement("canvas");return n.id=(0,V.L)("lumagl-auto-created-canvas"),n.width=t||1,n.height=r||1,n.style.width=Number.isFinite(t)?`${t}px`:"100%",n.style.height=Number.isFinite(r)?`${r}px`:"100%",n}(e),r=function(e){if("string"==typeof e){const t=document.getElementById(e);if(!t)throw new Error(`${e} is not an HTML element`);return t}if(e)return e;return document.body}(e?.container||null);r.insertBefore(t,r.firstChild),this.canvas=t,e?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver((e=>{for(const t of e)t.target===this.canvas&&this.update()})),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(e){if("undefined"!=typeof OffscreenCanvas&&this.canvas instanceof OffscreenCanvas)return 1;if(!(e=void 0===e?this.props.useDevicePixels:e)||e<=0)return 1;if(!0===e){return"undefined"!=typeof window&&window.devicePixelRatio||1}return e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),t=this.canvas;return t.parentElement?[t.clientWidth*e,t.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,t]=this.getPixelSize();return e/t}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),t=this._canvasSizeInfo.clientWidth||this.htmlCanvas?.clientWidth;return t?e/t:1}catch{return 1}}cssToDevicePixels(e,t=!0){const r=this.cssToDeviceRatio(),[n,s]=this.getDrawingBufferSize();return function(e,t,r,n,s){const i=e,o=z(i[0],t,r);let a=K(i[1],t,n,s),c=z(i[0]+1,t,r);const u=c===r-1?c:c-1;let l;c=K(i[1]+1,t,n,s),s?(c=0===c?c:c+1,l=a,a=c):l=c===n-1?c:c-1;return{x:o,y:a,width:Math.max(u-o+1,1),height:Math.max(l-a+1,1)}}(e,r,n,s,t)}setDevicePixelRatio(e,t={}){if(!this.htmlCanvas)return;let r="width"in t?t.width:this.htmlCanvas.clientWidth,n="height"in t?t.height:this.htmlCanvas.clientHeight;r&&n||(s.R.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=this.htmlCanvas.width||1,n=this.htmlCanvas.height||1);const i=this._canvasSizeInfo;if(i.clientWidth!==r||i.clientHeight!==n||i.devicePixelRatio!==e){let t=e;const i=Math.floor(r*t),o=Math.floor(n*t);this.htmlCanvas.width=i,this.htmlCanvas.height=o;if(this.device.gl){const[a,c]=this.getDrawingBufferSize();a===i&&c===o||(t=Math.min(a/r,c/n),this.htmlCanvas.width=Math.floor(r*t),this.htmlCanvas.height=Math.floor(n*t),s.R.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=r,this._canvasSizeInfo.clientHeight=n,this._canvasSizeInfo.devicePixelRatio=e}}}getDrawingBufferSize(){const e=this.device.gl;return e?[e.drawingBufferWidth,e.drawingBufferHeight]:this.getPixelSize()}_setAutoCreatedCanvasId(e){"lumagl-auto-created-canvas"===this.htmlCanvas?.id&&(this.htmlCanvas.id=e)}}function z(e,t,r){return Math.min(Math.round(e*t),r-1)}function K(e,t,r,n){return n?Math.max(0,r-1-Math.round(e*t)):Math.min(Math.round(e*t),r-1)}var Y=r(5153),j=r(80698);class q extends Y.F{static defaultProps={...Y.F.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,t={}){super(e,t,q.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const t=this.colorAttachments.map((t=>t.texture.clone(e))),r=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:t,depthStencilAttachment:r})}resize(e){let t=!e;if(e){const[r,n]=Array.isArray(e)?e:[e.width,e.height];t=t||n!==this.height||r!==this.width,this.width=r,this.height=n}t&&(s.R.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(0===this.props.colorAttachments.length&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map(((e,t)=>{if("string"==typeof e){const r=this.createColorTexture(e,t);return this.attachResource(r),r.view}return e instanceof j.g?e.view:e}));const e=this.props.depthStencilAttachment;if(e)if("string"==typeof e){const t=this.createDepthStencilTexture(e);this.attachResource(t),this.depthStencilAttachment=t.view}else e instanceof j.g?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,t){return this.device.createTexture({id:`${this.id}-color-attachment-${t}`,usage:j.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:j.g.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(e,t){for(let r=0;r<this.colorAttachments.length;++r)if(this.colorAttachments[r]){const n=this.colorAttachments[r].texture.clone({width:e,height:t});this.destroyAttachedResource(this.colorAttachments[r]),this.colorAttachments[r]=n.view,this.attachResource(n.view)}if(this.depthStencilAttachment){const r=this.depthStencilAttachment.texture.clone({width:e,height:t});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=r.view,this.attachResource(r)}this.updateAttachments()}}class Z extends q{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,t){super(e,t);const r=null===t.handle;this.device=e,this.gl=e.gl,this.handle=this.props.handle||r?this.props.handle:this.gl.createFramebuffer(),r||(e.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),this.destroyed||null===this.handle||this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let t=0;t<this.colorAttachments.length;++t){const e=this.colorAttachments[t];if(e){const r=36064+t;this._attachTextureView(r,e)}}if(this.depthStencilAttachment){const e=function(e){switch((0,C.z)(e).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${e}`)}}(this.depthStencilAttachment.props.format);this._attachTextureView(e,this.depthStencilAttachment)}if(this.device.props.debug){const e=this.gl.checkFramebufferStatus(36160);if(36053!==e)throw new Error(`Framebuffer ${function(e){switch(e){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${e}`}}(e)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,t){const{gl:r}=this.device,{texture:n}=t,s=t.props.baseMipLevel,i=t.props.baseArrayLayer;switch(r.bindTexture(n.glTarget,n.handle),n.glTarget){case 35866:case 32879:r.framebufferTextureLayer(36160,e,n.handle,s,i);break;case 34067:const t=function(e){return e<34069?e+34069:e}(i);r.framebufferTexture2D(36160,e,t,n.handle,s);break;case 3553:r.framebufferTexture2D(36160,e,3553,n.handle,s);break;default:throw new Error("Illegal texture type")}r.bindTexture(n.glTarget,null)}}class Q extends ${device;format="rgba8unorm";depthStencilFormat="depth24plus";presentationSize;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,t){super(t),this.device=e,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new Z(this.device,{handle:null}),this._framebuffer}update(){const e=this.getPixelSize();(e[0]!==this.presentationSize[0]||e[1]!==this.presentationSize[1])&&(this.presentationSize=e,this.resize())}resize(e){if(this.device.gl)if(this.canvas){const t=this.getDevicePixelRatio(e?.useDevicePixels);this.setDevicePixelRatio(t,e)}else;}commit(){}}var J=r(25299),ee=r(67483);const te={};function re(e="id"){te[e]=te[e]||1;return`${e}-${te[e]++}`}var ne=r(26839);class se extends ne.h{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor(e,t={}){super(e,t),this.device=e,this.gl=this.device.gl;const r="object"==typeof t?t.handle:void 0;this.handle=r||this.gl.createBuffer(),e.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=function(e){if(e&ne.h.INDEX)return 34963;if(e&ne.h.VERTEX)return 34962;if(e&ne.h.UNIFORM)return 35345;return 34962}(this.props.usage),this.glUsage=function(e){if(e&ne.h.INDEX)return 35044;if(e&ne.h.VERTEX)return 35044;if(e&ne.h.UNIFORM)return 35048;return 35044}(this.props.usage),this.glIndexType="uint32"===this.props.indexType?5125:5123,t.data?this._initWithData(t.data,t.byteOffset,t.byteLength):this._initWithByteLength(t.byteLength||0)}_initWithData(e,t=0,r=e.byteLength+t){const n=this.glTarget;this.gl.bindBuffer(n,this.handle),this.gl.bufferData(n,r,this.glUsage),this.gl.bufferSubData(n,t,e),this.gl.bindBuffer(n,null),this.bytesUsed=r,this.byteLength=r,this._setDebugData(e,t,r),this.trackAllocatedMemory(r)}_initWithByteLength(e){let t=e;0===e&&(t=new Float32Array(0));const r=this.glTarget;return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,t,this.glUsage),this.gl.bindBuffer(r,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(e,t=0){const r=36663;this.gl.bindBuffer(r,this.handle),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this._setDebugData(e,t,e.byteLength)}async readAsync(e=0,t){return this.readSyncWebGL(e,t)}readSyncWebGL(e=0,t){t=t??this.byteLength-e;const r=new Uint8Array(t);return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,r,0,t),this.gl.bindBuffer(36662,null),this._setDebugData(r,e,t),r}}var ie=r(11669);function oe(e){const t=e.toLowerCase();return["warning","error","info"].includes(t)?t:"info"}class ae extends ie.M{device;handle;constructor(e,t){switch(super(e,t),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then((()=>this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?function(e){const t=e.split(/\r?\n/),r=[];for(const n of t){if(n.length<=1)continue;const e=n.split(":");if(2===e.length){const[t,n]=e;r.push({message:n.trim(),type:oe(t),lineNum:0,linePos:0});continue}const[t,s,i,...o]=e;let a=parseInt(i,10);isNaN(a)&&(a=0);let c=parseInt(s,10);isNaN(c)&&(c=0),r.push({message:o.join(":").trim(),type:oe(t),lineNum:a,linePos:c})}return r}(e):[]}getTranslatedSource(){const e=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return e?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es\n${e}`;const{gl:t}=this.device;if(t.shaderSource(this.handle,e),t.compileShader(this.handle),this.device.props.debug){if(this.device.features.has("compilation-status-async-webgl"))s.R.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),s.R.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader();else if(this._getCompilationStatus(),this.debugShader(),"error"===this.compilationStatus)throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`)}else this.compilationStatus="pending"}async _waitForCompilationComplete(){const e=async e=>await new Promise((t=>setTimeout(t,e)));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}var ce=r(89277);function ue(e,t){const r=e,{gl:n}=r;if(t.cullMode)switch(t.cullMode){case"none":n.disable(2884);break;case"front":n.enable(2884),n.cullFace(1028);break;case"back":n.enable(2884),n.cullFace(1029)}if(t.frontFace&&n.frontFace(_e("frontFace",t.frontFace,{ccw:2305,cw:2304})),t.unclippedDepth&&e.features.has("depth-clip-control")&&n.enable(34383),void 0!==t.depthBias&&(n.enable(32823),n.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){const e=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,n=_e("provokingVertex",t.provokingVertex,{first:36429,last:36430});e?.provokingVertexWEBGL(n)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){const e=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,n=_e("polygonMode",t.polygonMode,{fill:6914,line:6913});e?.polygonModeWEBGL(1028,n),e?.polygonModeWEBGL(1029,n)}t.polygonOffsetLine&&n.enable(10754)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&n.enable(12288),t.clipDistance1&&n.enable(12289),t.clipDistance2&&n.enable(12290),t.clipDistance3&&n.enable(12291),t.clipDistance4&&n.enable(12292),t.clipDistance5&&n.enable(12293),t.clipDistance6&&n.enable(12294),t.clipDistance7&&n.enable(12295)),void 0!==t.depthWriteEnabled&&n.depthMask(t.depthWriteEnabled),t.depthCompare&&("always"!==t.depthCompare?n.enable(2929):n.disable(2929),n.depthFunc(le("depthCompare",t.depthCompare))),t.stencilWriteMask){const e=t.stencilWriteMask;n.stencilMaskSeparate(1028,e),n.stencilMaskSeparate(1029,e)}if(t.stencilReadMask&&s.R.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){const e=t.stencilReadMask||4294967295,r=le("depthCompare",t.stencilCompare);"always"!==t.stencilCompare?n.enable(2960):n.disable(2960),n.stencilFuncSeparate(1028,r,0,e),n.stencilFuncSeparate(1029,r,0,e)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){const e=he("stencilPassOperation",t.stencilPassOperation),r=he("stencilFailOperation",t.stencilFailOperation),s=he("stencilDepthFailOperation",t.stencilDepthFailOperation);n.stencilOpSeparate(1028,r,s,e),n.stencilOpSeparate(1029,r,s,e)}switch(t.blend){case!0:n.enable(3042);break;case!1:n.disable(3042)}if(t.blendColorOperation||t.blendAlphaOperation){const e=de("blendColorOperation",t.blendColorOperation||"add"),r=de("blendAlphaOperation",t.blendAlphaOperation||"add");n.blendEquationSeparate(e,r);const s=fe("blendColorSrcFactor",t.blendColorSrcFactor||"one"),i=fe("blendColorDstFactor",t.blendColorDstFactor||"zero"),o=fe("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),a=fe("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");n.blendFuncSeparate(s,i,o,a)}}function le(e,t){return _e(e,t,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function he(e,t){return _e(e,t,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function de(e,t){return _e(e,t,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function fe(e,t){return _e(e,t,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function _e(e,t,r){if(!(t in r))throw new Error(function(e,t){return`Illegal parameter ${t} for ${e}`}(e,t));return r[t]}function pe(e){let t=!0;for(const r in e){t=!1;break}return t}function ge(e){const t={};return e.addressModeU&&(t[10242]=me(e.addressModeU)),e.addressModeV&&(t[10243]=me(e.addressModeV)),e.addressModeW&&(t[32882]=me(e.addressModeW)),e.magFilter&&(t[10240]=Ee(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[10241]=function(e,t="none"){if(!t)return Ee(e);switch(t){case"none":return Ee(e);case"nearest":return"nearest"===e?9984:9986;case"linear":return"nearest"===e?9985:9987}}(e.minFilter||"linear",e.mipmapFilter)),void 0!==e.lodMinClamp&&(t[33082]=e.lodMinClamp),void 0!==e.lodMaxClamp&&(t[33083]=e.lodMaxClamp),"comparison-sampler"===e.type&&(t[34892]=34894),e.compare&&(t[34893]=le("compare",e.compare)),e.maxAnisotropy&&(t[34046]=e.maxAnisotropy),t}function me(e){switch(e){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function Ee(e){switch(e){case"nearest":return 9728;case"linear":return 9729}}class be extends ce.L{device;handle;parameters;constructor(e,t){super(e,t),this.device=e,this.parameters=ge(t),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[t,r]of Object.entries(e)){const e=Number(t);switch(e){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,e,r);break;default:this.device.gl.samplerParameteri(this.handle,e,r)}}}}var Te=r(75638);class ye extends Te.X{device;gl;handle;texture;constructor(e,t){super(e,{...j.g.defaultProps,...t}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=t.texture}}function Ae(e){switch(e){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function Re(e,t,r){if(function(e){for(const t in e)return!1;return!0}(t))return r(e);const{nocatch:n=!0}=t,s=A.get(e);let i;if(s.push(),b(e,t),n)i=r(e),s.pop();else try{i=r(e)}finally{s.pop()}return i}function Se(e,t,r,n){const{width:s,height:i}=n,{dimension:o,depth:a=0,mipLevel:c=0}=n,{x:u=0,y:l=0,z:h=0}=n,{glFormat:d,glType:f}=n,_=ve(n.glTarget,o,a),p=n.flipY?{37440:!0}:{};Re(e,p,(()=>{switch(o){case"2d-array":case"3d":e.bindTexture(_,t),e.texSubImage3D(_,c,u,l,h,s,i,a,d,f,r),e.bindTexture(_,null);break;case"2d":case"cube":e.bindTexture(_,t),e.texSubImage2D(_,c,u,l,s,i,d,f,r),e.bindTexture(_,null);break;default:throw new Error(o)}}))}function we(e,t,r){const{dimension:n,width:s,height:i,depth:o=0,mipLevel:a=0,byteOffset:c=0}=r,{x:u=0,y:l=0,z:h=0}=r,{glFormat:d,glType:f,compressed:_}=r,p=ve(r.glTarget,n,o);switch(n){case"2d-array":case"3d":_?e.compressedTexSubImage3D(p,a,u,l,h,s,i,o,d,t,c):e.texSubImage3D(p,a,u,l,h,s,i,o,d,f,t,c);break;case"2d":case"cube":_?e.compressedTexSubImage2D(p,a,u,l,s,i,d,t,c):e.texSubImage2D(p,a,u,l,s,i,d,f,t,c);break;default:throw new Error(n)}}function ve(e,t,r){return"cube"===t?34069+r:e}function xe(e,t){const{sourceX:r=0,sourceY:n=0,sourceAttachment:s=0}=t||{};let{target:i=null,sourceWidth:o,sourceHeight:a,sourceDepth:c,sourceFormat:u,sourceType:l}=t||{};const{framebuffer:h,deleteFramebuffer:d}=Ce(e),{gl:f,handle:_}=h;o||=h.width,a||=h.height;const p=h.colorAttachments[s]?.texture;if(!p)throw new Error(`Invalid framebuffer attachment ${s}`);c=p?.depth||1,u||=p?.glFormat||6408,l||=p?.glType||5121,i=function(e,t,r,n,s){if(e)return e;t||=5121;const i=function(e,t){const{clamped:r=!0}=t||{};switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return r?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}(t,{clamped:!1}),o=Ae(r);return new i(n*s*o)}(i,l,u,o,a),l=l||function(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}(i);const g=f.bindFramebuffer(36160,_);return f.readBuffer(36064+s),f.readPixels(r,n,o,a,u,l,i),f.readBuffer(36064),f.bindFramebuffer(36160,g||null),d&&h.destroy(),i}function Ce(e){return e instanceof q?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:Ne(e),deleteFramebuffer:!0}}function Ne(e,t){const{device:r,width:n,height:s,id:i}=e;return r.createFramebuffer({...t,id:`framebuffer-for-${i}`,width:n,height:s,colorAttachments:[e]})}class Ie extends j.g{device;gl;handle;sampler=void 0;view=void 0;mipmaps;compressed;glTarget;glFormat;glType;glInternalFormat;textureUnit=0;constructor(e,t){super(e,t);const r={...this.props};r.data=t.data,this.device=e,this.gl=this.device.gl,this.glTarget=function(e){switch(e){case"1d":case"cube-array":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(e)}(this.props.dimension);const n=D(this.props.format);this.glInternalFormat=n.internalFormat,this.glFormat=n.format,this.glType=n.type,this.compressed=n.compressed,this.mipmaps=Boolean(this.props.mipmaps),this._initialize(r),Object.seal(this)}_initialize(e){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:e.data});let{width:t,height:r}=e;if(!t||!r){const n=j.g.getTextureDataSize(e.data);t=n?.width||1,r=n?.height||1}if(this.width=t,this.height=r,this.depth=e.depth,this.setSampler(e.sampler),this.view=new ye(this.device,{...this.props,texture:this}),this.bind(),function(e,t,r){const{dimension:n,width:s,height:i,depth:o=0}=r,{glInternalFormat:a}=r,c=r.glTarget;switch(n){case"2d-array":case"3d":e.texStorage3D(c,t,a,s,i,o);break;default:e.texStorage2D(c,t,a,s,i)}}(this.gl,this.mipLevels,this),e.data)switch(e.dimension){case"1d":this.setTexture1DData(e.data);break;case"2d":this.setTexture2DData(e.data);break;case"3d":this.setTexture3DData(e.data);break;case"cube":this.setTextureCubeData(e.data);break;case"2d-array":this.setTextureArrayData(e.data);break;case"cube-array":this.setTextureCubeArrayData(e.data);break;default:throw new Error(e.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new ye(this.device,{...e,texture:this})}setSampler(e={}){let t;e instanceof be?(this.sampler=e,t=e.props):(this.sampler=new be(this.device,e),t=e);const r=ge(t);this._setSamplerParameters(r)}generateMipmap(e){if(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format)||(s.R.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),e?.force))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(t){s.R.warn(`Error generating mipmap for ${this}: ${t.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(e){const t=j.g.getExternalImageSize(e.image),r={...j.g.defaultCopyExternalImageOptions,...t,...e},{image:n,depth:s,mipLevel:i,x:o,y:a,z:c,flipY:u}=r;let{width:l,height:h}=r;const{dimension:d,glTarget:f,glFormat:_,glInternalFormat:p,glType:g}=this;if(l=Math.min(l,this.width-o),h=Math.min(h,this.height-a),e.sourceX||e.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return Se(this.device.gl,this.handle,n,{dimension:d,mipLevel:i,x:o,y:a,z:c,width:l,height:h,depth:s,glFormat:_,glInternalFormat:p,glType:g,glTarget:f,flipY:u}),{width:r.width,height:r.height}}setTexture1DData(e){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(e,t=0){this.bind();const r=j.g.normalizeTextureData(e,this);r.length>1&&!1!==this.props.mipmaps&&s.R.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let n=0;n<r.length;n++){const e=r[n];this._setMipLevel(t,n,e)}this.unbind()}setTexture3DData(e){if("3d"!==this.props.dimension)throw new Error(this.id);ArrayBuffer.isView(e)&&(this.bind(),we(this.device.gl,e,this),this.unbind())}setTextureCubeData(e,t=0){if("cube"!==this.props.dimension)throw new Error(this.id);for(const r of j.g.CubeFaces)this.setTextureCubeFaceData(e[r],r)}setTextureArrayData(e){if("2d-array"!==this.props.dimension)throw new Error(this.id);throw new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(e){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(e,t,r=0){Array.isArray(e)&&e.length>1&&!1!==this.props.mipmaps&&s.R.warn(`${this.id} has mipmap and multiple LODs.`)();const n=j.g.CubeFaces.indexOf(t);this.setTexture2DData(e,n)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(e){const{face:t,width:r,height:n,pixels:s,data:i,format:o=6408,type:a=5121}=e,{gl:c}=this,u=s||i;this.bind(),u instanceof Promise?u.then((r=>this.setImageDataForFace(Object.assign({},e,{face:t,data:r,pixels:r})))):this.width||this.height?c.texImage2D(t,0,o,r,n,0,o,a,u):c.texImage2D(t,0,o,o,a,u)}_getImageDataMap(e){for(let t=0;t<j.g.CubeFaces.length;++t){const r=j.g.CubeFaces[t];e[r]&&(e[34069+t]=e[r],delete e[r])}return e}_setSamplerParameters(e){s.R.log(1,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[t,r]of Object.entries(e)){const e=Number(t),n=r;switch(e){case 33082:case 33083:this.gl.texParameterf(this.glTarget,e,n);break;case 10241:case 10242:case 10243:default:this.gl.texParameteri(this.glTarget,e,n);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,e,n)}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(e,t,r,n=this.glTarget){if(j.g.isExternalImage(r))Se(this.device.gl,this.handle,r,{...this,depth:e,mipLevel:t,glTarget:n,flipY:this.props.flipY});else{if(!j.g.isTextureLevelData(r))throw new Error("Texture: invalid image data");we(this.device.gl,r.data,{...this,depth:e,mipLevel:t,glTarget:n})}}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,this.handle),e}unbind(e){const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,null),e}}class Le extends Y.F{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;static defaultProps={...Y.F.defaultProps,framebuffer:null,parameters:void 0,clearColor:Le.defaultClearColor,clearColors:void 0,clearDepth:Le.defaultClearDepth,clearStencil:Le.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0};get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){super(e,t=Le.normalizeProps(e,t),Le.defaultProps)}static normalizeProps(e,t){const r=e.props._resourceDefaults?.renderPass;return{...r,...t}}}const Oe=[1,2,4,8];class Me extends Le{device;glParameters;constructor(e,t){let r;if(super(e,t),this.device=e,!t?.parameters?.viewport)if(t?.framebuffer){const{width:e,height:n}=t.framebuffer;r=[0,0,e,n]}else{const[t,n]=e.getCanvasContext().getDrawingBufferSize();r=[0,0,t,n]}this.device.pushState(),this.setParameters({viewport:r,...this.props.parameters});const n=this.props.framebuffer;if(n?.handle)if(this.props.framebuffer){const e=this.props.framebuffer.colorAttachments.map(((e,t)=>36064+t));this.device.gl.drawBuffers(e)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){const t={...this.glParameters};t.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(t.depthMask=!this.props.depthReadOnly),t.stencilMask=this.props.stencilReadOnly?0:1,t[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(t.viewport=e.viewport.slice(0,4),t.depthRange=[e.viewport[4],e.viewport[5]]):t.viewport=e.viewport),e.scissorRect&&(t.scissorTest=!0,t.scissor=e.scissorRect),e.blendConstant&&(t.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),e[2967]=e.stencilReference),e.colorMask&&(t.colorMask=Oe.map((t=>Boolean(t&e.colorMask)))),this.glParameters=t,b(this.device.gl,t)}beginOcclusionQuery(e){const t=this.props.occlusionQuerySet;t?.beginOcclusionQuery()}endOcclusionQuery(){const e=this.props.occlusionQuerySet;e?.endOcclusionQuery()}clear(){const e={...this.glParameters};let t=0;this.props.clearColors&&this.props.clearColors.forEach(((e,t)=>{e&&this.clearColorBuffer(t,e)})),!1!==this.props.clearColor&&void 0===this.props.clearColors&&(t|=16384,e.clearColor=this.props.clearColor),!1!==this.props.clearDepth&&(t|=256,e.clearDepth=this.props.clearDepth),!1!==this.props.clearStencil&&(t|=1024,e.clearStencil=this.props.clearStencil),0!==t&&Re(this.device.gl,e,(()=>{this.device.gl.clear(t)}))}clearColorBuffer(e=0,t=[0,0,0,0]){Re(this.device.gl,{framebuffer:this.props.framebuffer},(()=>{switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,t);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,t);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,t);break;default:throw new Error("clearColorBuffer: color must be typed array")}}))}}var Pe=r(22512);const Fe=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],Be={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function ke(e){const t=Be[e];if(!t)throw new Error("uniform");const[r,n,,s]=t;return{format:s,components:n,glType:r}}function De(e){const t=Be[e];if(!t)throw new Error("attribute");const[,r,,n,s]=t;return{attributeType:n,vertexFormat:s,components:r}}function Ue(e,t){const r={attributes:[],bindings:[]};r.attributes=function(e,t){const r=[],n=e.getProgramParameter(t,35721);for(let s=0;s<n;s++){const n=e.getActiveAttrib(t,s);if(!n)throw new Error("activeInfo");const{name:i,type:o}=n,a=e.getAttribLocation(t,i);if(a>=0){const{attributeType:e}=De(o),t=/instance/i.test(i)?"instance":"vertex";r.push({name:i,location:a,stepMode:t,type:e})}}return r.sort(((e,t)=>e.location-t.location)),r}(e,t);const n=function(e,t){const r=(r,n)=>e.getActiveUniformBlockParameter(t,r,n),n=[],s=e.getProgramParameter(t,35382);for(let i=0;i<s;i++){const s={name:e.getActiveUniformBlockName(t,i)||"",location:r(i,35391),byteLength:r(i,35392),vertex:r(i,35396),fragment:r(i,35398),uniformCount:r(i,35394),uniforms:[]},o=r(i,35395)||[],a=e.getActiveUniforms(t,o,35383),c=e.getActiveUniforms(t,o,35384),u=e.getActiveUniforms(t,o,35387),l=e.getActiveUniforms(t,o,35388);for(let r=0;r<s.uniformCount;++r){const n=e.getActiveUniform(t,o[r]);if(!n)throw new Error("activeInfo");s.uniforms.push({name:n.name,format:ke(a[r]).format,type:a[r],arrayLength:c[r],byteOffset:u[r],byteStride:l[r]})}n.push(s)}return n.sort(((e,t)=>e.location-t.location)),n}(e,t);for(const c of n){const e=c.uniforms.map((e=>({name:e.name,format:e.format,byteOffset:e.byteOffset,byteStride:e.byteStride,arrayLength:e.arrayLength})));r.bindings.push({type:"uniform",name:c.name,group:0,location:c.location,visibility:(c.vertex?1:0)&(c.fragment?2:0),minBindingSize:c.byteLength,uniforms:e})}const s=function(e,t){const r=[],n=e.getProgramParameter(t,35718);for(let s=0;s<n;s++){const n=e.getActiveUniform(t,s);if(!n)throw new Error("activeInfo");const{name:i,size:o,type:a}=n,{name:c,isArray:u}=He(i);let l=e.getUniformLocation(t,c);const h={location:l,name:c,size:o,type:a,isArray:u};if(r.push(h),h.size>1)for(let s=0;s<h.size;s++){const n=`${c}[${s}]`;l=e.getUniformLocation(t,n);const i={...h,name:n,location:l};r.push(i)}}return r}(e,t);let i=0;for(const c of s)if(o=c.type,Fe.includes(o)){const{viewDimension:e,sampleType:t}=We(c.type);r.bindings.push({type:"texture",name:c.name,group:0,location:i,viewDimension:e,sampleType:t}),c.textureUnit=i,i+=1}var o;s.length&&(r.uniforms=s);const a=function(e,t){const r=[],n=e.getProgramParameter(t,35971);for(let s=0;s<n;s++){const n=e.getTransformFeedbackVarying(t,s);if(!n)throw new Error("activeInfo");const{name:i,type:o,size:a}=n,{glType:c,components:u}=ke(o),l={location:s,name:i,type:c,size:a*u};r.push(l)}return r.sort(((e,t)=>e.location-t.location)),r}(e,t);return a?.length&&(r.varyings=a),r}const Ge={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function We(e){const t=Ge[e];if(!t)throw new Error("sampler");const[r,n]=t;return{viewDimension:r,sampleType:n}}function He(e){if("]"!==e[e.length-1])return{name:e,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:t[1],length:t[2]?1:0,isArray:Boolean(t[2])}}function Xe(e,t,r,n){const s=e;let i=n;!0===i&&(i=1),!1===i&&(i=0);const o="number"==typeof i?[i]:i;switch(r){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if("number"!=typeof n)throw new Error("samplers must be set to integers");return e.uniform1i(t,n);case 5126:return e.uniform1fv(t,o);case 35664:return e.uniform2fv(t,o);case 35665:return e.uniform3fv(t,o);case 35666:return e.uniform4fv(t,o);case 5124:case 35670:return e.uniform1iv(t,o);case 35667:case 35671:return e.uniform2iv(t,o);case 35668:case 35672:return e.uniform3iv(t,o);case 35669:case 35673:return e.uniform4iv(t,o);case 5125:return s.uniform1uiv(t,o,1);case 36294:return s.uniform2uiv(t,o,2);case 36295:return s.uniform3uiv(t,o,3);case 36296:return s.uniform4uiv(t,o,4);case 35674:return e.uniformMatrix2fv(t,!1,o);case 35675:return e.uniformMatrix3fv(t,!1,o);case 35676:return e.uniformMatrix4fv(t,!1,o);case 35685:return s.uniformMatrix2x3fv(t,!1,o);case 35686:return s.uniformMatrix2x4fv(t,!1,o);case 35687:return s.uniformMatrix3x2fv(t,!1,o);case 35688:return s.uniformMatrix3x4fv(t,!1,o);case 35689:return s.uniformMatrix4x2fv(t,!1,o);case 35690:return s.uniformMatrix4x3fv(t,!1,o)}throw new Error("Illegal uniform")}var Ve=r(76282);function $e(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach((r=>{const n=e[r];var s;s=n,null!==(0,Ve.H9)(s)||"number"==typeof s||"boolean"==typeof s?t.uniforms[r]=n:t.bindings[r]=n})),t}class ze extends Pe.r{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(e,t){super(e,t),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=t.vs,this.fs=t.fs;const{varyings:r,bufferMode:n=35981}=t;r&&r.length>0&&(this.varyings=r,this.device.gl.transformFeedbackVaryings(this.handle,r,n)),this._linkShaders(),s.R.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=Ue(this.device.gl,this.handle),s.R.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=function(e,t){const r={...e,attributes:e.attributes.map((e=>({...e})))};for(const n of t?.attributes||[]){const e=r.attributes.find((e=>e.name===n.name));e?(e.type=n.type||e.type,e.stepMode=n.stepMode||e.stepMode):s.R.warn(`shader layout attribute ${n.name} not present in shader`)}return r}(this.introspectedLayout,t.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(e,t){for(const[r,n]of Object.entries(e)){const e=this.shaderLayout.bindings.find((e=>e.name===r))||this.shaderLayout.bindings.find((e=>e.name===`${r}Uniforms`));if(e){switch(n||s.R.warn(`Unsetting binding "${r}" in render pipeline "${this.id}"`)(),e.type){case"uniform":if(!(n instanceof se||n.buffer instanceof se))throw new Error("buffer value");break;case"texture":if(!(n instanceof ye||n instanceof Ie||n instanceof Z))throw new Error("texture value");break;case"sampler":s.R.warn(`Ignoring sampler ${r}`)();break;default:throw new Error(e.type)}this.bindings[r]=n}else{const e=this.shaderLayout.bindings.map((e=>`"${e.name}"`)).join(", ");t?.disableWarnings||s.R.warn(`No binding "${r}" in render pipeline "${this.id}", expected one of ${e}`,n)()}}}draw(e){const{renderPass:t,parameters:r=this.props.parameters,topology:n=this.props.topology,vertexArray:i,vertexCount:o,instanceCount:a,isInstanced:c=!1,firstVertex:u=0,transformFeedback:l}=e,h=function(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(e)}}(n),d=Boolean(i.indexBuffer),f=i.indexBuffer?.glIndexType;if("success"!==this.linkStatus)return s.R.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return s.R.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),i.bindBeforeRender(t),l&&l.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const _=t;return function(e,t,r,n){if(pe(t))return n(e);const s=e;s.pushState();try{return ue(e,t),b(s.gl,r),n(e)}finally{s.popState()}}(this.device,r,_.glParameters,(()=>{d&&c?this.device.gl.drawElementsInstanced(h,o||0,f,u,a||0):d?this.device.gl.drawElements(h,o||0,f,u):c?this.device.gl.drawArraysInstanced(h,u,o||0,a||0):this.device.gl.drawArrays(h,u,o||0),l&&l.end()})),i.unbindAfterRender(t),!0}setUniformsWebGL(e){const{bindings:t}=$e(e);Object.keys(t).forEach((e=>{s.R.warn(`Unsupported value "${JSON.stringify(t[e])}" used in setUniforms() for key ${e}. Use setBindings() instead?`)()})),Object.assign(this.uniforms,e)}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),s.R.time(4,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),s.R.timeEnd(4,`linkProgram for ${this.id}`)(),s.R.level,!this.device.features.has("compilation-status-async-webgl")){const e=this._getLinkStatus();return void this._reportLinkStatus(e)}s.R.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),s.R.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const t=this._getLinkStatus();this._reportLinkStatus(t)}async _reportLinkStatus(e){if("success"!==e){switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then((()=>this.vs.debugShader()))}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then((()=>this.fs.debugShader()))}const t=this.device.gl.getProgramInfoLog(this.handle);throw new Error(`Error during ${e}: ${t}`)}}_getLinkStatus(){const{gl:e}=this.device;if(!e.getProgramParameter(this.handle,35714))return this.linkStatus="error","linking";e.validateProgram(this.handle);return e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")}async _waitForLinkComplete(){const e=async e=>await new Promise((t=>setTimeout(t,e)));if(!this.device.features.has("compilation-status-async-webgl"))return void await e(10);const{gl:t}=this.device;for(;;){if(t.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const t of this.shaderLayout.bindings)this.bindings[t.name]||this.bindings[t.name.replace(/Uniforms$/,"")]||(s.R.warn(`Binding ${t.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if("success"!==this.linkStatus)return;const{gl:e}=this.device;e.useProgram(this.handle);let t=0,r=0;for(const n of this.shaderLayout.bindings){const i=this.bindings[n.name]||this.bindings[n.name.replace(/Uniforms$/,"")];if(!i)throw new Error(`No value for binding ${n.name} in ${this.id}`);switch(n.type){case"uniform":const{name:o}=n,a=e.getUniformBlockIndex(this.handle,o);if(4294967295===a)throw new Error(`Invalid uniform block name ${o}`);e.uniformBlockBinding(this.handle,r,a),i instanceof se?e.bindBufferBase(35345,r,i.handle):e.bindBufferRange(35345,r,i.buffer.handle,i.offset||0,i.size||i.buffer.byteLength-i.offset),r+=1;break;case"texture":if(!(i instanceof ye||i instanceof Ie||i instanceof Z))throw new Error("texture");let c;if(i instanceof ye)c=i.texture;else if(i instanceof Ie)c=i;else{if(!(i instanceof Z&&i.colorAttachments[0]instanceof ye))throw new Error("No texture");s.R.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),c=i.colorAttachments[0].texture}e.activeTexture(33984+t),e.bindTexture(c.glTarget,c.handle),t+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${n.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:t,location:r,type:n,textureUnit:s}=e,i=this.uniforms[t]??s;void 0!==i&&Xe(this.device.gl,r,n,i)}}}class Ke extends Y.F{static defaultProps={...Y.F.defaultProps,measureExecutionTime:void 0};get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,Ke.defaultProps)}}class Ye extends Y.F{static defaultProps={...Y.F.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,Ye.defaultProps)}}class je extends Ye{device;commands=[];constructor(e){super(e,{}),this.device=e}submitCommands(e=this.commands){for(const t of e)switch(t.name){case"copy-buffer-to-buffer":qe(this.device,t.options);break;case"copy-buffer-to-texture":Ze(this.device,t.options);break;case"copy-texture-to-buffer":Qe(this.device,t.options);break;case"copy-texture-to-texture":Je(this.device,t.options);break;default:throw new Error(t.name)}}}function qe(e,t){const r=t.sourceBuffer,n=t.destinationBuffer;e.gl.bindBuffer(36662,r.handle),e.gl.bindBuffer(36663,n.handle),e.gl.copyBufferSubData(36662,36663,t.sourceOffset??0,t.destinationOffset??0,t.size),e.gl.bindBuffer(36662,null),e.gl.bindBuffer(36663,null)}function Ze(e,t){throw new Error("Not implemented")}function Qe(e,t){const{sourceTexture:r,mipLevel:n=0,aspect:s="all",width:i=t.sourceTexture.width,height:o=t.sourceTexture.height,depthOrArrayLayers:a=0,origin:c=[0,0],destinationBuffer:u,byteOffset:l=0,bytesPerRow:h,rowsPerImage:d}=t;if("all"!==s)throw new Error("aspect not supported in WebGL");if(0!==n||0!==a||h||d)throw new Error("not implemented");const{framebuffer:f,destroyFramebuffer:_}=et(r);let p;try{const t=u,r=i||f.width,n=o||f.height,s=D(f.colorAttachments[0].texture.props.format),a=s.format,h=s.type;e.gl.bindBuffer(35051,t.handle),p=e.gl.bindFramebuffer(36160,f.handle),e.gl.readPixels(c[0],c[1],r,n,a,h,l)}finally{e.gl.bindBuffer(35051,null),void 0!==p&&e.gl.bindFramebuffer(36160,p),_&&f.destroy()}}function Je(e,t){const{sourceTexture:r,destinationMipLevel:n=0,origin:s=[0,0],destinationOrigin:i=[0,0],destinationTexture:o}=t;let{width:a=t.destinationTexture.width,height:c=t.destinationTexture.height}=t;const{framebuffer:u,destroyFramebuffer:l}=et(r),[h,d]=s,[f,_,p]=i,g=e.gl.bindFramebuffer(36160,u.handle);let m,E=null;if(!(o instanceof Ie))throw new Error("invalid destination");switch(E=o,a=Number.isFinite(a)?a:E.width,c=Number.isFinite(c)?c:E.height,E.bind(0),m=E.glTarget,m){case 3553:case 34067:e.gl.copyTexSubImage2D(m,n,f,_,h,d,a,c);break;case 35866:case 32879:e.gl.copyTexSubImage3D(m,n,f,_,p,h,d,a,c)}E&&E.unbind(),e.gl.bindFramebuffer(36160,g),l&&u.destroy()}function et(e){if(e instanceof j.g){const{width:t,height:r,id:n}=e;return{framebuffer:e.device.createFramebuffer({id:`framebuffer-for-${n}`,width:t,height:r,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}class tt extends Ke{device;commandBuffer;constructor(e,t){super(e,t),this.device=e,this.commandBuffer=new je(e)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,t,r){}}var rt=r(40428);class nt extends Y.F{static defaultProps={...Y.F.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,t){super(e,t,nt.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);const{shaderLayout:r,bufferLayout:n}=t.renderPipeline||{};if(!r||!n)throw new Error("VertexArray");this.attributeInfos=(0,rt.M)(r,n,this.maxVertexAttributes)}setConstantWebGL(e,t){this.device.reportError(new Error("constant attributes not supported"))}}var st=r(73390),it=r(77989),ot=r(93640);class at extends nt{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return"Chrome"==(t||(0,X.B)()?(0,it.b)(t)?"Electron":(t||ot.gM.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node");var t}constructor(e,t){super(e,t),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const t=e;if(t&&34963!==t.glTarget)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,t?t.handle:null),this.indexBuffer=t,this.device.gl.bindVertexArray(null)}setBuffer(e,t){const r=t;if(34963===r.glTarget)throw new Error("Use .setIndexBuffer()");const{size:n,type:s,stride:i,offset:o,normalized:a,integer:c,divisor:u}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,r.handle),c?this.device.gl.vertexAttribIPointer(e,n,s,i,o):this.device.gl.vertexAttribPointer(e,n,s,a,i,o),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,u||0),this.attributes[e]=r,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,t){this._enable(e,!1),this.attributes[e]=t}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const t=this.attributes[e];ArrayBuffer.isView(t)&&this.device.setConstantAttributeWebGL(e,t)}}_getAccessor(e){const t=this.attributeInfos[e];if(!t)throw new Error(`Unknown attribute location ${e}`);const r=N(t.bufferDataType);return{size:t.bufferComponents,type:r,stride:t.byteStride,offset:t.byteOffset,normalized:t.normalized,integer:t.integer,divisor:"instance"===t.stepMode?1:0}}_enable(e,t=!0){const r=at.isConstantAttributeZeroSupported(this.device);(t||(r||0!==e))&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),t?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,t){const r=function(e){if(Array.isArray(e))return new Float32Array(e);return e}(t),n=r.byteLength*e,s=r.length*e;if(this.buffer&&n!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${n} !== ${this.buffer.byteLength}.`);let i=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:n}),i=i||!function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(r,this.bufferValue),i){const e=(0,st.X)(t.constructor,s);!function(e){const{target:t,source:r,start:n=0,count:s=1}=e,i=r.length,o=s*i;let a=0;for(let c=n;a<i;a++)t[c++]=r[a];for(;a<o;)a<o-a?(t.copyWithin(n+a,n,n+a),a*=2):(t.copyWithin(n+a,n,n+o-a),a=o);e.target}({target:e,source:r,start:0,count:s}),this.buffer.write(e),this.bufferValue=t}return this.buffer}}class ct extends Y.F{static defaultProps={...Y.F.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,ct.defaultProps)}}class ut extends ct{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,t){super(e,t),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,t.buffers&&this.setBuffers(t.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(function(e){switch(e){case"point-list":return 0;case"line-list":case"line-strip":return 1;case"triangle-list":case"triangle-strip":return 4;default:throw new Error(e)}}(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind((()=>{for(const t in e)this.setBuffer(t,e[t])}))}setBuffer(e,t){const r=this._getVaryingIndex(e),{buffer:n,byteLength:i,byteOffset:o}=this._getBufferRange(t);if(r<0)return this.unusedBuffers[e]=n,void s.R.warn(`${this.id} unusedBuffers varying buffer ${e}`)();this.buffers[r]={buffer:n,byteLength:i,byteOffset:o},this.bindOnUse||this._bindBuffer(r,n,o,i)}getBuffer(e){if(lt(e))return this.buffers[e]||null;const t=this._getVaryingIndex(e);return t>=0?this.buffers[t]:null}bind(e=this.handle){if("function"!=typeof e)return this.gl.bindTransformFeedback(36386,e),this;let t;return this._bound?t=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,t=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),t}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof se)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:t,byteOffset:r=0,byteLength:n=e.buffer.byteLength}=e;return{buffer:t,byteOffset:r,byteLength:n}}_getVaryingIndex(e){if(lt(e))return Number(e);for(const t of this.layout.varyings)if(e===t.name)return t.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:t,byteLength:r,byteOffset:n}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),t,n,r)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,t,r=0,n){const s=t&&t.handle;s&&void 0!==n?this.gl.bindBufferRange(35982,e,s,r,n):this.gl.bindBufferBase(35982,e,s)}}function lt(e){return"number"==typeof e?Number.isInteger(e):/^\d+$/.test(e)}class ht extends Y.F{static defaultProps={...Y.F.defaultProps,type:void 0,count:void 0};get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,ht.defaultProps)}}class dt extends ht{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,t){if(super(e,t),this.device=e,t.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise(((r,n)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):t++>e?(n("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)})),this._pollingPromise}}class ft extends n.pF{type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;constructor(e){super({...e,id:e.id||re("webgl-device")});const t=n.pF._getCanvasContextProps(e);if(!t)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let r=t.canvas?.gl?.device;if(r)throw new Error(`WebGL context already attached to device ${r.id}`);this.canvasContext=new Q(this,t),this.lost=new Promise((e=>{this._resolveContextLost=e}));const i={...e.webgl};"premultiplied"===t.alphaMode&&(i.premultipliedAlpha=!0),void 0!==e.powerPreference&&(i.powerPreference=e.powerPreference);const o=this.props._handle||function(e,t,r){let n="";const s={preserveDrawingBuffer:!0,...r};let i=null;if(i||=e.getContext("webgl2",s),s.failIfMajorPerformanceCaveat&&(n||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),i||r.failIfMajorPerformanceCaveat||(s.failIfMajorPerformanceCaveat=!1,i=e.getContext("webgl2",s),i.luma||={},i.luma.softwareRenderer=!0),i||(i=e.getContext("webgl",{}),i&&(i=null,n||="Your browser only supports WebGL1")),!i)throw n||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${n}`);const{onContextLost:o,onContextRestored:a}=t;return e.addEventListener("webglcontextlost",(e=>o(e)),!1),e.addEventListener("webglcontextrestored",(e=>a(e)),!1),i.luma||={},i}(this.canvasContext.canvas,{onContextLost:e=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:e=>console.log("WebGL context restored")},i);if(!o)throw new Error("WebGL context creation failed");if(r=o.device,r){if(e._reuseDevices)return s.R.log(1,`Not creating a new Device, instead returning a reference to Device ${r.id} already attached to WebGL context`,r)(),r._reused=!0,r;throw new Error(`WebGL context already attached to device ${r.id}`)}this.handle=o,this.gl=o,this.spectorJS=(0,J.k2)({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=v(this.gl,this._extensions),this.limits=new H(this.gl),this.features=new W(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),!1!==t.autoResize&&this.canvasContext.resize();new A(this.gl,{log:(...e)=>s.R.log(1,...e)()}).trackState(this.gl,{copyState:!1});const a=e.debugWebGL||e.debug,c=e.debugWebGL;a&&(this.gl=(0,ee.l)(this.gl,{debugWebGL:a,traceWebGL:c}),s.R.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(s.R.level=Math.max(s.R.level,1)))}destroy(){this.props._reuseDevices||this._reused||delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const t=this._normalizeBufferProps(e);return new se(this,t)}createTexture(e){return new Ie(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new be(this,e)}createShader(e){return new ae(this,e)}createFramebuffer(e){return new Z(this,e)}createVertexArray(e){return new at(this,e)}createTransformFeedback(e){return new ut(this,e)}createQuerySet(e){return new dt(this,e)}createRenderPipeline(e){return new ze(this,e)}beginRenderPass(e){return new Me(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(e={}){return new tt(this,e)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(e,t){return xe(e,t)}readPixelsToBufferWebGL(e,t){return function(e,t){const{target:r,sourceX:n=0,sourceY:s=0,sourceFormat:i=6408,targetByteOffset:o=0}=t||{};let{sourceWidth:a,sourceHeight:c,sourceType:u}=t||{};const{framebuffer:l,deleteFramebuffer:h}=Ce(e);a=a||l.width,c=c||l.height;const d=l;u=u||5121;let f=r;if(!f){const e=o+a*c*Ae(i)*function(e){switch(e){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}(u);f=d.device.createBuffer({byteLength:e})}const _=e.device.createCommandEncoder();return _.copyTextureToBuffer({sourceTexture:e,width:a,height:c,origin:[n,s],destinationBuffer:f,byteOffset:o}),_.destroy(),h&&l.destroy(),f}(e,t)}setParametersWebGL(e){b(this.gl,e)}getParametersWebGL(e){return T(this.gl,e)}withParametersWebGL(e,t){return Re(this.gl,e,t)}resetWebGL(){s.R.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),b(this.gl,i)}_getDeviceSpecificTextureFormatCapabilities(e){return function(e,t,r){let n=t.create;const s=k[t.format];return void 0===s?.gl&&(n=!1),s?.x&&(n=n&&Boolean(w(e,s.x,r))),{format:t.format,create:n&&t.create,render:n&&t.render,filter:n&&t.filter,blend:n&&t.blend,store:n&&t.store}}(this.gl,e,this._extensions)}loseDevice(){let e=!1;const t=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return t&&(e=!0,t.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){A.get(this.gl).push()}popState(){A.get(this.gl).pop()}setSpectorMetadata(e,t){e.__SPECTOR_Metadata=t}getGLKey(e,t){const r=Number(e);for(const n in this.gl)if(this.gl[n]===r)return`GL.${n}`;return t?.emptyIfUnknown?"":String(e)}getGLKeys(e){const t={emptyIfUnknown:!0};return Object.entries(e).reduce(((e,[r,n])=>(e[`${r}:${this.getGLKey(r,t)}`]=`${n}:${this.getGLKey(n,t)}`,e)),{})}_constants;setConstantAttributeWebGL(e,t){const r=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(r).fill(null);const n=this._constants[e];switch(n&&function(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(n,t)&&s.R.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=t,t.constructor){case Float32Array:!function(e,t,r){switch(r.length){case 1:e.gl.vertexAttrib1fv(t,r);break;case 2:e.gl.vertexAttrib2fv(t,r);break;case 3:e.gl.vertexAttrib3fv(t,r);break;case 4:e.gl.vertexAttrib4fv(t,r)}}(this,e,t);break;case Int32Array:!function(e,t,r){e.gl.vertexAttribI4iv(t,r)}(this,e,t);break;case Uint32Array:!function(e,t,r){e.gl.vertexAttribI4uiv(t,r)}(this,e,t);break;default:throw new Error("constant")}}getExtension(e){return w(this.gl,e,this._extensions),this._extensions}}},25299:(e,t,r)=>{r.d(t,{_G:()=>u,ic:()=>c,k2:()=>l});var n=r(29651),s=r(32077);const i=1;let o=null,a=!1;const c={debugSpectorJS:n.R.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function u(e){if(!globalThis.SPECTOR)try{await(0,s.k)(e.debugSpectorJSUrl||c.debugSpectorJSUrl)}catch(t){n.R.warn(String(t))}}function l(e){if(!(e={...c,...e}).debugSpectorJS)return null;if(!o&&globalThis.SPECTOR&&!globalThis.luma?.spector){n.R.probe(i,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;o=new e,globalThis.luma&&(globalThis.luma.spector=o)}if(!o)return null;if(a||(a=!0,o.spyCanvases(),o?.onCaptureStarted.add((e=>n.R.info("Spector capture started:",e)())),o?.onCapture.add((e=>{n.R.info("Spector capture complete:",e)(),o?.getResultUI(),o?.resultView.display(),o?.resultView.addCapture(e)}))),e.gl){const t=e.gl,r=t.device;o?.startCapture(e.gl,500),t.device=r,new Promise((e=>setTimeout(e,2e3))).then((e=>{n.R.info("Spector capture stopped after 2 seconds")(),o?.stopCapture()}))}return o}},67483:(e,t,r)=>{r.d(t,{$:()=>u,l:()=>l});var n=r(29651),s=r(91858),i=r(74003),o=r(32077);const a="https://unpkg.com/webgl-debug@2.0.1/index.js";function c(e){return e.luma=e.luma||{},e.luma}async function u(){(0,i.B)()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await(0,o.k)(a))}function l(e,t={}){return t.debugWebGL||t.traceWebGL?function(e,t){if(!globalThis.WebGLDebugUtils)return n.R.warn("webgl-debug not loaded")(),e;const r=c(e);if(r.debugContext)return r.debugContext;globalThis.WebGLDebugUtils.init({...s.GL,...e});const i=globalThis.WebGLDebugUtils.makeDebugContext(e,d.bind(null,t),f.bind(null,t));for(const n in s.GL)n in i||"number"!=typeof s.GL[n]||(i[n]=s.GL[n]);class o{}Object.setPrototypeOf(i,Object.getPrototypeOf(e)),Object.setPrototypeOf(o,i);const a=Object.create(o);return r.realContext=e,r.debugContext=a,a.debug=!0,a}(e,t):function(e){const t=c(e);return t.realContext?t.realContext:e}(e)}function h(e,t){t=Array.from(t).map((e=>void 0===e?"undefined":e));let r=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return r=`${r.slice(0,100)}${r.length>100?"...":""}`,`gl.${e}(${r})`}function d(e,t,r,s){s=Array.from(s).map((e=>void 0===e?"undefined":e));const i=`${globalThis.WebGLDebugUtils.glEnumToString(t)} in gl.${r}(${globalThis.WebGLDebugUtils.glFunctionArgsToString(r,s)})`;n.R.error(i)()}function f(e,t,r){let s="";n.R.level>=1&&(s=h(t,r),e.traceWebGL&&n.R.log(1,s)());for(const n of r)void 0===n&&(s=s||h(t,r))}},32077:(e,t,r)=>{async function n(e,t){const r=document.getElementsByTagName("head")[0];if(!r)throw new Error("loadScript");const n=document.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src",e),t&&(n.id=t),new Promise(((t,s)=>{n.onload=t,n.onerror=t=>s(new Error(`Unable to load script '${e}': ${t}`)),r.appendChild(n)}))}r.d(t,{k:()=>n})},58073:(e,t,r)=>{r.d(t,{a:()=>s});var n=r(54901);class s extends Array{clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+t];return this.check()}toArray(e=[],t=0){for(let r=0;r<this.ELEMENTS;++r)e[t+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:(0,n.cy)(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(n.$W)}formatString(e){let t="";for(let r=0;r<this.ELEMENTS;++r)t+=(r>0?", ":"")+(0,n.Fl)(this[r],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!(0,n.aI)(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,r){if(void 0===r)return this.lerp(this,e,t);for(let n=0;n<this.ELEMENTS;++n){const s=e[n],i="number"==typeof t?t:t[n];this[n]=s+r*(i-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),t[r]);return this.check()}add(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]+=t[e];return this.check()}subtract(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]-=t[e];return this.check()}scale(e){if("number"==typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(n.$W.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),t);return this.check()}get elements(){return this}}},46022:(e,t,r)=>{r.d(t,{u:()=>o});var n=r(58073),s=r(73731),i=r(54901);class o extends n.a{toString(){let e="[";if(i.$W.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,r){return this[t*this.RANK+e]=(0,s.ws)(r),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let n=0;n<this.RANK;++n)t[n]=this[r+n];return t}setColumn(e,t){const r=e*this.RANK;for(let n=0;n<this.RANK;++n)this[r+n]=t[n];return this}}},54272:(e,t,r)=>{r.d(t,{M:()=>o});var n=r(58073),s=r(73731),i=r(4990);class o extends n.a{get x(){return this[0]}set x(e){this[0]=(0,s.ws)(e)}get y(){return this[1]}set y(e){this[1]=(0,s.ws)(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let r=0;r<this.ELEMENTS;++r){const n=this[r]-e[r];t+=n*n}return(0,s.ws)(t)}dot(e){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*e[r];return(0,s.ws)(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t[e];return this.check()}divide(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return(0,i.v)(e>=0&&e<this.ELEMENTS,"index is out of range"),(0,s.ws)(this[e])}setComponent(e,t){return(0,i.v)(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}},31886:(e,t,r)=>{r.d(t,{k:()=>g});var n,s=r(46022),i=r(73731),o=r(68225),a=r(90218),c=r(83588),u=r(82859),l=r(39426);!function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"}(n||(n={}));const h=45*Math.PI/180,d=1,f=.1,_=500,p=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class g extends s.u{static get IDENTITY(){return function(){E||(E=new g,Object.freeze(E));return E}()}static get ZERO(){return function(){m||(m=new g([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(m));return m}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return n}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,r,n,s,i,o,a,c,u,l,h,d,f,_,p){return this[0]=e,this[1]=t,this[2]=r,this[3]=n,this[4]=s,this[5]=i,this[6]=o,this[7]=a,this[8]=c,this[9]=u,this[10]=l,this[11]=h,this[12]=d,this[13]=f,this[14]=_,this[15]=p,this.check()}setRowMajor(e,t,r,n,s,i,o,a,c,u,l,h,d,f,_,p){return this[0]=e,this[1]=s,this[2]=c,this[3]=d,this[4]=t,this[5]=i,this[6]=u,this[7]=f,this[8]=r,this[9]=o,this[10]=l,this[11]=_,this[12]=n,this[13]=a,this[14]=h,this[15]=p,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(p)}fromObject(e){return this.check()}fromQuaternion(e){return(0,a.I0)(this,e),this.check()}frustum(e){const{left:t,right:r,bottom:n,top:s,near:i=f,far:o=_}=e;return o===1/0?function(e,t,r,n,s,i){const o=2*i/(r-t),a=2*i/(s-n),c=(r+t)/(r-t),u=(s+n)/(s-n),l=-1,h=-1,d=-2*i;e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=c,e[9]=u,e[10]=l,e[11]=h,e[12]=0,e[13]=0,e[14]=d,e[15]=0}(this,t,r,n,s,i):(0,a.$h)(this,t,r,n,s,i,o),this.check()}lookAt(e){const{eye:t,center:r=[0,0,0],up:n=[0,1,0]}=e;return(0,a.t5)(this,t,r,n),this.check()}ortho(e){const{left:t,right:r,bottom:n,top:s,near:i=f,far:o=_}=e;return(0,a.v3)(this,t,r,n,s,i,o),this.check()}orthographic(e){const{fovy:t=h,aspect:r=d,focalDistance:n=1,near:s=f,far:i=_}=e;b(t);const o=t/2,a=n*Math.tan(o),c=a*r;return this.ortho({left:-c,right:c,bottom:-a,top:a,near:s,far:i})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:r=1,near:n=.1,far:s=500}=e;return b(t),(0,a.fN)(this,t,r,n,s),this.check()}determinant(){return(0,a.a4)(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const r=this.getScale(t),n=1/r[0],s=1/r[1],i=1/r[2];return e[0]=this[0]*n,e[1]=this[1]*s,e[2]=this[2]*i,e[3]=0,e[4]=this[4]*n,e[5]=this[5]*s,e[6]=this[6]*i,e[7]=0,e[8]=this[8]*n,e[9]=this[9]*s,e[10]=this[10]*i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const r=this.getScale(t),n=1/r[0],s=1/r[1],i=1/r[2];return e[0]=this[0]*n,e[1]=this[1]*s,e[2]=this[2]*i,e[3]=this[4]*n,e[4]=this[5]*s,e[5]=this[6]*i,e[6]=this[8]*n,e[7]=this[9]*s,e[8]=this[10]*i,e}transpose(){return(0,a.mg)(this,this),this.check()}invert(){return(0,a.B8)(this,this),this.check()}multiplyLeft(e){return(0,a.lw)(this,e,this),this.check()}multiplyRight(e){return(0,a.lw)(this,this,e),this.check()}rotateX(e){return(0,a.eL)(this,this,e),this.check()}rotateY(e){return(0,a.Z8)(this,this,e),this.check()}rotateZ(e){return(0,a.Qr)(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return(0,a.e$)(this,this,e,t),this.check()}scale(e){return(0,a.hs)(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return(0,a.Tl)(this,this,e),this.check()}transform(e,t){return 4===e.length?(t=(0,l.Z0)(t||[-0,-0,-0,-0],e,this),(0,i.qk)(t,4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:r}=e;let n;switch(r){case 2:n=(0,c.Z0)(t||[-0,-0],e,this);break;case 3:n=(0,u.Z0)(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return(0,i.qk)(n,e.length),n}transformAsVector(e,t){let r;switch(e.length){case 2:r=(0,o.B$)(t||[-0,-0],e,this);break;case 3:r=(0,o.cL)(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return(0,i.qk)(r,e.length),r}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,r){return this.identity().translate([e,t,r])}}let m,E;function b(e){if(e>2*Math.PI)throw Error("expected radians")}},87597:(e,t,r)=>{r.d(t,{P:()=>l});var n=r(54272),s=r(54901),i=r(73731),o=r(82859),a=r(68225);const c=[0,0,0];let u;class l extends n.M{static get ZERO(){return u||(u=new l(0,0,0),Object.freeze(u)),u}constructor(e=0,t=0,r=0){super(-0,-0,-0),1===arguments.length&&(0,s.cy)(e)?this.copy(e):(s.$W.debug&&((0,i.ws)(e),(0,i.ws)(t),(0,i.ws)(r)),this[0]=e,this[1]=t,this[2]=r)}set(e,t,r){return this[0]=e,this[1]=t,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return s.$W.debug&&((0,i.ws)(e.x),(0,i.ws)(e.y),(0,i.ws)(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=(0,i.ws)(e)}angle(e){return(0,o.g7)(this,e)}cross(e){return(0,o.$A)(this,this,e),this.check()}rotateX({radians:e,origin:t=c}){return(0,o.eL)(this,this,t,e),this.check()}rotateY({radians:e,origin:t=c}){return(0,o.Z8)(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=c}){return(0,o.x6)(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return(0,o.Z0)(this,this,e),this.check()}transformAsVector(e){return(0,a.cL)(this,this,e),this.check()}transformByMatrix3(e){return(0,o.ei)(this,this,e),this.check()}transformByMatrix2(e){return(0,a.J4)(this,this,e),this.check()}transformByQuaternion(e){return(0,o.gL)(this,this,e),this.check()}}},50741:(e,t,r)=>{r.d(t,{p8:()=>n,tb:()=>s});const n=1e-6;let s="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI},90218:(e,t,r)=>{r.d(t,{$h:()=>g,B8:()=>i,I0:()=>p,IL:()=>_,Qr:()=>f,Tl:()=>c,Z8:()=>d,a4:()=>o,e$:()=>l,eL:()=>h,fN:()=>m,hs:()=>u,lw:()=>a,mg:()=>s,t5:()=>b,v3:()=>E});var n=r(50741);function s(e,t){if(e===t){const r=t[1],n=t[2],s=t[3],i=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=i,e[11]=t[14],e[12]=s,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function i(e,t){const r=t[0],n=t[1],s=t[2],i=t[3],o=t[4],a=t[5],c=t[6],u=t[7],l=t[8],h=t[9],d=t[10],f=t[11],_=t[12],p=t[13],g=t[14],m=t[15],E=r*a-n*o,b=r*c-s*o,T=r*u-i*o,y=n*c-s*a,A=n*u-i*a,R=s*u-i*c,S=l*p-h*_,w=l*g-d*_,v=l*m-f*_,x=h*g-d*p,C=h*m-f*p,N=d*m-f*g;let I=E*N-b*C+T*x+y*v-A*w+R*S;return I?(I=1/I,e[0]=(a*N-c*C+u*x)*I,e[1]=(s*C-n*N-i*x)*I,e[2]=(p*R-g*A+m*y)*I,e[3]=(d*A-h*R-f*y)*I,e[4]=(c*v-o*N-u*w)*I,e[5]=(r*N-s*v+i*w)*I,e[6]=(g*T-_*R-m*b)*I,e[7]=(l*R-d*T+f*b)*I,e[8]=(o*C-a*v+u*S)*I,e[9]=(n*v-r*C-i*S)*I,e[10]=(_*A-p*T+m*E)*I,e[11]=(h*T-l*A-f*E)*I,e[12]=(a*w-o*x-c*S)*I,e[13]=(r*x-n*w+s*S)*I,e[14]=(p*b-_*y-g*E)*I,e[15]=(l*y-h*b+d*E)*I,e):null}function o(e){const t=e[0],r=e[1],n=e[2],s=e[3],i=e[4],o=e[5],a=e[6],c=e[7],u=e[8],l=e[9],h=e[10],d=e[11],f=e[12],_=e[13],p=e[14],g=t*o-r*i,m=t*a-n*i,E=r*a-n*o,b=u*_-l*f,T=u*p-h*f,y=l*p-h*_;return c*(t*y-r*T+n*b)-s*(i*y-o*T+a*b)+e[15]*(u*E-l*m+h*g)-d*(f*E-_*m+p*g)}function a(e,t,r){const n=t[0],s=t[1],i=t[2],o=t[3],a=t[4],c=t[5],u=t[6],l=t[7],h=t[8],d=t[9],f=t[10],_=t[11],p=t[12],g=t[13],m=t[14],E=t[15];let b=r[0],T=r[1],y=r[2],A=r[3];return e[0]=b*n+T*a+y*h+A*p,e[1]=b*s+T*c+y*d+A*g,e[2]=b*i+T*u+y*f+A*m,e[3]=b*o+T*l+y*_+A*E,b=r[4],T=r[5],y=r[6],A=r[7],e[4]=b*n+T*a+y*h+A*p,e[5]=b*s+T*c+y*d+A*g,e[6]=b*i+T*u+y*f+A*m,e[7]=b*o+T*l+y*_+A*E,b=r[8],T=r[9],y=r[10],A=r[11],e[8]=b*n+T*a+y*h+A*p,e[9]=b*s+T*c+y*d+A*g,e[10]=b*i+T*u+y*f+A*m,e[11]=b*o+T*l+y*_+A*E,b=r[12],T=r[13],y=r[14],A=r[15],e[12]=b*n+T*a+y*h+A*p,e[13]=b*s+T*c+y*d+A*g,e[14]=b*i+T*u+y*f+A*m,e[15]=b*o+T*l+y*_+A*E,e}function c(e,t,r){const n=r[0],s=r[1],i=r[2];let o,a,c,u,l,h,d,f,_,p,g,m;return t===e?(e[12]=t[0]*n+t[4]*s+t[8]*i+t[12],e[13]=t[1]*n+t[5]*s+t[9]*i+t[13],e[14]=t[2]*n+t[6]*s+t[10]*i+t[14],e[15]=t[3]*n+t[7]*s+t[11]*i+t[15]):(o=t[0],a=t[1],c=t[2],u=t[3],l=t[4],h=t[5],d=t[6],f=t[7],_=t[8],p=t[9],g=t[10],m=t[11],e[0]=o,e[1]=a,e[2]=c,e[3]=u,e[4]=l,e[5]=h,e[6]=d,e[7]=f,e[8]=_,e[9]=p,e[10]=g,e[11]=m,e[12]=o*n+l*s+_*i+t[12],e[13]=a*n+h*s+p*i+t[13],e[14]=c*n+d*s+g*i+t[14],e[15]=u*n+f*s+m*i+t[15]),e}function u(e,t,r){const n=r[0],s=r[1],i=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function l(e,t,r,s){let i,o,a,c,u,l,h,d,f,_,p,g,m,E,b,T,y,A,R,S,w,v,x,C,N=s[0],I=s[1],L=s[2],O=Math.sqrt(N*N+I*I+L*L);return O<n.p8?null:(O=1/O,N*=O,I*=O,L*=O,o=Math.sin(r),i=Math.cos(r),a=1-i,c=t[0],u=t[1],l=t[2],h=t[3],d=t[4],f=t[5],_=t[6],p=t[7],g=t[8],m=t[9],E=t[10],b=t[11],T=N*N*a+i,y=I*N*a+L*o,A=L*N*a-I*o,R=N*I*a-L*o,S=I*I*a+i,w=L*I*a+N*o,v=N*L*a+I*o,x=I*L*a-N*o,C=L*L*a+i,e[0]=c*T+d*y+g*A,e[1]=u*T+f*y+m*A,e[2]=l*T+_*y+E*A,e[3]=h*T+p*y+b*A,e[4]=c*R+d*S+g*w,e[5]=u*R+f*S+m*w,e[6]=l*R+_*S+E*w,e[7]=h*R+p*S+b*w,e[8]=c*v+d*x+g*C,e[9]=u*v+f*x+m*C,e[10]=l*v+_*x+E*C,e[11]=h*v+p*x+b*C,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function h(e,t,r){const n=Math.sin(r),s=Math.cos(r),i=t[4],o=t[5],a=t[6],c=t[7],u=t[8],l=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*s+u*n,e[5]=o*s+l*n,e[6]=a*s+h*n,e[7]=c*s+d*n,e[8]=u*s-i*n,e[9]=l*s-o*n,e[10]=h*s-a*n,e[11]=d*s-c*n,e}function d(e,t,r){const n=Math.sin(r),s=Math.cos(r),i=t[0],o=t[1],a=t[2],c=t[3],u=t[8],l=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*s-u*n,e[1]=o*s-l*n,e[2]=a*s-h*n,e[3]=c*s-d*n,e[8]=i*n+u*s,e[9]=o*n+l*s,e[10]=a*n+h*s,e[11]=c*n+d*s,e}function f(e,t,r){const n=Math.sin(r),s=Math.cos(r),i=t[0],o=t[1],a=t[2],c=t[3],u=t[4],l=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*s+u*n,e[1]=o*s+l*n,e[2]=a*s+h*n,e[3]=c*s+d*n,e[4]=u*s-i*n,e[5]=l*s-o*n,e[6]=h*s-a*n,e[7]=d*s-c*n,e}function _(e,t){const r=t[0],n=t[1],s=t[2],i=t[4],o=t[5],a=t[6],c=t[8],u=t[9],l=t[10];return e[0]=Math.sqrt(r*r+n*n+s*s),e[1]=Math.sqrt(i*i+o*o+a*a),e[2]=Math.sqrt(c*c+u*u+l*l),e}function p(e,t){const r=t[0],n=t[1],s=t[2],i=t[3],o=r+r,a=n+n,c=s+s,u=r*o,l=n*o,h=n*a,d=s*o,f=s*a,_=s*c,p=i*o,g=i*a,m=i*c;return e[0]=1-h-_,e[1]=l+m,e[2]=d-g,e[3]=0,e[4]=l-m,e[5]=1-u-_,e[6]=f+p,e[7]=0,e[8]=d+g,e[9]=f-p,e[10]=1-u-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function g(e,t,r,n,s,i,o){const a=1/(r-t),c=1/(s-n),u=1/(i-o);return e[0]=2*i*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*i*c,e[6]=0,e[7]=0,e[8]=(r+t)*a,e[9]=(s+n)*c,e[10]=(o+i)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*i*2*u,e[15]=0,e}const m=function(e,t,r,n,s){const i=1/Math.tan(t/2);if(e[0]=i/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=s&&s!==1/0){const t=1/(n-s);e[10]=(s+n)*t,e[14]=2*s*n*t}else e[10]=-1,e[14]=-2*n;return e};const E=function(e,t,r,n,s,i,o){const a=1/(t-r),c=1/(n-s),u=1/(i-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*a,e[13]=(s+n)*c,e[14]=(o+i)*u,e[15]=1,e};function b(e,t,r,s){let i,o,a,c,u,l,h,d,f,_;const p=t[0],g=t[1],m=t[2],E=s[0],b=s[1],T=s[2],y=r[0],A=r[1],R=r[2];return Math.abs(p-y)<n.p8&&Math.abs(g-A)<n.p8&&Math.abs(m-R)<n.p8?function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}(e):(d=p-y,f=g-A,_=m-R,i=1/Math.sqrt(d*d+f*f+_*_),d*=i,f*=i,_*=i,o=b*_-T*f,a=T*d-E*_,c=E*f-b*d,i=Math.sqrt(o*o+a*a+c*c),i?(i=1/i,o*=i,a*=i,c*=i):(o=0,a=0,c=0),u=f*c-_*a,l=_*o-d*c,h=d*a-f*o,i=Math.sqrt(u*u+l*l+h*h),i?(i=1/i,u*=i,l*=i,h*=i):(u=0,l=0,h=0),e[0]=o,e[1]=u,e[2]=d,e[3]=0,e[4]=a,e[5]=l,e[6]=f,e[7]=0,e[8]=c,e[9]=h,e[10]=_,e[11]=0,e[12]=-(o*p+a*g+c*m),e[13]=-(u*p+l*g+h*m),e[14]=-(d*p+f*g+_*m),e[15]=1,e)}},83588:(e,t,r)=>{r.d(t,{Bw:()=>o,Cc:()=>c,WQ:()=>s,Z0:()=>d,ZF:()=>u,ei:()=>h,hs:()=>i,jb:()=>f,l0:()=>l,ze:()=>a});var n=r(50741);function s(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function i(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function o(e){const t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function a(e,t){return e[0]=-t[0],e[1]=-t[1],e}function c(e,t,r,n){const s=t[0],i=t[1];return e[0]=s+n*(r[0]-s),e[1]=i+n*(r[1]-i),e}function u(e,t,r){const n=t[0],s=t[1];return e[0]=r[0]*n+r[2]*s,e[1]=r[1]*n+r[3]*s,e}function l(e,t,r){const n=t[0],s=t[1];return e[0]=r[0]*n+r[2]*s+r[4],e[1]=r[1]*n+r[3]*s+r[5],e}function h(e,t,r){const n=t[0],s=t[1];return e[0]=r[0]*n+r[3]*s+r[6],e[1]=r[1]*n+r[4]*s+r[7],e}function d(e,t,r){const n=t[0],s=t[1];return e[0]=r[0]*n+r[4]*s+r[12],e[1]=r[1]*n+r[5]*s+r[13],e}const f=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e};!function(){const e=function(){const e=new n.tb(2);return n.tb!=Float32Array&&(e[0]=0,e[1]=0),e}()}()},82859:(e,t,r)=>{r.d(t,{$A:()=>l,Bw:()=>i,Cc:()=>h,Il:()=>T,Om:()=>u,S8:()=>c,Z0:()=>d,Z8:()=>g,eL:()=>p,ei:()=>f,fA:()=>o,g7:()=>E,gL:()=>_,jb:()=>b,uE:()=>y,vt:()=>s,x6:()=>m,ze:()=>a});var n=r(50741);function s(){const e=new n.tb(3);return n.tb!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function i(e){const t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function o(e,t,r){const s=new n.tb(3);return s[0]=e,s[1]=t,s[2]=r,s}function a(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function c(e,t){const r=t[0],n=t[1],s=t[2];let i=r*r+n*n+s*s;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e}function u(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function l(e,t,r){const n=t[0],s=t[1],i=t[2],o=r[0],a=r[1],c=r[2];return e[0]=s*c-i*a,e[1]=i*o-n*c,e[2]=n*a-s*o,e}function h(e,t,r,n){const s=t[0],i=t[1],o=t[2];return e[0]=s+n*(r[0]-s),e[1]=i+n*(r[1]-i),e[2]=o+n*(r[2]-o),e}function d(e,t,r){const n=t[0],s=t[1],i=t[2];let o=r[3]*n+r[7]*s+r[11]*i+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*s+r[8]*i+r[12])/o,e[1]=(r[1]*n+r[5]*s+r[9]*i+r[13])/o,e[2]=(r[2]*n+r[6]*s+r[10]*i+r[14])/o,e}function f(e,t,r){const n=t[0],s=t[1],i=t[2];return e[0]=n*r[0]+s*r[3]+i*r[6],e[1]=n*r[1]+s*r[4]+i*r[7],e[2]=n*r[2]+s*r[5]+i*r[8],e}function _(e,t,r){const n=r[0],s=r[1],i=r[2],o=r[3],a=t[0],c=t[1],u=t[2];let l=s*u-i*c,h=i*a-n*u,d=n*c-s*a,f=s*d-i*h,_=i*l-n*d,p=n*h-s*l;const g=2*o;return l*=g,h*=g,d*=g,f*=2,_*=2,p*=2,e[0]=a+l+f,e[1]=c+h+_,e[2]=u+d+p,e}function p(e,t,r,n){const s=[],i=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],i[0]=s[0],i[1]=s[1]*Math.cos(n)-s[2]*Math.sin(n),i[2]=s[1]*Math.sin(n)+s[2]*Math.cos(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e}function g(e,t,r,n){const s=[],i=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],i[0]=s[2]*Math.sin(n)+s[0]*Math.cos(n),i[1]=s[1],i[2]=s[2]*Math.cos(n)-s[0]*Math.sin(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e}function m(e,t,r,n){const s=[],i=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],i[0]=s[0]*Math.cos(n)-s[1]*Math.sin(n),i[1]=s[0]*Math.sin(n)+s[1]*Math.cos(n),i[2]=s[2],e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e}function E(e,t){const r=e[0],n=e[1],s=e[2],i=t[0],o=t[1],a=t[2],c=Math.sqrt((r*r+n*n+s*s)*(i*i+o*o+a*a)),l=c&&u(e,t)/c;return Math.acos(Math.min(Math.max(l,-1),1))}const b=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},T=i,y=function(e){const t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n};!function(){const e=s()}()},39426:(e,t,r)=>{r.d(t,{Bw:()=>l,C:()=>o,Cc:()=>_,Om:()=>f,S8:()=>d,WQ:()=>c,Z0:()=>p,fA:()=>i,gL:()=>g,hZ:()=>a,hs:()=>u,m3:()=>h,o8:()=>s,t2:()=>m});var n=r(50741);function s(e){const t=new n.tb(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function i(e,t,r,s){const i=new n.tb(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=s,i}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function a(e,t,r,n,s){return e[0]=t,e[1]=r,e[2]=n,e[3]=s,e}function c(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function u(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function l(e){const t=e[0],r=e[1],n=e[2],s=e[3];return Math.sqrt(t*t+r*r+n*n+s*s)}function h(e){const t=e[0],r=e[1],n=e[2],s=e[3];return t*t+r*r+n*n+s*s}function d(e,t){const r=t[0],n=t[1],s=t[2],i=t[3];let o=r*r+n*n+s*s+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=r*o,e[1]=n*o,e[2]=s*o,e[3]=i*o,e}function f(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function _(e,t,r,n){const s=t[0],i=t[1],o=t[2],a=t[3];return e[0]=s+n*(r[0]-s),e[1]=i+n*(r[1]-i),e[2]=o+n*(r[2]-o),e[3]=a+n*(r[3]-a),e}function p(e,t,r){const n=t[0],s=t[1],i=t[2],o=t[3];return e[0]=r[0]*n+r[4]*s+r[8]*i+r[12]*o,e[1]=r[1]*n+r[5]*s+r[9]*i+r[13]*o,e[2]=r[2]*n+r[6]*s+r[10]*i+r[14]*o,e[3]=r[3]*n+r[7]*s+r[11]*i+r[15]*o,e}function g(e,t,r){const n=t[0],s=t[1],i=t[2],o=r[0],a=r[1],c=r[2],u=r[3],l=u*n+a*i-c*s,h=u*s+c*n-o*i,d=u*i+o*s-a*n,f=-o*n-a*s-c*i;return e[0]=l*u+f*-o+h*-c-d*-a,e[1]=h*u+f*-a+d*-o-l*-c,e[2]=d*u+f*-c+l*-a-h*-o,e[3]=t[3],e}function m(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}!function(){const e=function(){const e=new n.tb(4);return n.tb!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}()},4990:(e,t,r)=>{function n(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}r.d(t,{v:()=>n})},54901:(e,t,r)=>{r.d(t,{$W:()=>i,Cc:()=>f,F2:()=>l,Fl:()=>o,aI:()=>_,cy:()=>a,eh:()=>c,qE:()=>d,uj:()=>h,xW:()=>u});const n=1/Math.PI*180,s=1/180*Math.PI;globalThis.mathgl=globalThis.mathgl||{config:{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1}};const i=globalThis.mathgl.config;function o(e,{precision:t=i.precision}={}){return e=function(e){return Math.round(e/i.EPSILON)*i.EPSILON}(e),`${parseFloat(e.toPrecision(t))}`}function a(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function c(e){return l(e)}function u(e){return h(e)}function l(e,t){return p(e,(e=>e*s),t)}function h(e,t){return p(e,(e=>e*n),t)}function d(e,t,r){return p(e,(e=>Math.max(t,Math.min(r,e))))}function f(e,t,r){return a(e)?e.map(((e,n)=>f(e,t[n],r))):r*t+(1-r)*e}function _(e,t,r){const n=i.EPSILON;r&&(i.EPSILON=r);try{if(e===t)return!0;if(a(e)&&a(t)){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(!_(e[r],t[r]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):"number"==typeof e&&"number"==typeof t&&Math.abs(e-t)<=i.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{i.EPSILON=n}}function p(e,t,r){if(a(e)){const n=e;r=r||function(e){return e.clone?e.clone():new Array(e.length)}(n);for(let s=0;s<r.length&&s<n.length;++s){const n="number"==typeof e?e:e[s];r[s]=t(n,s,r)}return r}return t(e)}},68225:(e,t,r)=>{function n(e,t,r){const n=t[0],s=t[1],i=r[3]*n+r[7]*s||1;return e[0]=(r[0]*n+r[4]*s)/i,e[1]=(r[1]*n+r[5]*s)/i,e}function s(e,t,r){const n=t[0],s=t[1],i=t[2],o=r[3]*n+r[7]*s+r[11]*i||1;return e[0]=(r[0]*n+r[4]*s+r[8]*i)/o,e[1]=(r[1]*n+r[5]*s+r[9]*i)/o,e[2]=(r[2]*n+r[6]*s+r[10]*i)/o,e}function i(e,t,r){const n=t[0],s=t[1];return e[0]=r[0]*n+r[2]*s,e[1]=r[1]*n+r[3]*s,e[2]=t[2],e}function o(e,t,r){const n=t[0],s=t[1];return e[0]=r[0]*n+r[2]*s,e[1]=r[1]*n+r[3]*s,e[2]=t[2],e[3]=t[3],e}function a(e,t,r){const n=t[0],s=t[1],i=t[2];return e[0]=r[0]*n+r[3]*s+r[6]*i,e[1]=r[1]*n+r[4]*s+r[7]*i,e[2]=r[2]*n+r[5]*s+r[8]*i,e[3]=t[3],e}r.d(t,{B$:()=>n,Cg:()=>o,J4:()=>i,cL:()=>s,vE:()=>a})},73731:(e,t,r)=>{r.d(t,{qk:()=>i,ws:()=>s});var n=r(54901);function s(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function i(e,t,r=""){if(n.$W.debug&&!function(e,t){if(e.length!==t)return!1;for(let r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}(e,t))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return e}},76282:(e,t,r)=>{function n(e){return function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)||function(e){return!!Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}(e)}r.d(t,{H9:()=>n})},24697:(e,t,r)=>{r.d(t,{aH:()=>E,dT:()=>x,Os:()=>I,Fe:()=>P,rj:()=>X,wZ:()=>L,gW:()=>B,nI:()=>v,v7:()=>V,fO:()=>S,om:()=>N,rY:()=>C,Gw:()=>A,CK:()=>U,xJ:()=>M,mY:()=>w,iV:()=>R,VJ:()=>O});var n=r(39426);function s(e,t){const r=n.Z0([],t,e);return n.hs(r,r,1/r[3]),r}function i(e,t){const r=e%t;return r<0?t+r:r}function o(e,t,r){return e<t?t:e>r?r:e}const a=Math.log2||function(e){return Math.log(e)*Math.LOG2E};var c=r(90218),u=r(82859),l=r(83588);function h(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}const d=Math.PI,f=d/4,_=d/180,p=180/d,g=512,m=4003e4,E=85.051129,b=1.5;function T(e){return Math.pow(2,e)}function y(e){return a(e)}function A(e){const[t,r]=e;h(Number.isFinite(t)),h(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");const n=r*_;return[g*(t*_+d)/(2*d),g*(d+Math.log(Math.tan(f+.5*n)))/(2*d)]}function R(e){const[t,r]=e,n=t/g*(2*d)-d,s=2*(Math.atan(Math.exp(r/g*(2*d)-d))-f);return[n*p,s*p]}function S(e){const{latitude:t}=e;h(Number.isFinite(t));const r=Math.cos(t*_);return y(m*r)-9}function w(e){const t=Math.cos(e*_);return g/m/t}function v(e){const{latitude:t,longitude:r,highPrecision:n=!1}=e;h(Number.isFinite(t)&&Number.isFinite(r));const s=g,i=Math.cos(t*_),o=s/360,a=o/i,c=s/m/i,u={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[o,a,c],degreesPerUnit:[1/o,1/a,1/c]};if(n){const e=_*Math.tan(t*_)/i,r=o*e/2,n=s/m*e,l=n/a*c;u.unitsPerDegree2=[0,r,n],u.unitsPerMeter2=[l,0,l]}return u}function x(e,t){const[r,n,s]=e,[i,o,a]=t,{unitsPerMeter:c,unitsPerMeter2:u}=v({longitude:r,latitude:n,highPrecision:!0}),l=A(e);l[0]+=i*(c[0]+u[0]*o),l[1]+=o*(c[1]+u[1]*o);const h=R(l),d=(s||0)+(a||0);return Number.isFinite(s)||Number.isFinite(a)?[h[0],h[1],d]:h}function C(e){const{height:t,pitch:r,bearing:n,altitude:s,scale:i,center:o}=e,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];c.Tl(a,a,[0,0,-s]),c.eL(a,a,-r*_),c.Qr(a,a,n*_);const l=i/t;return c.hs(a,a,[l,l,l]),o&&c.Tl(a,a,u.ze([],o)),a}function N(e){const{width:t,height:r,altitude:n,pitch:s=0,offset:i,center:a,scale:c,nearZMultiplier:u=1,farZMultiplier:l=1}=e;let{fovy:h=I(b)}=e;void 0!==n&&(h=I(n));const d=h*_,f=s*_,p=L(h);let g=p;a&&(g+=a[2]*c/Math.cos(f)/r);const m=d*(.5+(i?i[1]:0)/r),E=Math.sin(m)*g/Math.sin(o(Math.PI/2-f-m,.01,Math.PI-.01)),T=Math.sin(f)*E+g,y=10*g;return{fov:d,aspect:t/r,focalDistance:p,near:u,far:Math.min(T*l,y)}}function I(e){return 2*Math.atan(.5/e)*p}function L(e){return.5/Math.tan(.5*e*_)}function O(e,t){const[r,n,i=0]=e;return h(Number.isFinite(r)&&Number.isFinite(n)&&Number.isFinite(i)),s(t,[r,n,i,1])}function M(e,t,r=0){const[n,i,o]=e;if(h(Number.isFinite(n)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(o)){return s(t,[n,i,o,1])}const a=s(t,[n,i,0,1]),c=s(t,[n,i,1,1]),u=a[2],d=c[2],f=u===d?0:((r||0)-u)/(d-u);return l.Cc([],a,c,f)}function P(e){const{width:t,height:r,bounds:n,minExtent:s=0,maxZoom:i=24,offset:c=[0,0]}=e,[[u,l],[d,f]]=n,_=function(e=0){if("number"==typeof e)return{top:e,bottom:e,left:e,right:e};return h(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e}(e.padding),p=A([u,o(f,-E,E)]),g=A([d,o(l,-E,E)]),m=[Math.max(Math.abs(g[0]-p[0]),s),Math.max(Math.abs(g[1]-p[1]),s)],b=[t-_.left-_.right-2*Math.abs(c[0]),r-_.top-_.bottom-2*Math.abs(c[1])];h(b[0]>0&&b[1]>0);const T=b[0]/m[0],y=b[1]/m[1],S=(_.right-_.left)/2/T,w=(_.top-_.bottom)/2/y,v=R([(g[0]+p[0])/2+S,(g[1]+p[1])/2+w]),x=Math.min(i,a(Math.abs(Math.min(T,y))));return h(Number.isFinite(x)),{longitude:v[0],latitude:v[1],zoom:x}}const F=Math.PI/180;function B(e,t=0){const{width:r,height:n,unproject:s}=e,i={targetZ:t},o=s([0,n],i),a=s([r,n],i);let c,u;return(e.fovy?.5*e.fovy*F:Math.atan(.5/e.altitude))>(90-e.pitch)*F-.01?(c=k(e,0,t),u=k(e,r,t)):(c=s([0,0],i),u=s([r,0],i)),[o,a,u,c]}function k(e,t,r){const{pixelUnprojectionMatrix:n}=e,i=s(n,[t,0,1,1]),o=s(n,[t,e.height,1,1]),a=(r*e.distanceScales.unitsPerMeter[2]-i[2])/(o[2]-i[2]),c=R(l.Cc([],i,o,a));return c.push(r),c}const D=512;function U(e){const{width:t,height:r,pitch:n=0}=e;let{longitude:s,latitude:o,zoom:c,bearing:u=0}=e;(s<-180||s>180)&&(s=i(s+180,360)-180),(u<-180||u>180)&&(u=i(u+180,360)-180);const l=a(r/D);if(c<=l)c=l,o=0;else{const e=r/2/Math.pow(2,c),t=R([0,e])[1];if(o<t)o=t;else{const t=R([0,D-e])[1];o>t&&(o=t)}}return{width:t,height:r,longitude:s,latitude:o,zoom:c,pitch:n,bearing:u}}const G=.01,W=["longitude","latitude","zoom"],H={curve:1.414,speed:1.2};function X(e,t,r,n){const{startZoom:s,startCenterXY:i,uDelta:o,w0:a,u1:c,S:u,rho:h,rho2:d,r0:f}=$(e,t,n);if(c<G){const n={};for(const s of W){const i=e[s],o=t[s];n[s]=(_=r)*o+(1-_)*i}return n}var _;const p=r*u,g=Math.cosh(f)/Math.cosh(f+h*p),m=a*((Math.cosh(f)*Math.tanh(f+h*p)-Math.sinh(f))/d)/c,E=s+y(1/g),b=l.hs([],o,m);l.WQ(b,b,i);const T=R(b);return{longitude:T[0],latitude:T[1],zoom:E}}function V(e,t,r){const n={...H,...r},{screenSpeed:s,speed:i,maxDuration:o}=n,{S:a,rho:c}=$(e,t,n),u=1e3*a;let l;return l=Number.isFinite(s)?u/(s/c):u/i,Number.isFinite(o)&&l>o?0:l}function $(e,t,r){const n=(r=Object.assign({},H,r)).curve,s=e.zoom,i=[e.longitude,e.latitude],o=T(s),a=t.zoom,c=[t.longitude,t.latitude],u=T(a-s),h=A(i),d=A(c),f=l.jb([],d,h),_=Math.max(e.width,e.height),p=_/u,g=l.Bw(f)*o,m=Math.max(g,G),E=n*n,b=(p*p-_*_+E*E*m*m)/(2*_*E*m),y=(p*p-_*_-E*E*m*m)/(2*p*E*m),R=Math.log(Math.sqrt(b*b+1)-b),S=Math.log(Math.sqrt(y*y+1)-y);return{startZoom:s,startCenterXY:h,uDelta:f,w0:_,u1:g,S:(S-R)/n,rho:n,rho2:E,r0:R,r1:S}}},7853:(e,t,r)=>{r.d(t,{EU:()=>re,e8:()=>s,uq:()=>k,h1:()=>U,Cx:()=>F});var n,s,i;!function(e){e[e.Start=1]="Start",e[e.Move=2]="Move",e[e.End=4]="End",e[e.Cancel=8]="Cancel"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Up=4]="Up",e[e.Down=8]="Down",e[e.Horizontal=3]="Horizontal",e[e.Vertical=12]="Vertical",e[e.All=15]="All"}(s||(s={})),function(e){e[e.Possible=1]="Possible",e[e.Began=2]="Began",e[e.Changed=4]="Changed",e[e.Ended=8]="Ended",e[e.Recognized=8]="Recognized",e[e.Cancelled=16]="Cancelled",e[e.Failed=32]="Failed"}(i||(i={}));const o="auto",a="manipulation",c="none",u="pan-x",l="pan-y";class h{constructor(e,t){this.actions="",this.manager=e,this.set(t)}set(e){"compute"===e&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const t of this.manager.recognizers)t.options.enable&&(e=e.concat(t.getTouchAction()));return function(e){if(e.includes(c))return c;const t=e.includes(u),r=e.includes(l);return t&&r?c:t||r?t?u:l:e.includes(a)?a:o}(e.join(" "))}}function d(e){return e.trim().split(/\s+/g)}function f(e,t,r){if(e)for(const n of d(t))e.addEventListener(n,r,!1)}function _(e,t,r){if(e)for(const n of d(t))e.removeEventListener(n,r,!1)}function p(e){return(e.ownerDocument||e).defaultView}function g(e){const t=e.length;if(1===t)return{x:Math.round(e[0].clientX),y:Math.round(e[0].clientY)};let r=0,n=0,s=0;for(;s<t;)r+=e[s].clientX,n+=e[s].clientY,s++;return{x:Math.round(r/t),y:Math.round(n/t)}}function m(e){const t=[];let r=0;for(;r<e.pointers.length;)t[r]={clientX:Math.round(e.pointers[r].clientX),clientY:Math.round(e.pointers[r].clientY)},r++;return{timeStamp:Date.now(),pointers:t,center:g(t),deltaX:e.deltaX,deltaY:e.deltaY}}function E(e,t){const r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}function b(e,t){const r=t.clientX-e.clientX,n=t.clientY-e.clientY;return Math.sqrt(r*r+n*n)}function T(e,t){const r=t.clientX-e.clientX,n=t.clientY-e.clientY;return 180*Math.atan2(n,r)/Math.PI}function y(e,t){return e===t?s.None:Math.abs(e)>=Math.abs(t)?e<0?s.Left:s.Right:t<0?s.Up:s.Down}function A(e,t,r){return{x:t/e||0,y:r/e||0}}function R(e,t){const{session:r}=e,{pointers:s}=t,{length:i}=s;r.firstInput||(r.firstInput=m(t)),i>1&&!r.firstMultiple?r.firstMultiple=m(t):1===i&&(r.firstMultiple=!1);const{firstInput:o,firstMultiple:a}=r,c=a?a.center:o.center,u=t.center=g(s);t.timeStamp=Date.now(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=function(e,t){const r=t.x-e.x,n=t.y-e.y;return 180*Math.atan2(n,r)/Math.PI}(c,u),t.distance=E(c,u);const{deltaX:l,deltaY:h}=function(e,t){const r=t.center;let s=e.offsetDelta,i=e.prevDelta;const o=e.prevInput;return t.eventType!==n.Start&&o?.eventType!==n.End||(i=e.prevDelta={x:o?.deltaX||0,y:o?.deltaY||0},s=e.offsetDelta={x:r.x,y:r.y}),{deltaX:i.x+(r.x-s.x),deltaY:i.y+(r.y-s.y)}}(r,t);t.deltaX=l,t.deltaY=h,t.offsetDirection=y(t.deltaX,t.deltaY);const d=A(t.deltaTime,t.deltaX,t.deltaY);var f,_;t.overallVelocityX=d.x,t.overallVelocityY=d.y,t.overallVelocity=Math.abs(d.x)>Math.abs(d.y)?d.x:d.y,t.scale=a?(f=a.pointers,b((_=s)[0],_[1])/b(f[0],f[1])):1,t.rotation=a?function(e,t){return T(t[1],t[0])-T(e[1],e[0])}(a.pointers,s):0,t.maxPointers=r.prevInput?t.pointers.length>r.prevInput.maxPointers?t.pointers.length:r.prevInput.maxPointers:t.pointers.length;let p=e.element;return function(e,t){let r=e;for(;r;){if(r===t)return!0;r=r.parentNode}return!1}(t.srcEvent.target,p)&&(p=t.srcEvent.target),t.target=p,function(e,t){const r=e.lastInterval||t,s=t.timeStamp-r.timeStamp;let i,o,a,c;if(t.eventType!==n.Cancel&&(s>25||void 0===r.velocity)){const n=t.deltaX-r.deltaX,u=t.deltaY-r.deltaY,l=A(s,n,u);o=l.x,a=l.y,i=Math.abs(l.x)>Math.abs(l.y)?l.x:l.y,c=y(n,u),e.lastInterval=t}else i=r.velocity,o=r.velocityX,a=r.velocityY,c=r.direction;t.velocity=i,t.velocityX=o,t.velocityY=a,t.direction=c}(r,t),t}class S{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=e=>{this.manager.options.enable&&this.handler(e)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,t){!function(e,t,r){const s=r.pointers.length,i=r.changedPointers.length,o=t&n.Start&&s-i==0,a=t&(n.End|n.Cancel)&&s-i==0;r.isFirst=Boolean(o),r.isFinal=Boolean(a),o&&(e.session={}),r.eventType=t;const c=R(e,r);e.emit("hammer.input",c),e.recognize(c),e.session.prevInput=c}(this.manager,e,t)}init(){f(this.element,this.evEl,this.domHandler),f(this.target,this.evTarget,this.domHandler),f(p(this.element),this.evWin,this.domHandler)}destroy(){_(this.element,this.evEl,this.domHandler),_(this.target,this.evTarget,this.domHandler),_(p(this.element),this.evWin,this.domHandler)}}const w={pointerdown:n.Start,pointermove:n.Move,pointerup:n.End,pointercancel:n.Cancel,pointerout:n.Cancel};class v extends S{constructor(e){super(e),this.evEl="pointerdown",this.evWin="pointermove pointerup pointercancel",this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:t}=this;let r=!1;const s=w[e.type],i=e.pointerType,o="touch"===i;let a=t.findIndex((t=>t.pointerId===e.pointerId));s&n.Start&&(e.buttons||o)?a<0&&(t.push(e),a=t.length-1):s&(n.End|n.Cancel)&&(r=!0),a<0||(t[a]=e,this.callback(s,{pointers:t,changedPointers:[e],eventType:s,pointerType:i,srcEvent:e}),r&&t.splice(a,1))}}const x=["","webkit","Moz","MS","ms","o"];function C(e,t){const r=t[0].toUpperCase()+t.slice(1);for(const n of x){const s=n?n+r:t;if(s in e)return s}}const N={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class I{constructor(e,t){this.options={...N,...t,cssProps:{...N.cssProps,...t.cssProps},inputTarget:t.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new v(this),this.touchAction=new h(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?2:1}recognize(e){const{session:t}=this;if(t.stopped)return;let r;this.session.prevented&&e.srcEvent.preventDefault();const{recognizers:n}=this;let{curRecognizer:s}=t;(!s||s&&s.state&i.Recognized)&&(s=t.curRecognizer=null);let o=0;for(;o<n.length;)r=n[o],2===t.stopped||s&&r!==s&&!r.canRecognizeWith(s)?r.reset():r.recognize(e),!s&&r.state&(i.Began|i.Changed|i.Ended)&&(s=t.curRecognizer=r),o++}get(e){const{recognizers:t}=this;for(let r=0;r<t.length;r++)if(t[r].options.event===e)return t[r];return null}add(e){if(Array.isArray(e)){for(const t of e)this.add(t);return this}const t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const t of e)this.remove(t);return this}const t="string"==typeof e?this.get(e):e;if(t){const{recognizers:e}=this,r=e.indexOf(t);-1!==r&&(e.splice(r,1),this.touchAction.update())}return this}on(e,t){if(!e||!t)return;const{handlers:r}=this;for(const n of d(e))r[n]=r[n]||[],r[n].push(t)}off(e,t){if(!e)return;const{handlers:r}=this;for(const n of d(e))t?r[n]&&r[n].splice(r[n].indexOf(t),1):delete r[n]}emit(e,t){const r=this.handlers[e]&&this.handlers[e].slice();if(!r||!r.length)return;const n=t;n.type=e,n.preventDefault=function(){t.srcEvent.preventDefault()};let s=0;for(;s<r.length;)r[s](n),s++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:t}=this;if(t){for(const[r,n]of Object.entries(this.options.cssProps)){const s=C(t.style,r);e?(this.oldCssProps[s]=t.style[s],t.style[s]=n):t.style[s]=this.oldCssProps[s]||""}e||(this.oldCssProps={})}}}let L=1;function O(e){return e&i.Cancelled?"cancel":e&i.Ended?"end":e&i.Changed?"move":e&i.Began?"start":""}class M{constructor(e){this.options=e,this.id=L++,this.state=i.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const t of e)this.recognizeWith(t);return this}let t;if("string"==typeof e){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{simultaneous:r}=this;return r[t.id]||(r[t.id]=t,t.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const t of e)this.dropRecognizeWith(t);return this}let t;return t="string"==typeof e?this.manager.get(e):e,t&&delete this.simultaneous[t.id],this}requireFailure(e){if(Array.isArray(e)){for(const t of e)this.requireFailure(t);return this}let t;if("string"==typeof e){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{requireFail:r}=this;return-1===r.indexOf(t)&&(r.push(t),t.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const t of e)this.dropRequireFailure(t);return this}let t;if(t="string"==typeof e?this.manager.get(e):e,t){const e=this.requireFail.indexOf(t);e>-1&&this.requireFail.splice(e,1)}return this}hasRequireFailures(){return Boolean(this.requireFail.find((e=>e.options.enable)))}canRecognizeWith(e){return Boolean(this.simultaneous[e.id])}emit(e){if(!e)return;const{state:t}=this;t<i.Ended&&this.manager.emit(this.options.event+O(t),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),t>=i.Ended&&this.manager.emit(this.options.event+O(t),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=i.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(i.Failed|i.Possible)))return!1;e++}return!0}recognize(e){const t={...e};if(!this.options.enable)return this.reset(),void(this.state=i.Failed);this.state&(i.Recognized|i.Cancelled|i.Failed)&&(this.state=i.Possible),this.state=this.process(t),this.state&(i.Began|i.Changed|i.Ended|i.Cancelled)&&this.tryEmit(t)}getEventNames(){return[this.options.event]}reset(){}}class P extends M{attrTest(e){const t=this.options.pointers;return 0===t||e.pointers.length===t}process(e){const{state:t}=this,{eventType:r}=e,s=t&(i.Began|i.Changed),o=this.attrTest(e);return s&&(r&n.Cancel||!o)?t|i.Cancelled:s||o?r&n.End?t|i.Ended:t&i.Began?t|i.Changed:i.Began:i.Failed}}class F extends M{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[a]}process(e){const{options:t}=this,r=e.pointers.length===t.pointers,s=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),e.eventType&n.Start&&0===this.count)return this.failTimeout();if(s&&o&&r){if(e.eventType!==n.End)return this.failTimeout();const r=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||E(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,s&&r?this.count+=1:this.count=1,this._input=e;if(0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=setTimeout((()=>{this.state=i.Recognized,this.tryEmit(this._input)}),t.interval),i.Began):i.Recognized}return i.Failed}failTimeout(){return this._timer=setTimeout((()=>{this.state=i.Failed}),this.options.interval),i.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===i.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const B=["","start","move","end","cancel","up","down","left","right"];class k extends P{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:s.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,t=[];return e&s.Horizontal&&t.push(l),e&s.Vertical&&t.push(u),t}getEventNames(){return B.map((e=>this.options.event+e))}directionTest(e){const{options:t}=this;let r=!0,{distance:n}=e,{direction:i}=e;const o=e.deltaX,a=e.deltaY;return i&t.direction||(t.direction&s.Horizontal?(i=0===o?s.None:o<0?s.Left:s.Right,r=o!==this.pX,n=Math.abs(e.deltaX)):(i=0===a?s.None:a<0?s.Up:s.Down,r=a!==this.pY,n=Math.abs(e.deltaY))),e.direction=i,r&&n>t.threshold&&Boolean(i&t.direction)}attrTest(e){return super.attrTest(e)&&(Boolean(this.state&i.Began)||!(this.state&i.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const t=s[e.direction].toLowerCase();t&&(e.additionalEvent=this.options.event+t),super.emit(e)}}const D=["","start","move","end","cancel","in","out"];class U extends P{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[c]}getEventNames(){return D.map((e=>this.options.event+e))}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||Boolean(this.state&i.Began))}emit(e){if(1!==e.scale){const t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}super.emit(e)}}class G{constructor(e,t,r){this.element=e,this.callback=t,this.options=r}}const W="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",H=("undefined"!=typeof window?window:global,"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document,-1!==W.indexOf("firefox")),X=4.000244140625;class V extends G{constructor(e,t,r){super(e,t,{enable:!0,...r}),this.handleEvent=e=>{if(!this.options.enable)return;let t=e.deltaY;globalThis.WheelEvent&&(H&&e.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(t/=globalThis.devicePixelRatio),e.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(t*=40)),0!==t&&t%X==0&&(t=Math.floor(t/X)),e.shiftKey&&t&&(t*=.25),this.callback({type:"wheel",center:{x:e.clientX,y:e.clientY},delta:-t,srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}}const $=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class z extends G{constructor(e,t,r){super(e,t,{enable:!0,...r}),this.handleEvent=e=>{this.handleOverEvent(e),this.handleOutEvent(e),this.handleEnterEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)},this.pressed=!1;const{enable:n}=this.options;this.enableMoveEvent=n,this.enableLeaveEvent=n,this.enableEnterEvent=n,this.enableOutEvent=n,this.enableOverEvent=n,$.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){$.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){switch(e){case"pointermove":this.enableMoveEvent=t;break;case"pointerover":this.enableOverEvent=t;break;case"pointerout":this.enableOutEvent=t;break;case"pointerenter":this.enableEnterEvent=t;break;case"pointerleave":this.enableLeaveEvent=t}}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.buttons&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const K=["keydown","keyup"];class Y extends G{constructor(e,t,r){super(e,t,{enable:!0,tabIndex:0,...r}),this.handleEvent=e=>{const t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:"keydown",srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:"keyup",srcEvent:e,key:e.key,target:e.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",K.forEach((t=>e.addEventListener(t,this.handleEvent)))}destroy(){K.forEach((e=>this.element.removeEventListener(e,this.handleEvent)))}enableEventType(e,t){"keydown"===e&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}}class j extends G{constructor(e,t,r){super(e,t,r),this.handleEvent=e=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){"contextmenu"===e&&(this.options.enable=t)}}const q={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};function Z(e){const t=q[e.srcEvent.type];if(!t)return null;const{buttons:r,button:n}=e.srcEvent;let s=!1,i=!1,o=!1;return 2===t?(s=Boolean(1&r),i=Boolean(4&r),o=Boolean(2&r)):(s=0===n,i=1===n,o=2===n),{leftButton:s,middleButton:i,rightButton:o}}function Q(e,t){const r=e.center;if(!r)return null;const n=t.getBoundingClientRect(),s=n.width/t.offsetWidth||1,i=n.height/t.offsetHeight||1;return{center:r,offsetCenter:{x:(r.x-n.left-t.clientLeft)/s,y:(r.y-n.top-t.clientTop)/i}}}const J={srcElement:"root",priority:0};class ee{constructor(e,t){this.handleEvent=e=>{if(this.isEmpty())return;const t=this._normalizeEvent(e);let r=e.srcEvent.target;for(;r&&r!==t.rootElement;){if(this._emit(t,r),t.handled)return;r=r.parentNode}this._emit(t,"root")},this.eventManager=e,this.recognizerName=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,r,n=!1,s=!1){const{handlers:i,handlersByElement:o}=this,a={...J,...r};let c=o.get(a.srcElement);c||(c=[],o.set(a.srcElement,c));const u={type:e,handler:t,srcElement:a.srcElement,priority:a.priority};n&&(u.once=!0),s&&(u.passive=!0),i.push(u),this._active=this._active||!u.passive;let l=c.length-1;for(;l>=0&&!(c[l].priority>=u.priority);)l--;c.splice(l+1,0,u)}remove(e,t){const{handlers:r,handlersByElement:n}=this;for(let s=r.length-1;s>=0;s--){const i=r[s];if(i.type===e&&i.handler===t){r.splice(s,1);const e=n.get(i.srcElement);e.splice(e.indexOf(i),1),0===e.length&&n.delete(i.srcElement)}}this._active=r.some((e=>!e.passive))}_emit(e,t){const r=this.handlersByElement.get(t);if(r){let t=!1;const n=()=>{e.handled=!0},s=()=>{e.handled=!0,t=!0},i=[];for(let o=0;o<r.length;o++){const{type:a,handler:c,once:u}=r[o];if(c({...e,type:a,stopPropagation:n,stopImmediatePropagation:s}),u&&i.push(r[o]),t)break}for(let e=0;e<i.length;e++){const{type:t,handler:r}=i[e];this.remove(t,r)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...Z(e),...Q(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}function te(e){if("recognizer"in e)return e;let t;const r=Array.isArray(e)?[...e]:[e];if("function"==typeof r[0]){t=new(r.shift())(r.shift()||{})}else t=r.shift();return{recognizer:t,recognizeWith:"string"==typeof r[0]?[r[0]]:r[0],requireFailure:"string"==typeof r[1]?[r[1]]:r[1]}}class re{constructor(e=null,t={}){if(this._onBasicInput=e=>{this.manager.emit(e.srcEvent.type,e)},this._onOtherEvent=e=>{this.manager.emit(e.type,e)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...t},this.events=new Map,this.element=e,e){this.manager=new I(e,this.options);for(const e of this.options.recognizers){const{recognizer:t,recognizeWith:r,requireFailure:n}=te(e);this.manager.add(t),r&&t.recognizeWith(r),n&&t.requireFailure(n)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new V(e,this._onOtherEvent,{enable:!1}),this.moveInput=new z(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Y(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new j(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,t,r){this._addEventHandler(e,t,r,!1)}once(e,t,r){this._addEventHandler(e,t,r,!0)}watch(e,t,r){this._addEventHandler(e,t,r,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:r}=this;if(!r)return;const n=r.get(e);n&&(n.set({enable:t}),r.touchAction.update()),this.wheelInput?.enableEventType(e,t),this.moveInput?.enableEventType(e,t),this.keyInput?.enableEventType(e,t),this.contextmenuInput?.enableEventType(e,t)}_addEventHandler(e,t,r,n,s){if("string"!=typeof e){r=t;for(const[t,i]of Object.entries(e))this._addEventHandler(t,i,r,n,s);return}const{manager:i,events:o}=this;if(!i)return;let a=o.get(e);if(!a){const t=this._getRecognizerName(e)||e;a=new ee(this,t),o.set(e,a),i&&i.on(e,a.handleEvent)}a.add(e,t,r,n,s),a.isEmpty()||this._toggleRecognizer(a.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const[t,r]of Object.entries(e))this._removeEventHandler(t,r);return}const{events:r}=this,n=r.get(e);if(n&&(n.remove(e,t),n.isEmpty())){const{recognizerName:e}=n;let t=!1;for(const n of r.values())if(n.recognizerName===e&&!n.isEmpty()){t=!0;break}t||this._toggleRecognizer(e,!1)}}_getRecognizerName(e){return this.manager.recognizers.find((t=>t.getEventNames().includes(e)))?.options.event}}},19495:(e,t,r)=>{function n(e){var t,r,n,i=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);i--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new s(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function s(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return s=function(e){this.s=e,this.n=e.next},s.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new s(e)}r.d(t,{A:()=>n})},93640:(e,t,r)=>{r.d(t,{eh:()=>s,gM:()=>i,x:()=>n});const n=globalThis,s=(globalThis.document,globalThis.process||{}),i=(globalThis.console,globalThis.navigator||{})},74003:(e,t,r)=>{r.d(t,{B:()=>s});var n=r(77989);function s(){return!("object"==typeof process&&"[object process]"===String(process)&&!process?.browser)||(0,n.b)()}},77989:(e,t,r)=>{function n(e){if("undefined"!=typeof window&&"renderer"===window.process?.type)return!0;if("undefined"!=typeof process&&Boolean(process.versions?.electron))return!0;const t="undefined"!=typeof navigator&&navigator.userAgent,r=e||t;return Boolean(r&&r.indexOf("Electron")>=0)}r.d(t,{b:()=>n})},85335:(e,t,r)=>{r.d(t,{t:()=>g});var n=r(74003);const s="4.0.7";class i{constructor(e,t,r="sessionStorage"){this.storage=function(e){try{const t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),t}catch(t){return null}}(r),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}var o;!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(o||(o={}));function a(e){return"string"!=typeof e?e:(e=e.toUpperCase(),o[e]||o.WHITE)}function c(e,t){if(!e)throw new Error(t||"Assertion failed")}var u=r(93640);function l(){let e;if((0,n.B)()&&u.x.performance)e=u.x?.performance?.now?.();else if("hrtime"in u.eh){const t=u.eh?.hrtime?.();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}const h={debug:(0,n.B)()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},d={enabled:!0,level:0};function f(){}const _={},p={once:!0};class g{constructor({id:e}={id:""}){this.VERSION=s,this._startTs=l(),this._deltaTs=l(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new i(`__probe-${this.id}__`,d),this.timeStamp(`${this.id} started`),function(e,t=["constructor"]){const r=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(r),s=e;for(const i of n){const r=s[i];"function"==typeof r&&(t.find((e=>i===e))||(s[i]=r.bind(e)))}}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((l()-this._startTs).toPrecision(10))}getDelta(){return Number((l()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,h.warn,arguments,p)}error(e){return this._getLogFunction(0,e,h.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,h.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,h.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,h.debug||h.info,arguments,p)}table(e,t,r){return t?this._getLogFunction(e,t,console.table||f,r&&[r],{tag:b(t)}):f}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||f)}group(e,t,r={collapsed:!1}){const n=E({logLevel:e,message:t,opts:r}),{collapsed:s}=r;return n.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(e,t,r={}){return this.group(e,t,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||f)}withGroup(e,t,r){this.group(e,t)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=m(e)}_getLogFunction(e,t,r,s,i){if(this._shouldLog(e)){i=E({logLevel:e,message:t,args:s,opts:i}),c(r=r||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=l();const o=i.tag||i.message;if(i.once&&o){if(_[o])return f;_[o]=l()}return t=function(e,t,r){if("string"==typeof t){const s=r.time?function(e,t=8){const r=Math.max(t-e.length,0);return`${" ".repeat(r)}${e}`}(function(e){let t;return t=e<10?`${e.toFixed(2)}ms`:e<100?`${e.toFixed(1)}ms`:e<1e3?`${e.toFixed(0)}ms`:`${(e/1e3).toFixed(2)}s`,t}(r.total)):"";t=function(e,t,r){n.B||"string"!=typeof e||(t&&(e=`\x1b[${a(t)}m${e}\x1b[39m`),r&&(e=`\x1b[${a(r)+10}m${e}\x1b[49m`));return e}(t=r.time?`${e}: ${s}  ${t}`:`${e}: ${t}`,r.color,r.background)}return t}(this.id,i.message,i),r.bind(console,t,...i.args)}return f}}function m(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return c(Number.isFinite(t)&&t>=0),t}function E(e){const{logLevel:t,message:r}=e;e.logLevel=m(t);const n=e.args?Array.from(e.args):[];for(;n.length&&n.shift()!==r;);switch(typeof t){case"string":case"function":void 0!==r&&n.unshift(r),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const s=typeof e.message;return c("string"===s||"object"===s),Object.assign(e,{args:n},e.opts)}function b(e){for(const t in e)for(const r in e[t])return r||"untitled";return"empty"}g.VERSION=s},97983:(e,t,r)=>{function n(){let e;if("undefined"!=typeof window&&window.performance)e=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}r.d(t,{A:()=>i});class s{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=n(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(n()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class i{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach((t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}})),e}_initializeStats(e=[]){e.forEach((e=>this._getOrCreate(e)))}_getOrCreate(e){const{name:t,type:r}=e;let n=this.stats[t];return n||(n=e instanceof s?e:new s(t,r),this.stats[t]=n),n}}}}]);